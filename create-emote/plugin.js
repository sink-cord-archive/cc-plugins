(function(a,E,g,h,e){"use strict";var R=()=>cumcord.patcher.injectCSS(".ysink_emote_modal .ysink_emote_row{display:flex;margin-bottom:1rem}.ysink_emote_modal .ysink_emote_row:last-child{margin-bottom:unset}.ysink_emote_modal .ysink_emote_row>*{flex:1;margin-right:1rem}.ysink_emote_modal .ysink_emote_row>:last-child{flex:unset;margin-right:unset}");const C=a.findByProps("uploadEmoji");a.findByProps("getGuildPermissions");const M=a.findByProps("getFlattenedGuilds").getFlattenedGuilds,B=s=>new Promise((n,o)=>{let t=new FileReader;t.onloadend=()=>n(t.result),t.readAsDataURL(s)}),x=async s=>await B(await(await fetch(s)).blob()),y=(s,n,o)=>{x(n).then(t=>C.uploadEmoji(s,t,o))},N=e.React.useState,{openModal:S}=a.findByProps("openModal"),i=a.findByProps("ModalCloseButton"),d=a.findByDisplayName("Flex"),p=a.findByDisplayName("Header"),w=a.findByDisplayName("FormSection"),j=a.findByDisplayName("FormText"),k=a.findByDisplayName("TextInput"),F=a.findByProps("Sizes","Colors","Looks","DropdownSizes"),I=({guildId:s,emoteUrl:n,e:o})=>{const[t,l]=N("");return e.React.createElement(g.ErrorBoundary,null,e.React.createElement(i.ModalRoot,{transitionState:o.transitionState,size:"small",className:"ysink_emote_modal"},e.React.createElement(i.ModalHeader,{separator:!1},e.React.createElement(d.Child,{basis:"auto",grow:1,shrink:1,wrap:!1},e.React.createElement(p,{tag:"h2",size:p.Sizes.SIZE_20},"Create Emote")),e.React.createElement(d.Child,{basis:"auto",grow:0,shrink:1,wrap:!1},e.React.createElement(i.ModalCloseButton,{onClick:o.onClose}))),e.React.createElement(i.ModalContent,null,e.React.createElement(w,null,e.React.createElement("div",{className:"ysink_emote_row"},e.React.createElement(j,null,"You are now creating an emote for the following image:"),e.React.createElement("img",{src:n,height:"70"})),e.React.createElement(d,{basis:"auto",grow:1,shrink:1,className:"ysink_emote_row",style:{"margin-bottom":"1rem"}},e.React.createElement(k,{className:"ysink_emote_input",placeholder:"myamazingemote",type:"text",value:t,onChange:r=>l(r)}),e.React.createElement(F,{className:"ysink_emote_button",onClick:()=>{y(s,n,t),h.showToast({title:`created emote ${t}`,duration:3e3})}},"Create Emote!"))))))};var P=(s,n)=>S(o=>e.React.createElement(I,{guildId:s,emoteUrl:n,e:o}));const c=a.findByProps("MenuGroup","default");var D=s=>{let n=[];return{onLoad(){n.push(R());const o=a.find(t=>t?.default?.displayName=="MessageContextMenu");n.push(E.after("default",o,(t,l)=>{let r=t[0].target,m=!!r?.classList?.contains("emoji");if(!(!r||!l?.props?.children||!m&&r?.nodeName!="IMG"||r.alt.length<=2))return l.props.children.splice(3,0,e.React.createElement(c.MenuSeparator,null),e.React.createElement(c.MenuItem,{id:"ysink_emoji_msgitem",label:m?`Clone Emote ${t[0].target.alt}`:"Create Emote"},M().map(u=>e.React.createElement(c.MenuItem,{label:u.name,id:`ysink_emoji_server_${u.id}`,action:()=>{let _=r.currentSrc,f=u.id,T=r?.alt?.substring(1,r.alt.length-1);m?y(f,_,T):P(f,_)}})))),l}))},onUnload:()=>n.forEach(o=>o())}};return D})(cumcord.modules.webpack,cumcord.patcher,cumcord.ui.components,cumcord.ui.toasts,cumcord.modules.common);
