(function(a,h,y,R,e){"use strict";const C=a.findByProps("uploadEmoji");a.findByProps("getGuildPermissions");const M=a.findByProps("getFlattenedGuilds").getFlattenedGuilds,B=s=>new Promise((n,o)=>{let t=new FileReader;t.onloadend=()=>n(t.result),t.readAsDataURL(s)}),x=async s=>await B(await(await fetch(s)).blob()),p=(s,n,o)=>{x(n).then(t=>C.uploadEmoji(s,t,o))},N=e.React.useState,{openModal:S}=a.findByProps("openModal"),i=a.findByProps("ModalCloseButton"),d=a.findByDisplayName("Flex"),f=a.findByDisplayName("Header"),w=a.findByDisplayName("FormSection"),j=a.findByDisplayName("FormText"),k=a.findByDisplayName("TextInput"),F=a.findByProps("Sizes","Colors","Looks","DropdownSizes"),I=({guildId:s,emoteUrl:n,e:o})=>{const[t,r]=N("");return e.React.createElement(R.ErrorBoundary,null,e.React.createElement(i.ModalRoot,{transitionState:o.transitionState,size:"small",className:"ysink_emote_modal"},e.React.createElement(i.ModalHeader,{separator:!1},e.React.createElement(d.Child,{basis:"auto",grow:1,shrink:1,wrap:!1},e.React.createElement(f,{tag:"h2",size:f.Sizes.SIZE_20},"Create Emote")),e.React.createElement(d.Child,{basis:"auto",grow:0,shrink:1,wrap:!1},e.React.createElement(i.ModalCloseButton,{onClick:o.onClose}))),e.React.createElement(i.ModalContent,null,e.React.createElement(w,null,e.React.createElement("div",{className:"ysink_emote_row"},e.React.createElement(j,null,"You are now creating an emote for the following image:"),e.React.createElement("img",{src:n,height:"70"})),e.React.createElement(d,{basis:"auto",grow:1,shrink:1,className:"ysink_emote_row",style:{"margin-bottom":"1rem"}},e.React.createElement(k,{className:"ysink_emote_input",placeholder:"myamazingemote",type:"text",value:t,onChange:l=>r(l)}),e.React.createElement(F,{className:"ysink_emote_button",onClick:()=>{p(s,n,t),y.showToast({title:`created emote ${t}`,duration:3e3}),o.onClose()}},"Create Emote!"))))))};var P=(s,n)=>S(o=>e.React.createElement(I,{guildId:s,emoteUrl:n,e:o})),T=()=>cumcord.patcher.injectCSS(".ysink_emote_modal .ysink_emote_row{display:flex;margin-bottom:1rem}.ysink_emote_modal .ysink_emote_row:last-child{margin-bottom:unset}.ysink_emote_modal .ysink_emote_row>*{flex:1;margin-right:1rem}.ysink_emote_modal .ysink_emote_row>:last-child{flex:unset;margin-right:unset}");const c=a.findByProps("MenuGroup","default");var D=s=>{let n=[];return{onLoad(){n.push(T());const o=a.find(t=>t?.default?.displayName=="MessageContextMenu");n.push(h.after("default",o,(t,r)=>{let l=t[0].target,m=!!l?.classList?.contains("emoji");if(!(!l||!r?.props?.children||!m&&l?.nodeName!="IMG"||l.alt.length<=2))return r.props.children.splice(3,0,e.React.createElement(c.MenuSeparator,null),e.React.createElement(c.MenuItem,{id:"ysink_emoji_msgitem",label:m?`Clone Emote ${t[0].target.alt}`:"Create Emote"},M().map(u=>e.React.createElement(c.MenuItem,{label:u.name,id:`ysink_emoji_server_${u.id}`,action:()=>{let _=l.currentSrc,E=u.id,g=l?.alt?.substring(1,l.alt.length-1);m?(p(E,_,g),y.showToast({title:`cloned emote ${g}`,duration:3e3})):P(E,_)}})))),r}))},onUnload:()=>n.forEach(o=>o())}};return D})(cumcord.modules.webpack,cumcord.patcher,cumcord.ui.toasts,cumcord.ui.components,cumcord.modules.common);
