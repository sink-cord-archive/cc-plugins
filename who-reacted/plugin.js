(function(a,t,d,U,h,l,S){"use strict";function E(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(s){if(s!=="default"){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}}),r.default=e,Object.freeze(r)}var o=E(U),b=()=>d.injectCSS(".ysink_reacted_grid{display:grid;gap:1rem;grid-template-columns:auto 1fr;align-items:center}.ysink_reacted_grid>div{font-weight:700}.ysink_reacted_reactors{margin-left:6px}.ysink_reacted_reactors .more_reactors{background-color:var(--background-tertiary);color:var(--text-normal);font-weight:500}");const x=l.findByProps("reaction").reaction,C=e=>h.findInTree(h.getReactInstance(e),r=>r?.type?.displayName==="Reaction",{walkable:["return"]}),m=()=>{for(const e of document.getElementsByClassName(x))C(e).stateNode.forceUpdate()},[{Reaction:w},p,y,j,f,M,i]=l.batchFind(({findByProps:e,findByDisplayName:r})=>{e("Reaction"),e("getReactions","_dispatcher"),r("VoiceUserSummaryItem"),r("TextInput"),r("Slider"),r("Switch"),r("FormText")}),v=({count:e,max:r,users:s})=>o.createElement(y,{className:"ysink_reacted_reactors",max:r,users:s,renderMoreUsers:(n,c)=>o.createElement("div",{className:`${c} more_reactors`},"+",1+e-r)});var I=S.connectStores([p],({message:e,emoji:r})=>({users:Object.values(p.getReactions(e.getChannelId(),e.id,r)??{})}))(v);const O=({reactions:e})=>{const r=t.persist.ghost.reactionThreshold,s=t.persist.ghost.userThreshold;return!(r!==0&&e.length>r||s!==0&&(t.persist.ghost.useHighestUserCount?Math.max(...e.map(c=>c.count)):e.reduce((c,u)=>c+u.count,0))>s)};var V=()=>{const e=d.after("render",w.prototype,function(r,s){const{message:n,emoji:c,count:u}=this.props;if(O(n)){const P=s.props.children;s.props.children=$=>{const T=P($),R=T.props.children.props.children,q=R.props.children;return R.props.children=z=>{const k=q(z);return k.props.children.push(o.createElement(I,{message:n,emoji:c,count:u,max:t.persist.ghost.maxUsersShown??6})),k},T}}return s});return m(),()=>{e(),m()}};const g=e=>e===0?"Off":e%1e3===0?`${e/1e3}k`:e;var N=()=>(h.useNest(t.persist),o.createElement("div",{className:"ysink_reacted_grid"},o.createElement(i,null,"Max Users Shown"),o.createElement(j,{note:"The maximum number of users shown per reaction between 0 and 99.",value:t.persist.ghost.maxUsersShown,type:"text",onChange:e=>{!isNaN(e)&&e>=0&&e<=99&&(t.persist.store.maxUsersShown=e)}}),o.createElement(i,null,"Reaction Threshold"),o.createElement(f,{maxValue:20,markers:_.range(21),stickToMarkers:!0,initialValue:t.persist.ghost.reactionThreshold,onValueChange:e=>{t.persist.store.reactionThreshold=e},onMarkerRender:g}),o.createElement(i,null,"User Threshold"),o.createElement(f,{maxValue:1e4,markers:[0,10,20,50,100,500,1e3,2e3,3e3,4e3,5e3,1e4],stickToMarkers:!0,initialValue:t.persist.ghost.userThreshold,onValueChange:e=>{t.persist.store.userThreshold=e},onMarkerRender:g,equidistant:!0}),o.createElement(i,null,"Use highest user count"),o.createElement(M,{checked:t.persist.ghost.useHighestUserCount,onChange:e=>{t.persist.store.useHighestUserCount=e}})));t.persist.ghost.maxUsersShown??=6,t.persist.ghost.reactionThreshold??=10,t.persist.ghost.userThreshold??=100,t.persist.ghost.useHighestUserCount??=!0;const F=[b(),V()],H=()=>_.forEachRight(F,e=>e?.());return a.onUnload=H,a.settings=N,Object.defineProperty(a,"__esModule",{value:!0}),a})({},cumcord.pluginData,cumcord.patcher,cumcord.modules.common.React,cumcord.utils,cumcord.modules.webpack,cumcord.modules.common.Flux);
