(function(d,w,E,s,m){"use strict";var _=()=>cumcord.patcher.injectCSS(".ysink_palette_modal{position:absolute;top:5rem;left:0;width:100vw;display:flex;align-items:center;background:none!important;box-shadow:none!important}.ysink_palette_palette{width:50rem;background-color:var(--background-secondary);color:#fff;padding:.75rem 0;border-radius:0;overflow:unset!important}.ysink_palette_item{padding:.3rem .3rem .3rem 1rem}.ysink_palette_item.ysink_palette_selected{background-color:#0005}.ysink_palette_input_wrapper{margin:0 .5rem 1rem;border:#ffffff33 solid 1px;display:flex;align-items:center;padding-left:.5rem}.ysink_palette_input{flex:1;margin-left:.5rem}.ysink_palette_input input{border:none!important;background:none!important;padding:0!important}"),k=({entry:e,selected:n})=>s.React.createElement("div",{className:n?"ysink_palette_item ysink_palette_selected":"ysink_palette_item"},e.label);const y=(e,n)=>{let r=[];return n.forEach((t,o)=>{let a=e.findIndex(i=>i.id==o);o!=-1&&(r.push([e[a],t]),e.splice(a,1))}),r=r.sort((t,o)=>o[1]-t[1]).map(t=>t[0]),r.concat(e)};var b=(e,n,r)=>{if(!r||r=="")return y(e,n);let t=e.filter(o=>o.label.toLowerCase().includes(r));return y(t,n)};const C=s.React.useState,{openModal:P}=d.findByProps("openModal"),h=d.findByProps("ModalCloseButton");d.findByDisplayName("Flex"),d.findByDisplayName("Header");const v=d.findByDisplayName("TextInput"),I=({e,nest:n,defaultEntries:r})=>{w.useNest(n);let[t,o]=C({selected:0,search:""});const a=b(r.concat(n.ghost.customEntries),n.ghost.usageCounts,t.search);console.log(n.ghost,r,a,t);const i=l=>{let c=t.selected;o({selected:c,search:l})},u=l=>{let c=t.search;o({selected:l,search:c})},D=l=>{switch(l.which){case 38:t.selected>0?u(t.selected-1):u(a.length-1);break;case 40:t.selected<a.length-1?u(t.selected+1):u(0);break;case 13:e.onClose();let c=a[t.selected],f=n.ghost.usageCounts,B=f.get(c.id)??0;f.set(c.id,B+1),n.store.usageCounts=f,c.action();break;default:document.getElementsByClassName("ysink_palette_input")[0].children[0].focus();break}};return s.React.createElement(E.ErrorBoundary,null,s.React.createElement(h.ModalRoot,{transitionState:e.transitionState,size:"small",className:"ysink_palette_modal",onKeyDown:D},s.React.createElement(h.ModalContent,{className:"ysink_palette_palette"},s.React.createElement("div",{className:"ysink_palette_input_wrapper"},">",s.React.createElement(v,{className:"ysink_palette_input",placeholder:"Search Actions",type:"text",value:t.search,onChange:l=>i(l)})),a.map((l,c)=>s.React.createElement(k,{entry:l,selected:c==t.selected})))))};var x=(e,n)=>P(r=>s.React.createElement(I,{e:r,nest:e,defaultEntries:n})),R=(e,n)=>{let r=t=>{(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.which==80&&x(e,n)};return document.addEventListener("keyup",r),()=>{document.removeEventListener("keyup",r)}};const g="Built In",p=[{id:"notcum",label:"Not cum",action:()=>m.showToast({title:"You chose: Not cum",duration:5e3})},{id:"abitcum",label:"A bit cum",action:()=>m.showToast({title:"You chose: A bit cum",duration:5e3})},{id:"cum",label:"Cum",action:()=>m.showToast({title:"You chose: Cum",duration:5e3})}].map(e=>({source:g,id:e.id,label:e.label,action:e.action}));var N=e=>(window.commandPalette={registerEntry(n,r,t,o){if(!n||n=="")throw"Register failed: Please supply an ID (string) for your entry";if(!r||r=="")throw"Register failed: Please identify a source (string) for your entry";if(!t||t=="")throw"Register failed: Please supply a label (string) for your entry";if(!o)throw"Register failed: Please supply an action (JS function) for your entry";if(r==g)throw"Register failed: That source is reserved for built in entries";if(p.find(i=>i.id==n)!=null)throw"Register failed: Entry ID taken by a built in entry";let a=e.ghost.customEntries.findIndex(i=>i.id==n);if(a!=-1)throw`Register failed: Entry ID taken by entry from source ${e.ghost.customEntries[a].source}`;e.ghost.customEntries.push({id:n,source:r,label:t,action:o})},unregisterEntry(n,r){if(!n||n=="")throw"Unregister failed: Please supply an ID (string) to deregister";if(!r||r=="")throw"Unregister failed: Please identify your source (string)";let t=e.ghost.customEntries,o=t.findIndex(i=>i.id==n);if(o==-1)throw"Unregister failed: No entry with that ID could be found";if(t[o].source!=r)throw"Unregister failed: An entry with that ID was found, but was not from your source";let a=t[o];return e.ghost.customEntries=t.splice(o,1),a},getBuiltInEntries:()=>p,getAllCustomEntries:()=>e.ghost.customEntries,getCustomEntriesBySouce:n=>e.ghost.customEntries.filter(r=>r.source==n),getCustomEntryById:n=>e.ghost.customEntries.find(r=>r.id==n)},console.log("|| COMMAND PALETTE || Initialised window.commandPalette API"),()=>{window.commandPalette=void 0,delete window.commandPalette,console.log("|| COMMAND PALETTE || Disposed window.commandPalette API")}),A=({persist:e,id:n})=>{Array.isArray(e.ghost.customEntries)||(e.store.customEntries=[]),e.ghost.usageCounts||(e.store.usageCounts=new Map);let r=[];return{onLoad:()=>r.push(_(),R(e,p),N(e)),onUnload:()=>r.forEach(t=>t())}};return A})(cumcord.modules.webpack,cumcord.utils,cumcord.ui.components,cumcord.modules.common,cumcord.ui.toasts);
