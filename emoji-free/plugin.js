(function(c,o,u,r,h,j){"use strict";function E(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(i,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})}}),i.default=e,Object.freeze(i)}var I=E(h);const[d,m,p,v,{selected:C},{getCustomEmojiById:g},{getLastSelectedGuildId:k},{getStickerById:f},{getStickerAssetUrl:M},{getCurrentUser:U},y,a]=u.batchFind(({findByProps:e,findByDisplayName:i,find:n})=>{e("canUseEmojisEverywhere"),e("isSendableSticker"),e("sendMessage"),e("uploadFiles"),e("childWrapper","selected"),e("getCustomEmojiById"),e("getLastSelectedGuildId"),e("getStickerById"),e("getStickerAssetUrl"),e("getCurrentUser"),i("TextInput"),n(t=>t?.type?.render?.displayName==="ChannelTextAreaContainer")}),A=m.isSendableSticker;var O=[o.instead("canUseEmojisEverywhere",d,()=>!0),o.instead("canUseAnimatedEmojis",d,()=>!0),o.instead("isSendableSticker",m,()=>!0)];const z=()=>document.querySelector('[data-list-item-id="guildsnav___home"]').classList.contains(C),N=()=>Number.isSafeInteger(parseInt(r.persist.ghost.size))?r.persist.ghost.size:64,T=/<a?:(\w+):(\d+)>/i;function w(e,i){const n=e.matchAll(/<a?:(\w+):(\d+)>/gi),t=[];for(const l of n){const s=g(l[2]);(s.guildId!=k()||s.animated||z())&&(e=e.replace(l[0],""),t.push(`${s.url.split("?")[0]}?size=${i}`))}return[e.trim(),t]}var S=e=>{if(!e.content.match(T))return;const[i,n]=w(e.content,N());e.content=i,n.length>0&&(e.content+=`
`+n.join(`
`)),e.invalidEmojis=[]},x=[o.before("sendMessage",p,e=>S(e[1])),o.before("uploadFiles",v,e=>S(e[0].parsedMessage))];const b=u.getModule(a),R=a;b.default=a.type;const $=o.before("render",a.type,([e])=>{if(e.onSubmit.YSINK_EMOJI_PATCHED)return;const i=t=>A(t,U(),e.channel),n=e.onSubmit;e.onSubmit=function(...t){const l=t[0].stickers.map(f).filter(s=>!i(s)).map(M);return t[0].stickers=t[0].stickers.filter(s=>i(f(s))),t[0].value=`${t[0].value}
${l.join(`
`)}`.trim(),n.apply(this,t)},e.onSubmit.YSINK_EMOJI_PATCHED=!0});var F=()=>{b.default=R,$()},L=()=>(j.useNest(r.persist),I.createElement(y,{placeholder:"Emote size in pixels, falls back to 64 if invalid",onChange:e=>r.persist.store.size=e,value:r.persist.ghost.size}));const G=[...O,...x,F],H=()=>_.forEachRight(G,e=>e());return c.onUnload=H,c.settings=L,Object.defineProperty(c,"__esModule",{value:!0}),c})({},cumcord.patcher,cumcord.modules.webpack,cumcord.pluginData,cumcord.modules.common.React,cumcord.utils);
