(function(i,n,o,m,f){"use strict";var h=()=>{const t=n.findByProps("canUseEmojisEverywhere"),s=i.instead("canUseEmojisEverywhere",t,()=>!0),e=i.instead("canUseAnimatedEmojis",t,()=>!0);return()=>{s(),e()}};const{getCustomEmojiById:j}=n.findByProps("getCustomEmojiById"),{getLastSelectedGuildId:p}=n.findByProps("getLastSelectedGuildId");function y(t,s){let e=t.matchAll(/<a?:(\w+):(\d+)>/gi),l=[];for(let a of e){let c=j(a[2]);(c.guildId!=p()||c.animated||E())&&(t=t.replace(a[0],""),l.push(c.url.split("?")[0]+`?size=${s}&quality=lossless`))}return{content:t.trim(),emojis:l}}function E(){return document.querySelector('[data-list-item-id="guildsnav___home"]').classList.contains("selected-bZ3Lue")}function r(t,s){const e=y(s.content,t);return s.content=e.content,e.emojis.length>0&&(s.content+=`
`+e.emojis.join(`
`)),s.invalidEmojis=[],s}const d=Number.isSafeInteger(parseInt(o.persist.ghost.size))?o.persist.ghost.size:64,u=/<a?:(\w+):(\d+)>/i;var v=()=>{const t=i.before("sendMessage",n.findByProps("sendMessage"),e=>{if(e[1].content.match(u))return e[1]=r(d,e[1]),e}),s=i.before("uploadFiles",n.findByProps("uploadFiles"),e=>{if(e[3].content.match(u))return e[3]=r(d,e[3]),e});return()=>{t(),s()}};const I=n.findByDisplayName("TextInput");var B=()=>(m.useNest(o.persist),f.React.createElement(I,{placeholder:"Emote size in pixels, falls back to 64 if invalid",onChange:t=>o.persist.store.size=t,value:o.persist.ghost.size})),z=()=>{const t=[h(),v()];return{onUnload:()=>_.forEachRight(t,s=>s()),settings:B}};return z})(cumcord.patcher,cumcord.modules.webpack,cumcord.pluginData,cumcord.utils,cumcord.modules.common);
