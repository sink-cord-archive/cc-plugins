(function(i,n,o,m,f){"use strict";function g(e){if(e&&e.__esModule)return e;var s=Object.create(null);return e&&Object.keys(e).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(s,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}}),s.default=e,Object.freeze(s)}var p=g(m),y=()=>{const e=n.findByProps("canUseEmojisEverywhere"),s=i.instead("canUseEmojisEverywhere",e,()=>!0),t=i.instead("canUseAnimatedEmojis",e,()=>!0);return()=>{s(),t()}};const{getCustomEmojiById:j}=n.findByProps("getCustomEmojiById"),{getLastSelectedGuildId:h}=n.findByProps("getLastSelectedGuildId");function v(e,s){let t=e.matchAll(/<a?:(\w+):(\d+)>/gi),r=[];for(let l of t){let c=j(l[2]);(c.guildId!=h()||c.animated||E())&&(e=e.replace(l[0],""),r.push(c.url.split("?")[0]+`?size=${s}&quality=lossless`))}return{content:e.trim(),emojis:r}}function E(){return document.querySelector('[data-list-item-id="guildsnav___home"]').classList.contains("selected-bZ3Lue")}function u(e,s){const t=v(s.content,e);return s.content=t.content,t.emojis.length>0&&(s.content+=`
`+t.emojis.join(`
`)),s.invalidEmojis=[],s}const a=Number.isSafeInteger(parseInt(o.persist.ghost.size))?o.persist.ghost.size:64,d=/<a?:(\w+):(\d+)>/i;var B=()=>{const e=i.before("sendMessage",n.findByProps("sendMessage"),t=>{if(t[1].content.match(d))return t[1]=u(a,t[1]),t}),s=i.before("uploadFiles",n.findByProps("uploadFiles"),t=>{if(t[3]?.content.match(d))return t[3]=u(a,t[3]),t});return()=>{e(),s()}};const I=n.findByDisplayName("TextInput");var b=()=>(f.useNest(o.persist),p.createElement(I,{placeholder:"Emote size in pixels, falls back to 64 if invalid",onChange:e=>o.persist.store.size=e,value:o.persist.ghost.size})),z=()=>{const e=[y(),B()];return{onUnload:()=>_.forEachRight(e,s=>s()),settings:b}};return z})(cumcord.patcher,cumcord.modules.webpack,cumcord.pluginData,cumcord.modules.common.React,cumcord.utils);
