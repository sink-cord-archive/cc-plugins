(function(a,r,l,o,S,b){"use strict";function y(e){if(e&&e.__esModule)return e;var s=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(s,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})}}),s.default=e,Object.freeze(s)}var h=y(S);const[u,m,v,E,{selected:I},{getCustomEmojiById:j},{getLastSelectedGuildId:k},{getStickerById:f},{getStickerAssetUrl:C},{getCurrentUser:M},O,c]=l.batchFind(({findByProps:e,findByDisplayName:s,find:n})=>{e("canUseEmojisEverywhere"),e("isSendableSticker"),e("sendMessage"),e("uploadFiles"),e("childWrapper","selected"),e("getCustomEmojiById"),e("getLastSelectedGuildId"),e("getStickerById"),e("getStickerAssetUrl"),e("getCurrentUser"),s("TextInput"),n(t=>t?.type?.render?.displayName==="ChannelTextAreaContainer")}),U=m.isSendableSticker;var A=[r.instead("canUseEmojisEverywhere",u,()=>!0),r.instead("canUseAnimatedEmojis",u,()=>!0),r.instead("isSendableSticker",m,()=>!0)];const z=()=>document.querySelector('[data-list-item-id="guildsnav___home"]').classList.contains(I),N=()=>Number.isSafeInteger(parseInt(o.persist.ghost.size))?o.persist.ghost.size:64,B=/<a?:(\w+):(\d+)>/i;function P(e,s){const n=e.matchAll(/<a?:(\w+):(\d+)>/gi),t=[];for(const d of n){const i=j(d[2]);(i.guildId!=k()||i.animated||z())&&(e=e.replace(d[0],""),t.push(`${i.url.split("?")[0]}?size=${s}`))}return[e.trim(),t]}var g=e=>{if(!e.content.match(B))return;const[s,n]=P(e.content,N());e.content=s,n.length>0&&(e.content+=`
`+n.join(`
`)),e.invalidEmojis=[]},T=[r.before("sendMessage",v,e=>g(e[1])),r.before("uploadFiles",E,e=>g(e[0].parsedMessage))];const p=l.getModule(c),$=c;p.default=c.type;const w=r.before("render",c.type,([e])=>{if(e.onSubmit.YSINK_EMOJI_PATCHED)return;const s=t=>U(t,M(),e.channel),n=e.onSubmit;e.onSubmit=function(...t){const d=t[0].stickers.map(f).filter(i=>!s(i)).map(C);return t[0].stickers=t[0].stickers.filter(i=>s(f(i))),t[0].value=`${t[0].value}
${d.join(`
`)}`.trim(),n.apply(this,t)},e.onSubmit.YSINK_EMOJI_PATCHED=!0});var F=()=>{p.default=$,w()},L=()=>(b.useNest(o.persist),h.createElement(O,{placeholder:"Emote size in pixels, falls back to 64 if invalid",onChange:e=>o.persist.store.size=e,value:o.persist.ghost.size}));const R=[...A,...T,F],x=()=>_.forEachRight(R,e=>e());return a.onUnload=x,a.settings=L,Object.defineProperty(a,"__esModule",{value:!0}),a})({},cumcord.patcher,cumcord.modules.webpack,cumcord.pluginData,cumcord.modules.common.React,cumcord.utils);
