(function(a,i,l,o,y,b){"use strict";function S(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach(function(s){if(s!=="default"){var t=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,t.get?t:{enumerable:!0,get:function(){return e[s]}})}}),n.default=e,Object.freeze(n)}var h=S(y);const[u,m,v,j,{selected:k},{getCustomEmojiById:E},{getLastSelectedGuildId:I},{getStickerById:f},{getStickerAssetUrl:C},{getCurrentUser:M},U,c]=l.batchFind(({findByProps:e,findByDisplayName:n,find:s})=>{e("canUseEmojisEverywhere"),e("isSendableSticker"),e("sendMessage"),e("uploadFiles"),e("childWrapper","selected"),e("getCustomEmojiById"),e("getLastSelectedGuildId"),e("getStickerById"),e("getStickerAssetUrl"),e("getCurrentUser"),n("TextInput"),s(t=>t?.type?.render?.displayName==="ChannelTextAreaContainer")}),z=m.isSendableSticker;var O=[i.instead("canUseEmojisEverywhere",u,()=>!0),i.instead("canUseAnimatedEmojis",u,()=>!0),i.instead("isSendableSticker",m,()=>!0)];const A=()=>document.querySelector('[data-list-item-id="guildsnav___home"]').classList.contains(k),B=()=>Number.isSafeInteger(parseInt(o.persist.ghost.size))?o.persist.ghost.size:64,$=/<a?:(\w+):(\d+)>/i;function w(e,n){const s=e.matchAll(/<a?:(\w+):(\d+)>/gi),t=[];for(const d of s){const r=E(d[2]);(r.guildId!=I()||r.animated||A())&&(e=e.replace(d[0],""),t.push(`${r.url.split("?")[0]}?size=${n}`))}return[e.trim(),t]}var g=e=>{if(!e.content.match($))return;const[n,s]=w(e.content,B());e.content=n,s.length>0&&(e.content+=`
`+s.join(`
`)),e.invalidEmojis=[]},N=[i.before("sendMessage",v,e=>g(e[1])),i.before("uploadFiles",j,e=>g(e[0].parsedMessage))];const p=l.getModule(c),P=c;p.default=c.type;const T=i.before("render",c.type,([e])=>{const n=t=>z(t,M(),e.channel),s=e.onSubmit;e.onSubmit=function(...t){const d=t[0].stickers.map(f).filter(r=>!n(r)).map(C);return t[0].stickers=t[0].stickers.filter(r=>n(f(r))),t[0].value=`${t[0].value}
${d.join(`
`)}`.trim(),s.apply(this,t)}});var F=()=>{p.default=P,T()},L=()=>(b.useNest(o.persist),h.createElement(U,{placeholder:"Emote size in pixels, falls back to 64 if invalid",onChange:e=>o.persist.store.size=e,value:o.persist.ghost.size}));const R=[...O,...N,F],x=()=>_.forEachRight(R,e=>e());return a.onUnload=x,a.settings=L,Object.defineProperty(a,"__esModule",{value:!0}),a})({},cumcord.patcher,cumcord.modules.webpack,cumcord.pluginData,cumcord.modules.common.React,cumcord.utils);
