(function(r,s,o,m,f){"use strict";function h(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach(function(t){if(t!=="default"){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})}}),n.default=e,Object.freeze(n)}var j=h(m),p=()=>{const e=s.findByProps("canUseEmojisEverywhere"),n=r.instead("canUseEmojisEverywhere",e,()=>!0),t=r.instead("canUseAnimatedEmojis",e,()=>!0);return()=>{n(),t()}};const{getCustomEmojiById:y}=s.findByProps("getCustomEmojiById"),{getLastSelectedGuildId:v}=s.findByProps("getLastSelectedGuildId");function E(e,n){let t=e.matchAll(/<a?:(\w+):(\d+)>/gi),i=[];for(let l of t){let c=y(l[2]);(c.guildId!=v()||c.animated||I())&&(e=e.replace(l[0],""),i.push(c.url.split("?")[0]+`?size=${n}&quality=lossless`))}return{content:e.trim(),emojis:i}}function I(){return document.querySelector('[data-list-item-id="guildsnav___home"]').classList.contains("selected-bZ3Lue")}function u(e,n){const t=E(n.content,e);return n.content=t.content,t.emojis.length>0&&(n.content+=`
`+t.emojis.join(`
`)),n.invalidEmojis=[],n}const d=Number.isSafeInteger(parseInt(o.persist.ghost.size))?o.persist.ghost.size:64,a=/<a?:(\w+):(\d+)>/i;var P=()=>{const e=r.before("sendMessage",s.findByProps("sendMessage"),t=>{if(t[1].content.match(a))return t[1]=u(d,t[1]),t}),n=r.before("uploadFiles",s.findByProps("uploadFiles"),t=>{if(t[3].content.match(a))return t[3]=u(d,t[3]),t});return()=>{e(),n()}};const b=s.findByDisplayName("TextInput");var z=()=>(f.useNest(o.persist),j.createElement(b,{placeholder:"Emote size in pixels, falls back to 64 if invalid",onChange:e=>o.persist.store.size=e,value:o.persist.ghost.size})),B=()=>{const e=[p(),P()];return{onUnload:()=>_.forEachRight(e,n=>n()),settings:z}};return B})(cumcord.patcher,cumcord.modules.webpack,cumcord.pluginData,cumcord.modules.common.React,cumcord.utils);
