(function(xe,b,ie,Se,Ge,ae,ee,Ce,Lt,U,Me){"use strict";function Ve(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function Rt(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var O=Ve(b),d=Rt(Ge),Pt=Ve(Lt);const Dt=/[^\S\r\n]*?\r?\n[^\S\r\n]*?\*[^\S\r\n]?/,Ft=/^\\@/;function Kt(e){try{return JSON.parse(e)}catch{}}function $t(e){const t=e.split(`
`)[0];if(t.includes("//META"))return zt(e);if(t.includes("/**"))return Bt(e);throw new Error("META was not found.")}function zt(e){const t=e.split(`
`)[0],n=t.substring(t.lastIndexOf("//META")+6,t.lastIndexOf("*//")),s=Kt(n);if(!s)throw new Error("META could not be parsed.");if(!s.name)throw new Error("META missing name data.");return s}function Bt(e){const t=e.split("/**",2)[1].split("*/",1)[0],n={};let s="",r="";for(const o of t.split(Dt))if(o.length!==0)if(o.charAt(0)==="@"&&o.charAt(1)!==" "){n[s]=r;const u=o.indexOf(" ");s=o.substr(1,u-1),r=o.substr(u+1)}else r+=" "+o.replace("\\n",`
`).replace(Ft,"@");return n[s]=r.trim(),delete n[""],n}const te={},Ae={};async function jt(e,t){const n=new URL(e,t).href;let s;const r=te[n];if(r?.[0]===200)s=r[1];else{if(r)throw new Error(`BD theme existed in cache with non-200 status ${r[0]}`);{const o=await fetch(n);o.status!==200&&(te[n]=[o.status,null]),s=await o.text(),te[n]=[o.status,s]}}return{url:n,CSS:()=>Promise.resolve(s),compat:!0,repoUrl:t,...$t(s)}}async function Ut(e,t){const n=new URL(e,t).href;let s=new URL(e,t).pathname.split("/");s.splice(s.length-1,1,"cumcord_theme.json");const r=new URL(s.join("/"),new URL(e,t).origin).href;let o;const u=Ae[r];if(u?.[0]===200)o=u[1];else{if(u)throw new Error(`CC manifest existed in cache with non-200 status ${u[0]}`);{const i=await fetch(r);i.status!==200&&(Ae[r]=[i.status,null]),o=await i.json(),Ae[r]=[i.status,o]}}return{url:n,compat:!1,...o,repoUrl:t,CSS:async()=>{const i=te[n];if(i?.[0]===200)return i[1];if(i)throw new Error(`CC CSS existed in cache with non-200 status ${i[0]}`);const g=await fetch(n);g.status!==200&&(te[n]=[g.status,null]);const a=await g.text();return te[n]=[g.status,a],a}}}var oe=async(e,t)=>{try{return await Ut(e,t)}catch(n){try{return await jt(e,t)}catch(s){let r=new Error("Failed to fetch theme - both CC and BD either failed to fetch or failed to parse");throw r.e1=n,r.e2=s,r}}};const ne=new Map;async function de(e){if(!e?.url||!await e.CSS())throw new Error("theme was missing either id or css.");const t=ie.injectCSS(await e.CSS());ne.set(e.url,t);const n=O.default.persist.ghost.themes.findIndex(r=>r.url===e.url);let s={...e};delete s.CSS,s.enabled=!0,n===-1?O.default.persist.ghost.themes.push(s):O.default.persist.ghost.themes[n]=s,O.default.persist.store.themes=O.default.persist.ghost.themes}function Ie(e){if(!e?.url)throw new Error("theme was missing id.");ne.get(e.url)?.(),ne.delete(e.url);const t=O.default.persist.ghost.themes.findIndex(s=>s.url===e.url);let n={...e};n.enabled=!1,t===-1?O.default.persist.ghost.themes.push(n):O.default.persist.ghost.themes[t]=n,O.default.persist.store.themes=O.default.persist.ghost.themes}function qe(e){try{Ie(e)}catch(t){if(t.message!=="theme was not loaded.")throw t}O.default.persist.store.themes=O.default.persist.ghost.themes.filter(t=>t.url!==e.url)}async function Wt(e){ne.get(e.url)?.(await e.CSS());let t={...e};t.enabled=!0;const n=O.default.persist.ghost.themes.findIndex(s=>s.url===e.url);n!==-1&&(O.default.persist.ghost.themes[n]=t,O.default.persist.store.themes=O.default.persist.ghost.themes)}function Ht(){ne.forEach(e=>e?.()),ne.clear()}var Yt=()=>(b.persist.ghost.themes&&b.persist.ghost.themes.filter(e=>e.enabled).forEach(async e=>de(await oe(e.url,e.repoUrl))),Ht);const Qe=(e,t)=>()=>d.createElement("img",{src:e,className:`ysink_stain_badge ysink_stain_${t}`}),Gt=Qe("https://betterdiscord.app/resources/branding/logo_small.svg","bd"),Vt=Qe("https://raw.githubusercontent.com/Cumcord/assets/main/logo/filled.svg","cc"),[fe,re,Te,Ne,q,qt,Qt,Jt,Xt,Je,Xe,Ze]=Se.batchFind(({findByProps:e,findByDisplayName:t})=>{t("FormTitle"),t("FormText"),t("FormDivider"),t("FormSection"),e("BorderColors"),t("Switch"),e("BadgeShapes"),t("Flex"),t("Select",!1),t("TextInput"),t("SmallMediaCarousel"),t("SearchBar")});var Zt=({media:e})=>d.createElement("div",{class:"ysink_stain_carousel"},e?d.createElement(Xe,{items:(typeof e=="string"?[e]:e).map(t=>({type:1,src:t})),autoplayInterval:5e3}):d.createElement("div",{className:"ysink_stain_noimg"},d.createElement(re,{className:"ysink_stain_noimgtxt"},"No Image"),d.createElement(Xe,{items:[{type:1,src:""}]})));const en=({onClick:e})=>d.createElement("svg",{onClick:e,className:"ysink_stain_delete",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px"},d.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),d.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),d.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"})),et=e=>{for(const t of b.persist.ghost.themes)if(t.url===e&&t.enabled)return!0;return!1},tn=e=>b.persist.ghost.themes.some(t=>t.url===e);var tt=({theme:e,deleteHook:t})=>(ae.useNest(b.persist,!1,(n,{path:s})=>s[0]==="themes"),d.createElement("div",{className:"ysink_stain_card"},d.createElement(Zt,{media:e.media}),d.createElement("div",{className:"ysink_stain_card_row"},e.compat?d.createElement(Gt,null):d.createElement(Vt,null),d.createElement(fe,{tag:"p",className:"ysink_stain_title"},e.name),tn(e.url)?d.createElement(en,{onClick:()=>{qe(e),t?.()}}):[],d.createElement(qt,{checked:et(e.url),onChange:async()=>et(e.url)?Ie(e):de(await oe(e.url))})),d.createElement(re,{className:"ysink_stain_desc"},e.description),d.createElement(Te,{className:"ysink_stain_divide"}),d.createElement(re,{className:"ysink_stain_author_licence"},e.author?`by ${e.author} `:"",e.license?`under ${e.license}`:""))),nn=()=>{ae.useNest(b.persist);let[e,t]=d.useState("");return d.createElement(ee.ErrorBoundary,null,d.createElement("div",{className:"ysink_stain_installbar"},d.createElement(Je,{className:"ysink_stain_input",placeholder:"Theme import URL",type:"text",value:e,onChange:n=>t(n)}),d.createElement(q,{className:"ysink_stain_button",onClick:()=>{oe(e).then(async n=>{await de(n),Ce.showToast({title:`Loaded theme ${n.name}`,duration:5e3}),t("")},()=>Ce.showToast({title:"Failed to fetch theme - check URL",duration:5e3}))}},"Install")))};function z(e){return Array.isArray?Array.isArray(e):st(e)==="[object Array]"}const rn=1/0;function sn(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-rn?"-0":t}function an(e){return e==null?"":sn(e)}function B(e){return typeof e=="string"}function nt(e){return typeof e=="number"}function on(e){return e===!0||e===!1||ln(e)&&st(e)=="[object Boolean]"}function rt(e){return typeof e=="object"}function ln(e){return rt(e)&&e!==null}function K(e){return e!=null}function Oe(e){return!e.trim().length}function st(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Or="Extended search is not available",cn="Incorrect 'index' type",un=e=>`Invalid value for key ${e}`,hn=e=>`Pattern length exceeds max of ${e}.`,dn=e=>`Missing ${e} property in key`,fn=e=>`Property 'weight' in key '${e}' must be a positive integer`,it=Object.prototype.hasOwnProperty;class gn{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(s=>{let r=at(s);n+=r.weight,this._keys.push(r),this._keyMap[r.id]=r,n+=r.weight}),this._keys.forEach(s=>{s.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function at(e){let t=null,n=null,s=null,r=1;if(B(e)||z(e))s=e,t=ot(e),n=Le(e);else{if(!it.call(e,"name"))throw new Error(dn("name"));const o=e.name;if(s=o,it.call(e,"weight")&&(r=e.weight,r<=0))throw new Error(fn(o));t=ot(o),n=Le(o)}return{path:t,id:n,weight:r,src:s}}function ot(e){return z(e)?e:e.split(".")}function Le(e){return z(e)?e.join("."):e}function pn(e,t){let n=[],s=!1;const r=(o,u,i)=>{if(!!K(o))if(!u[i])n.push(o);else{let g=u[i];const a=o[g];if(!K(a))return;if(i===u.length-1&&(B(a)||nt(a)||on(a)))n.push(an(a));else if(z(a)){s=!0;for(let h=0,y=a.length;h<y;h+=1)r(a[h],u,i+1)}else u.length&&r(a,u,i+1)}};return r(e,B(t)?t.split("."):t,0),s?n:n[0]}var w={...{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:pn,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const mn=/[^ ]+/g;function yn(e=1,t=3){const n=new Map,s=Math.pow(10,t);return{get(r){const o=r.match(mn).length;if(n.has(o))return n.get(o);const u=1/Math.pow(o,.5*e),i=parseFloat(Math.round(u*s)/s);return n.set(o,i),i},clear(){n.clear()}}}class Re{constructor({getFn:t=w.getFn,fieldNormWeight:n=w.fieldNormWeight}={}){this.norm=yn(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,s)=>{this._keysMap[n.id]=s})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,B(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){const n=this.size();B(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,s=this.size();n<s;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!K(t)||Oe(t))return;let s={v:t,i:n,n:this.norm.get(t)};this.records.push(s)}_addObject(t,n){let s={i:n,$:{}};this.keys.forEach((r,o)=>{let u=this.getFn(t,r.path);if(!!K(u)){if(z(u)){let i=[];const g=[{nestedArrIndex:-1,value:u}];for(;g.length;){const{nestedArrIndex:a,value:h}=g.pop();if(!!K(h))if(B(h)&&!Oe(h)){let y={v:h,i:a,n:this.norm.get(h)};i.push(y)}else z(h)&&h.forEach((y,k)=>{g.push({nestedArrIndex:k,value:y})})}s.$[o]=i}else if(!Oe(u)){let i={v:u,n:this.norm.get(u)};s.$[o]=i}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}}function lt(e,t,{getFn:n=w.getFn,fieldNormWeight:s=w.fieldNormWeight}={}){const r=new Re({getFn:n,fieldNormWeight:s});return r.setKeys(e.map(at)),r.setSources(t),r.create(),r}function _n(e,{getFn:t=w.getFn,fieldNormWeight:n=w.fieldNormWeight}={}){const{keys:s,records:r}=e,o=new Re({getFn:t,fieldNormWeight:n});return o.setKeys(s),o.setIndexRecords(r),o}function ge(e,{errors:t=0,currentLocation:n=0,expectedLocation:s=0,distance:r=w.distance,ignoreLocation:o=w.ignoreLocation}={}){const u=t/e.length;if(o)return u;const i=Math.abs(s-n);return r?u+i/r:i?1:u}function vn(e=[],t=w.minMatchCharLength){let n=[],s=-1,r=-1,o=0;for(let u=e.length;o<u;o+=1){let i=e[o];i&&s===-1?s=o:!i&&s!==-1&&(r=o-1,r-s+1>=t&&n.push([s,r]),s=-1)}return e[o-1]&&o-s>=t&&n.push([s,o-1]),n}const Q=32;function En(e,t,n,{location:s=w.location,distance:r=w.distance,threshold:o=w.threshold,findAllMatches:u=w.findAllMatches,minMatchCharLength:i=w.minMatchCharLength,includeMatches:g=w.includeMatches,ignoreLocation:a=w.ignoreLocation}={}){if(t.length>Q)throw new Error(hn(Q));const h=t.length,y=e.length,k=Math.max(0,Math.min(s,y));let M=o,A=k;const I=i>1||g,C=I?Array(y):[];let x;for(;(x=e.indexOf(t,A))>-1;){let v=ge(t,{currentLocation:x,expectedLocation:k,distance:r,ignoreLocation:a});if(M=Math.min(v,M),A=x+h,I){let S=0;for(;S<h;)C[x+S]=1,S+=1}}A=-1;let c=[],l=1,f=h+y;const p=1<<h-1;for(let v=0;v<h;v+=1){let S=0,E=f;for(;S<E;)ge(t,{errors:v,currentLocation:k+E,expectedLocation:k,distance:r,ignoreLocation:a})<=M?S=E:f=E,E=Math.floor((f-S)/2+S);f=E;let N=Math.max(1,k-E+1),T=u?y:Math.min(k+E,y)+h,P=Array(T+2);P[T+1]=(1<<v)-1;for(let D=T;D>=N;D-=1){let G=D-1,X=n[e.charAt(G)];if(I&&(C[G]=+!!X),P[D]=(P[D+1]<<1|1)&X,v&&(P[D]|=(c[D+1]|c[D])<<1|1|c[D+1]),P[D]&p&&(l=ge(t,{errors:v,currentLocation:G,expectedLocation:k,distance:r,ignoreLocation:a}),l<=M)){if(M=l,A=G,A<=k)break;N=Math.max(1,2*k-A)}}if(ge(t,{errors:v+1,currentLocation:k,expectedLocation:k,distance:r,ignoreLocation:a})>M)break;c=P}const m={isMatch:A>=0,score:Math.max(.001,l)};if(I){const v=vn(C,i);v.length?g&&(m.indices=v):m.isMatch=!1}return m}function kn(e){let t={};for(let n=0,s=e.length;n<s;n+=1){const r=e.charAt(n);t[r]=(t[r]||0)|1<<s-n-1}return t}class ct{constructor(t,{location:n=w.location,threshold:s=w.threshold,distance:r=w.distance,includeMatches:o=w.includeMatches,findAllMatches:u=w.findAllMatches,minMatchCharLength:i=w.minMatchCharLength,isCaseSensitive:g=w.isCaseSensitive,ignoreLocation:a=w.ignoreLocation}={}){if(this.options={location:n,threshold:s,distance:r,includeMatches:o,findAllMatches:u,minMatchCharLength:i,isCaseSensitive:g,ignoreLocation:a},this.pattern=g?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const h=(k,M)=>{this.chunks.push({pattern:k,alphabet:kn(k),startIndex:M})},y=this.pattern.length;if(y>Q){let k=0;const M=y%Q,A=y-M;for(;k<A;)h(this.pattern.substr(k,Q),k),k+=Q;if(M){const I=y-Q;h(this.pattern.substr(I),I)}}else h(this.pattern,0)}searchIn(t){const{isCaseSensitive:n,includeMatches:s}=this.options;if(n||(t=t.toLowerCase()),this.pattern===t){let A={isMatch:!0,score:0};return s&&(A.indices=[[0,t.length-1]]),A}const{location:r,distance:o,threshold:u,findAllMatches:i,minMatchCharLength:g,ignoreLocation:a}=this.options;let h=[],y=0,k=!1;this.chunks.forEach(({pattern:A,alphabet:I,startIndex:C})=>{const{isMatch:x,score:c,indices:l}=En(t,A,I,{location:r+C,distance:o,threshold:u,findAllMatches:i,minMatchCharLength:g,includeMatches:s,ignoreLocation:a});x&&(k=!0),y+=c,x&&l&&(h=[...h,...l])});let M={isMatch:k,score:k?y/this.chunks.length:1};return k&&s&&(M.indices=h),M}}class W{constructor(t){this.pattern=t}static isMultiMatch(t){return ut(t,this.multiRegex)}static isSingleMatch(t){return ut(t,this.singleRegex)}search(){}}function ut(e,t){const n=e.match(t);return n?n[1]:null}class wn extends W{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class bn extends W{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const s=t.indexOf(this.pattern)===-1;return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class xn extends W{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class Sn extends W{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class Cn extends W{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class Mn extends W{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class ht extends W{constructor(t,{location:n=w.location,threshold:s=w.threshold,distance:r=w.distance,includeMatches:o=w.includeMatches,findAllMatches:u=w.findAllMatches,minMatchCharLength:i=w.minMatchCharLength,isCaseSensitive:g=w.isCaseSensitive,ignoreLocation:a=w.ignoreLocation}={}){super(t);this._bitapSearch=new ct(t,{location:n,threshold:s,distance:r,includeMatches:o,findAllMatches:u,minMatchCharLength:i,isCaseSensitive:g,ignoreLocation:a})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class dt extends W{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n=0,s;const r=[],o=this.pattern.length;for(;(s=t.indexOf(this.pattern,n))>-1;)n=s+o,r.push([s,n-1]);const u=!!r.length;return{isMatch:u,score:u?0:1,indices:r}}}const Pe=[wn,dt,xn,Sn,Mn,Cn,bn,ht],ft=Pe.length,An=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,In="|";function Tn(e,t={}){return e.split(In).map(n=>{let s=n.trim().split(An).filter(o=>o&&!!o.trim()),r=[];for(let o=0,u=s.length;o<u;o+=1){const i=s[o];let g=!1,a=-1;for(;!g&&++a<ft;){const h=Pe[a];let y=h.isMultiMatch(i);y&&(r.push(new h(y,t)),g=!0)}if(!g)for(a=-1;++a<ft;){const h=Pe[a];let y=h.isSingleMatch(i);if(y){r.push(new h(y,t));break}}}return r})}const Nn=new Set([ht.type,dt.type]);class On{constructor(t,{isCaseSensitive:n=w.isCaseSensitive,includeMatches:s=w.includeMatches,minMatchCharLength:r=w.minMatchCharLength,ignoreLocation:o=w.ignoreLocation,findAllMatches:u=w.findAllMatches,location:i=w.location,threshold:g=w.threshold,distance:a=w.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:s,minMatchCharLength:r,findAllMatches:u,ignoreLocation:o,location:i,threshold:g,distance:a},this.pattern=n?t:t.toLowerCase(),this.query=Tn(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:s,isCaseSensitive:r}=this.options;t=r?t:t.toLowerCase();let o=0,u=[],i=0;for(let g=0,a=n.length;g<a;g+=1){const h=n[g];u.length=0,o=0;for(let y=0,k=h.length;y<k;y+=1){const M=h[y],{isMatch:A,indices:I,score:C}=M.search(t);if(A){if(o+=1,i+=C,s){const x=M.constructor.type;Nn.has(x)?u=[...u,...I]:u.push(I)}}else{i=0,o=0,u.length=0;break}}if(o){let y={isMatch:!0,score:i/o};return s&&(y.indices=u),y}}return{isMatch:!1,score:1}}}const De=[];function Ln(...e){De.push(...e)}function Fe(e,t){for(let n=0,s=De.length;n<s;n+=1){let r=De[n];if(r.condition(e,t))return new r(e,t)}return new ct(e,t)}const pe={AND:"$and",OR:"$or"},Ke={PATH:"$path",PATTERN:"$val"},$e=e=>!!(e[pe.AND]||e[pe.OR]),Rn=e=>!!e[Ke.PATH],Pn=e=>!z(e)&&rt(e)&&!$e(e),gt=e=>({[pe.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function pt(e,t,{auto:n=!0}={}){const s=r=>{let o=Object.keys(r);const u=Rn(r);if(!u&&o.length>1&&!$e(r))return s(gt(r));if(Pn(r)){const g=u?r[Ke.PATH]:o[0],a=u?r[Ke.PATTERN]:r[g];if(!B(a))throw new Error(un(g));const h={keyId:Le(g),pattern:a};return n&&(h.searcher=Fe(a,t)),h}let i={children:[],operator:o[0]};return o.forEach(g=>{const a=r[g];z(a)&&a.forEach(h=>{i.children.push(s(h))})}),i};return $e(e)||(e=gt(e)),s(e)}function Dn(e,{ignoreFieldNorm:t=w.ignoreFieldNorm}){e.forEach(n=>{let s=1;n.matches.forEach(({key:r,norm:o,score:u})=>{const i=r?r.weight:null;s*=Math.pow(u===0&&i?Number.EPSILON:u,(i||1)*(t?1:o))}),n.score=s})}function Fn(e,t){const n=e.matches;t.matches=[],!!K(n)&&n.forEach(s=>{if(!K(s.indices)||!s.indices.length)return;const{indices:r,value:o}=s;let u={indices:r,value:o};s.key&&(u.key=s.key.src),s.idx>-1&&(u.refIndex=s.idx),t.matches.push(u)})}function Kn(e,t){t.score=e.score}function $n(e,t,{includeMatches:n=w.includeMatches,includeScore:s=w.includeScore}={}){const r=[];return n&&r.push(Fn),s&&r.push(Kn),e.map(o=>{const{idx:u}=o,i={item:t[u],refIndex:u};return r.length&&r.forEach(g=>{g(o,i)}),i})}class se{constructor(t,n={},s){this.options={...w,...n},this.options.useExtendedSearch,this._keyStore=new gn(this.options.keys),this.setCollection(t,s)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof Re))throw new Error(cn);this._myIndex=n||lt(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){!K(t)||(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const n=[];for(let s=0,r=this._docs.length;s<r;s+=1){const o=this._docs[s];t(o,s)&&(this.removeAt(s),s-=1,r-=1,n.push(o))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){const{includeMatches:s,includeScore:r,shouldSort:o,sortFn:u,ignoreFieldNorm:i}=this.options;let g=B(t)?B(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return Dn(g,{ignoreFieldNorm:i}),o&&g.sort(u),nt(n)&&n>-1&&(g=g.slice(0,n)),$n(g,this._docs,{includeMatches:s,includeScore:r})}_searchStringList(t){const n=Fe(t,this.options),{records:s}=this._myIndex,r=[];return s.forEach(({v:o,i:u,n:i})=>{if(!K(o))return;const{isMatch:g,score:a,indices:h}=n.searchIn(o);g&&r.push({item:o,idx:u,matches:[{score:a,value:o,norm:i,indices:h}]})}),r}_searchLogical(t){const n=pt(t,this.options),s=(i,g,a)=>{if(!i.children){const{keyId:y,searcher:k}=i,M=this._findMatches({key:this._keyStore.get(y),value:this._myIndex.getValueForItemAtKeyId(g,y),searcher:k});return M&&M.length?[{idx:a,item:g,matches:M}]:[]}const h=[];for(let y=0,k=i.children.length;y<k;y+=1){const M=i.children[y],A=s(M,g,a);if(A.length)h.push(...A);else if(i.operator===pe.AND)return[]}return h},r=this._myIndex.records,o={},u=[];return r.forEach(({$:i,i:g})=>{if(K(i)){let a=s(n,i,g);a.length&&(o[g]||(o[g]={idx:g,item:i,matches:[]},u.push(o[g])),a.forEach(({matches:h})=>{o[g].matches.push(...h)}))}}),u}_searchObjectList(t){const n=Fe(t,this.options),{keys:s,records:r}=this._myIndex,o=[];return r.forEach(({$:u,i})=>{if(!K(u))return;let g=[];s.forEach((a,h)=>{g.push(...this._findMatches({key:a,value:u[h],searcher:n}))}),g.length&&o.push({idx:i,item:u,matches:g})}),o}_findMatches({key:t,value:n,searcher:s}){if(!K(n))return[];let r=[];if(z(n))n.forEach(({v:o,i:u,n:i})=>{if(!K(o))return;const{isMatch:g,score:a,indices:h}=s.searchIn(o);g&&r.push({score:a,key:t,value:o,idx:u,norm:i,indices:h})});else{const{v:o,n:u}=n,{isMatch:i,score:g,indices:a}=s.searchIn(o);i&&r.push({score:g,key:t,value:o,norm:u,indices:a})}return r}}se.version="6.5.3",se.createIndex=lt,se.parseIndex=_n,se.config=w,se.parseQuery=pt,Ln(On);const zn={threshold:.5,useExtendedSearch:!0,keys:["name","author","description"]};var mt=(e,t)=>!t||t==""?e:new se(e,zn).search(t).map(n=>n.item),yt=({query:e,onChange:t})=>d.createElement(Ze,{className:"ysink_stain_searchbar",query:e,onQueryChange:t,placeholder:"Search themes...",size:Ze.Sizes.MEDIUM}),_t=({filterMode:e,setFilterMode:t})=>d.createElement(Xt.SingleSelect,{options:[{value:0,label:"Show All"},{value:1,label:"CC Only"},{value:2,label:"BD Only"}],value:e,onChange:t,isDisabled:!1,className:"ysink_stain_dropdown"});const vt=({title:e,subtitle:t,onClick:n,btnText:s})=>d.createElement(Ne,{className:"ysink_stain_nosplash"},d.createElement(fe,{tag:"h2"},e),d.createElement(re,null,t),d.createElement(q,{className:"ysink_stain_button",color:q.Colors.GREEN,sizes:q.Sizes.LARGE,onClick:n},s)),Bn=({goToRepos:e})=>d.createElement(vt,{title:"No Repos",subtitle:"Add one in the repo manager!",onClick:e,btnText:"Open repo manager"}),jn=({goToStore:e})=>d.createElement(vt,{title:"No Themes",subtitle:"Paste a link in above, or head over to the store",onClick:e,btnText:"Get some themes"});var Et=()=>{const[e,t]=Ge.useState(0);return()=>t(-e)},Un=({goTo:e})=>{ae.useNest(b.persist,!1,(u,{path:i})=>i[0]==="themes");const[t,n]=d.useState("");let[s,r]=d.useState(0);const o=Et();return d.createElement(ee.ErrorBoundary,null,d.createElement(nn,null),d.createElement("div",{className:"ysink_stain_search_row"},d.createElement(yt,{query:t,onChange:n}),d.createElement(_t,{filterMode:s,setFilterMode:r})),b.persist.ghost.themes.length===0?d.createElement(jn,{goToStore:()=>e(1)}):d.createElement("div",{className:"ysink_stain_cardcontainer"},mt(b.persist.ghost.themes,t).filter(u=>s===0||s===1&&!u.compat||s===2&&u.compat).map(u=>d.createElement(tt,{key:u.url,theme:u,deleteHook:o}))))},me=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},kt={};Object.defineProperty(kt,"__esModule",{value:!0});var H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Wn=function(){function e(t,n){for(var s=0;s<n.length;s++){var r=n[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),Hn=Pt.default,le=Yn(Hn);function Yn(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function Gn(e,t){var n={};for(var s in e)t.indexOf(s)>=0||!Object.prototype.hasOwnProperty.call(e,s)||(n[s]=e[s]);return n}function Vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function qn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Qn=13,Jn=9,Xn=8,Zn=89,ye=90,er=77,bt=57,xt=219,St=222,Ct=192,tr=27,Mt=100,nr=3e3,rr="navigator"in me&&/Win/i.test(navigator.platform),ze="navigator"in me&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),_e="npm__react-simple-code-editor__textarea",sr=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`+_e+`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`+_e+` {
    color: transparent !important;
  }

  .`+_e+`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`,At=function(e){qn(t,e);function t(){var n,s,r,o;Vn(this,t);for(var u=arguments.length,i=Array(u),g=0;g<u;g++)i[g]=arguments[g];return o=(s=(r=wt(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(i))),r),r.state={capture:!0},r._recordCurrentState=function(){var a=r._input;if(!!a){var h=a.value,y=a.selectionStart,k=a.selectionEnd;r._recordChange({value:h,selectionStart:y,selectionEnd:k})}},r._getLines=function(a,h){return a.substring(0,h).split(`
`)},r._recordChange=function(a){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=r._history,k=y.stack,M=y.offset;if(k.length&&M>-1){r._history.stack=k.slice(0,M+1);var A=r._history.stack.length;if(A>Mt){var I=A-Mt;r._history.stack=k.slice(I,A),r._history.offset=Math.max(r._history.offset-I,0)}}var C=Date.now();if(h){var x=r._history.stack[r._history.offset];if(x&&C-x.timestamp<nr){var c=/[^a-z0-9]([a-z0-9]+)$/i,l=r._getLines(x.value,x.selectionStart).pop().match(c),f=r._getLines(a.value,a.selectionStart).pop().match(c);if(l&&f&&f[1].startsWith(l[1])){r._history.stack[r._history.offset]=H({},a,{timestamp:C});return}}}r._history.stack.push(H({},a,{timestamp:C})),r._history.offset++},r._updateInput=function(a){var h=r._input;!h||(h.value=a.value,h.selectionStart=a.selectionStart,h.selectionEnd=a.selectionEnd,r.props.onValueChange(a.value))},r._applyEdits=function(a){var h=r._input,y=r._history.stack[r._history.offset];y&&h&&(r._history.stack[r._history.offset]=H({},y,{selectionStart:h.selectionStart,selectionEnd:h.selectionEnd})),r._recordChange(a),r._updateInput(a)},r._undoEdit=function(){var a=r._history,h=a.stack,y=a.offset,k=h[y-1];k&&(r._updateInput(k),r._history.offset=Math.max(y-1,0))},r._redoEdit=function(){var a=r._history,h=a.stack,y=a.offset,k=h[y+1];k&&(r._updateInput(k),r._history.offset=Math.min(y+1,h.length-1))},r._handleKeyDown=function(a){var h=r.props,y=h.tabSize,k=h.insertSpaces,M=h.ignoreTabKey,A=h.onKeyDown;if(!(A&&(A(a),a.defaultPrevented))){a.keyCode===tr&&a.target.blur();var I=a.target,C=I.value,x=I.selectionStart,c=I.selectionEnd,l=(k?" ":"	").repeat(y);if(a.keyCode===Jn&&!M&&r.state.capture)if(a.preventDefault(),a.shiftKey){var f=r._getLines(C,x),p=f.length-1,m=r._getLines(C,c).length-1,v=C.split(`
`).map(function(R,Z){return Z>=p&&Z<=m&&R.startsWith(l)?R.substring(l.length):R}).join(`
`);if(C!==v){var S=f[p];r._applyEdits({value:v,selectionStart:S.startsWith(l)?x-l.length:x,selectionEnd:c-(C.length-v.length)})}}else if(x!==c){var E=r._getLines(C,x),N=E.length-1,T=r._getLines(C,c).length-1,P=E[N];r._applyEdits({value:C.split(`
`).map(function(R,Z){return Z>=N&&Z<=T?l+R:R}).join(`
`),selectionStart:/\S/.test(P)?x+l.length:x,selectionEnd:c+l.length*(T-N+1)})}else{var Y=x+l.length;r._applyEdits({value:C.substring(0,x)+l+C.substring(c),selectionStart:Y,selectionEnd:Y})}else if(a.keyCode===Xn){var D=x!==c,G=C.substring(0,x);if(G.endsWith(l)&&!D){a.preventDefault();var X=x-l.length;r._applyEdits({value:C.substring(0,x-l.length)+C.substring(c),selectionStart:X,selectionEnd:X})}}else if(a.keyCode===Qn){if(x===c){var Ee=r._getLines(C,x).pop(),L=Ee.match(/^\s+/);if(L&&L[0]){a.preventDefault();var $=`
`+L[0],j=x+$.length;r._applyEdits({value:C.substring(0,x)+$+C.substring(c),selectionStart:j,selectionEnd:j})}}}else if(a.keyCode===bt||a.keyCode===xt||a.keyCode===St||a.keyCode===Ct){var F=void 0;a.keyCode===bt&&a.shiftKey?F=["(",")"]:a.keyCode===xt?a.shiftKey?F=["{","}"]:F=["[","]"]:a.keyCode===St?a.shiftKey?F=['"','"']:F=["'","'"]:a.keyCode===Ct&&!a.shiftKey&&(F=["`","`"]),x!==c&&F&&(a.preventDefault(),r._applyEdits({value:C.substring(0,x)+F[0]+C.substring(x,c)+F[1]+C.substring(c),selectionStart:x,selectionEnd:c+2}))}else(ze?a.metaKey&&a.keyCode===ye:a.ctrlKey&&a.keyCode===ye)&&!a.shiftKey&&!a.altKey?(a.preventDefault(),r._undoEdit()):(ze?a.metaKey&&a.keyCode===ye&&a.shiftKey:rr?a.ctrlKey&&a.keyCode===Zn:a.ctrlKey&&a.keyCode===ye&&a.shiftKey)&&!a.altKey?(a.preventDefault(),r._redoEdit()):a.keyCode===er&&a.ctrlKey&&(ze?a.shiftKey:!0)&&(a.preventDefault(),r.setState(function(R){return{capture:!R.capture}}))}},r._handleChange=function(a){var h=a.target,y=h.value,k=h.selectionStart,M=h.selectionEnd;r._recordChange({value:y,selectionStart:k,selectionEnd:M},!0),r.props.onValueChange(y)},r._history={stack:[],offset:-1},s),wt(r,o)}return Wn(t,[{key:"componentDidMount",value:function(){this._recordCurrentState()}},{key:"render",value:function(){var s=this,r=this.props,o=r.value,u=r.style,i=r.padding,g=r.highlight,a=r.textareaId,h=r.textareaClassName,y=r.autoFocus,k=r.disabled,M=r.form,A=r.maxLength,I=r.minLength,C=r.name,x=r.placeholder,c=r.readOnly,l=r.required,f=r.onClick,p=r.onFocus,m=r.onBlur,v=r.onKeyUp;r.onKeyDown,r.onValueChange,r.tabSize,r.insertSpaces,r.ignoreTabKey;var S=r.preClassName,E=Gn(r,["value","style","padding","highlight","textareaId","textareaClassName","autoFocus","disabled","form","maxLength","minLength","name","placeholder","readOnly","required","onClick","onFocus","onBlur","onKeyUp","onKeyDown","onValueChange","tabSize","insertSpaces","ignoreTabKey","preClassName"]),N={paddingTop:i,paddingRight:i,paddingBottom:i,paddingLeft:i},T=g(o);return le.createElement("div",H({},E,{style:H({},ce.container,u)}),le.createElement("textarea",{ref:function(Y){return s._input=Y},style:H({},ce.editor,ce.textarea,N),className:_e+(h?" "+h:""),id:a,value:o,onChange:this._handleChange,onKeyDown:this._handleKeyDown,onClick:f,onKeyUp:v,onFocus:p,onBlur:m,disabled:k,form:M,maxLength:A,minLength:I,name:C,placeholder:x,readOnly:c,required:l,autoFocus:y,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),le.createElement("pre",H({className:S,"aria-hidden":"true",style:H({},ce.editor,ce.highlight,N)},typeof T=="string"?{dangerouslySetInnerHTML:{__html:T+"<br />"}}:{children:T})),le.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:sr}}))}},{key:"session",get:function(){return{history:this._history}},set:function(s){this._history=s.history}}]),t}(le.Component);At.defaultProps={tabSize:2,insertSpaces:!0,ignoreTabKey:!1,padding:0};var ir=kt.default=At,ce={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}},Be={exports:{}};(function(e){var t=typeof window!="undefined"?window:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(s){var r=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,o=0,u={},i={manual:s.Prism&&s.Prism.manual,disableWorkerMessageHandler:s.Prism&&s.Prism.disableWorkerMessageHandler,util:{encode:function c(l){return l instanceof g?new g(l.type,c(l.content),l.alias):Array.isArray(l)?l.map(c):l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(c){return Object.prototype.toString.call(c).slice(8,-1)},objId:function(c){return c.__id||Object.defineProperty(c,"__id",{value:++o}),c.__id},clone:function c(l,f){f=f||{};var p,m;switch(i.util.type(l)){case"Object":if(m=i.util.objId(l),f[m])return f[m];p={},f[m]=p;for(var v in l)l.hasOwnProperty(v)&&(p[v]=c(l[v],f));return p;case"Array":return m=i.util.objId(l),f[m]?f[m]:(p=[],f[m]=p,l.forEach(function(S,E){p[E]=c(S,f)}),p);default:return l}},getLanguage:function(c){for(;c;){var l=r.exec(c.className);if(l)return l[1].toLowerCase();c=c.parentElement}return"none"},setLanguage:function(c,l){c.className=c.className.replace(RegExp(r,"gi"),""),c.classList.add("language-"+l)},currentScript:function(){if(typeof document=="undefined")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(p){var c=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(p.stack)||[])[1];if(c){var l=document.getElementsByTagName("script");for(var f in l)if(l[f].src==c)return l[f]}return null}},isActive:function(c,l,f){for(var p="no-"+l;c;){var m=c.classList;if(m.contains(l))return!0;if(m.contains(p))return!1;c=c.parentElement}return!!f}},languages:{plain:u,plaintext:u,text:u,txt:u,extend:function(c,l){var f=i.util.clone(i.languages[c]);for(var p in l)f[p]=l[p];return f},insertBefore:function(c,l,f,p){p=p||i.languages;var m=p[c],v={};for(var S in m)if(m.hasOwnProperty(S)){if(S==l)for(var E in f)f.hasOwnProperty(E)&&(v[E]=f[E]);f.hasOwnProperty(S)||(v[S]=m[S])}var N=p[c];return p[c]=v,i.languages.DFS(i.languages,function(T,P){P===N&&T!=c&&(this[T]=v)}),v},DFS:function c(l,f,p,m){m=m||{};var v=i.util.objId;for(var S in l)if(l.hasOwnProperty(S)){f.call(l,S,l[S],p||S);var E=l[S],N=i.util.type(E);N==="Object"&&!m[v(E)]?(m[v(E)]=!0,c(E,f,null,m)):N==="Array"&&!m[v(E)]&&(m[v(E)]=!0,c(E,f,S,m))}}},plugins:{},highlightAll:function(c,l){i.highlightAllUnder(document,c,l)},highlightAllUnder:function(c,l,f){var p={callback:f,container:c,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",p),p.elements=Array.prototype.slice.apply(p.container.querySelectorAll(p.selector)),i.hooks.run("before-all-elements-highlight",p);for(var m=0,v;v=p.elements[m++];)i.highlightElement(v,l===!0,p.callback)},highlightElement:function(c,l,f){var p=i.util.getLanguage(c),m=i.languages[p];i.util.setLanguage(c,p);var v=c.parentElement;v&&v.nodeName.toLowerCase()==="pre"&&i.util.setLanguage(v,p);var S=c.textContent,E={element:c,language:p,grammar:m,code:S};function N(P){E.highlightedCode=P,i.hooks.run("before-insert",E),E.element.innerHTML=E.highlightedCode,i.hooks.run("after-highlight",E),i.hooks.run("complete",E),f&&f.call(E.element)}if(i.hooks.run("before-sanity-check",E),v=E.element.parentElement,v&&v.nodeName.toLowerCase()==="pre"&&!v.hasAttribute("tabindex")&&v.setAttribute("tabindex","0"),!E.code){i.hooks.run("complete",E),f&&f.call(E.element);return}if(i.hooks.run("before-highlight",E),!E.grammar){N(i.util.encode(E.code));return}if(l&&s.Worker){var T=new Worker(i.filename);T.onmessage=function(P){N(P.data)},T.postMessage(JSON.stringify({language:E.language,code:E.code,immediateClose:!0}))}else N(i.highlight(E.code,E.grammar,E.language))},highlight:function(c,l,f){var p={code:c,grammar:l,language:f};if(i.hooks.run("before-tokenize",p),!p.grammar)throw new Error('The language "'+p.language+'" has no grammar.');return p.tokens=i.tokenize(p.code,p.grammar),i.hooks.run("after-tokenize",p),g.stringify(i.util.encode(p.tokens),p.language)},tokenize:function(c,l){var f=l.rest;if(f){for(var p in f)l[p]=f[p];delete l.rest}var m=new y;return k(m,m.head,c),h(c,m,l,m.head,0),A(m)},hooks:{all:{},add:function(c,l){var f=i.hooks.all;f[c]=f[c]||[],f[c].push(l)},run:function(c,l){var f=i.hooks.all[c];if(!(!f||!f.length))for(var p=0,m;m=f[p++];)m(l)}},Token:g};s.Prism=i;function g(c,l,f,p){this.type=c,this.content=l,this.alias=f,this.length=(p||"").length|0}g.stringify=function c(l,f){if(typeof l=="string")return l;if(Array.isArray(l)){var p="";return l.forEach(function(N){p+=c(N,f)}),p}var m={type:l.type,content:c(l.content,f),tag:"span",classes:["token",l.type],attributes:{},language:f},v=l.alias;v&&(Array.isArray(v)?Array.prototype.push.apply(m.classes,v):m.classes.push(v)),i.hooks.run("wrap",m);var S="";for(var E in m.attributes)S+=" "+E+'="'+(m.attributes[E]||"").replace(/"/g,"&quot;")+'"';return"<"+m.tag+' class="'+m.classes.join(" ")+'"'+S+">"+m.content+"</"+m.tag+">"};function a(c,l,f,p){c.lastIndex=l;var m=c.exec(f);if(m&&p&&m[1]){var v=m[1].length;m.index+=v,m[0]=m[0].slice(v)}return m}function h(c,l,f,p,m,v){for(var S in f)if(!(!f.hasOwnProperty(S)||!f[S])){var E=f[S];E=Array.isArray(E)?E:[E];for(var N=0;N<E.length;++N){if(v&&v.cause==S+","+N)return;var T=E[N],P=T.inside,Y=!!T.lookbehind,D=!!T.greedy,G=T.alias;if(D&&!T.pattern.global){var X=T.pattern.toString().match(/[imsuy]*$/)[0];T.pattern=RegExp(T.pattern.source,X+"g")}for(var Ee=T.pattern||T,L=p.next,$=m;L!==l.tail&&!(v&&$>=v.reach);$+=L.value.length,L=L.next){var j=L.value;if(l.length>c.length)return;if(!(j instanceof g)){var F=1,R;if(D){if(R=a(Ee,$,c,Y),!R||R.index>=c.length)break;var ke=R.index,Z=R.index+R[0].length,V=$;for(V+=L.value.length;ke>=V;)L=L.next,V+=L.value.length;if(V-=L.value.length,$=V,L.value instanceof g)continue;for(var he=L;he!==l.tail&&(V<Z||typeof he.value=="string");he=he.next)F++,V+=he.value.length;F--,j=c.slice($,V),R.index-=$}else if(R=a(Ee,0,j,Y),!R)continue;var ke=R.index,we=R[0],We=j.slice(0,ke),Ot=j.slice(ke+we.length),He=$+j.length;v&&He>v.reach&&(v.reach=He);var be=L.prev;We&&(be=k(l,be,We),$+=We.length),M(l,be,F);var Nr=new g(S,P?i.tokenize(we,P):we,G,we);if(L=k(l,be,Nr),Ot&&k(l,L,Ot),F>1){var Ye={cause:S+","+N,reach:He};h(c,l,f,L.prev,$,Ye),v&&Ye.reach>v.reach&&(v.reach=Ye.reach)}}}}}}function y(){var c={value:null,prev:null,next:null},l={value:null,prev:c,next:null};c.next=l,this.head=c,this.tail=l,this.length=0}function k(c,l,f){var p=l.next,m={value:f,prev:l,next:p};return l.next=m,p.prev=m,c.length++,m}function M(c,l,f){for(var p=l.next,m=0;m<f&&p!==c.tail;m++)p=p.next;l.next=p,p.prev=l,c.length-=m}function A(c){for(var l=[],f=c.head.next;f!==c.tail;)l.push(f.value),f=f.next;return l}if(!s.document)return s.addEventListener&&(i.disableWorkerMessageHandler||s.addEventListener("message",function(c){var l=JSON.parse(c.data),f=l.language,p=l.code,m=l.immediateClose;s.postMessage(i.highlight(p,i.languages[f],f)),m&&s.close()},!1)),i;var I=i.util.currentScript();I&&(i.filename=I.src,I.hasAttribute("data-manual")&&(i.manual=!0));function C(){i.manual||i.highlightAll()}if(!i.manual){var x=document.readyState;x==="loading"||x==="interactive"&&I&&I.defer?document.addEventListener("DOMContentLoaded",C):window.requestAnimationFrame?window.requestAnimationFrame(C):window.setTimeout(C,16)}return i}(t);e.exports&&(e.exports=n),typeof me!="undefined"&&(me.Prism=n)})(Be),function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(Prism);const ar=e=>b.reloadCSS(b.persist.store.quickCSS=e),or=_.debounce(ar,250);var lr=()=>{const[e,t]=d.useState(b.persist.ghost.quickCSS);return d.createElement(ee.ErrorBoundary,null,d.createElement("div",{class:"ysink_stain_quickcss"},d.createElement(ir,{className:"ysink_stain_editorroot",value:e??"",onValueChange:n=>{t(n),or(n)},highlight:n=>Be.exports.highlight(n,Be.exports.languages.css),padding:10}),d.createElement("link",{href:"https://cdn.jsdelivr.net/gh/PrismJS/prism-themes@master/themes/prism-atom-dark.css",rel:"stylesheet"}),d.createElement("style",null,`:root { --background-primary: #1d1f21; } .theme-light .${Se.findByProps("contentColumn").contentColumn} { --text-normal: white; }`)))};const je={};async function cr(e){if(je[e])return je[e];const t=new URL("repo.json",e).href,n=await(await fetch(t)).json();if(!n.themes||n.themes?.length===0)throw new Error("No themes found in repo");if(!n.meta)throw new Error("No repo metadata");if(!n?.meta.name)throw new Error("Repo did not have a name");return je[e]=n,n}var ve=async e=>{const t=await cr(e),n=await Promise.all(t.themes.map(s=>oe(s,e)));return{manifest:t,themes:n}};const It=["https://cumcordthemes.github.io/Cumsock/"],ur=It;var hr=async()=>{Array.isArray(b.persist.ghost.repos)||(b.persist.ghost.repos=[]);for(const e of It)if(!b.persist.ghost.repos.find(t=>t.url===e.url)){try{await ve(e)}catch{continue}b.persist.ghost.repos.push(e)}b.persist.set({path:["repos"],value:b.persist.ghost.repos})},dr=({repo:e})=>{const[t,n]=d.useState(void 0);return d.useEffect(async()=>{t||n(await ve(e))}),d.createElement("div",{className:"ysink_stain_card ysink_stain_repocard"},d.createElement("div",{className:"ysink_stain_row"},d.createElement("div",null,d.createElement(fe,{tag:"p",className:"ysink_stain_title"},t?.manifest.meta.name,ur.includes(e)?d.createElement(Qt.TextBadge,{className:"ysink_stain_officialbadge",text:"official repo",color:"var(--info-positive-foreground)"}):[]),d.createElement(re,null,e)),d.createElement(q,{color:q.Colors.RED,className:"ysink_stain_button",onClick:()=>b.persist.store.repos=b.persist.ghost.repos.filter(s=>s!=e)},"Remove Repo")))};async function fr(e){try{return await ve(e),!0}catch{return!1}}const Ue=e=>Ce.showToast({title:e,duration:5e3});async function gr(e){if(e.endsWith("/")||(e+="/"),b.persist.ghost.repos.find(t=>t.url==e)!==void 0)return Ue("You already have this repo!"),!1;if(await fr(e)){let t=b.persist.ghost.repos;return t.push(e),b.persist.store.repos=t,Ue("Added repo"),!0}else return Ue("Repo was invalid"),!1}var pr=()=>{const[e,t]=d.useState("");return ae.useNest(b.persist),d.createElement(ee.ErrorBoundary,null,d.createElement(Ne,null,d.createElement(Jt,{basis:"auto",grow:1,shrink:1,className:"ysink_stain_row"},d.createElement(Je,{placeholder:"https://example.com/repo",type:"text",value:e,onChange:n=>t(n)}),d.createElement(q,{className:"ysink_stain_button",onClick:async()=>{await gr(e)&&t("")}},"Add")),d.createElement(Te,{className:"ysink_stain_divide"}),b.persist.ghost.repos.map(n=>d.createElement(dr,{repo:n}))))};const mr=()=>Promise.all(b.persist.ghost.repos.map(ve)),yr=async()=>(await mr()).flatMap(e=>e.themes),_r=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((n,s)=>n===t[s]);var vr=({goTo:e})=>{ae.useNest(b.persist,!1,(h,{path:y})=>y[0]==="repos");const[t,n]=d.useState(""),[s,r]=d.useState([]),[o,u]=d.useState(void 0),[i,g]=d.useState(0);d.useEffect(()=>{(!_r(s,b.persist.ghost.repos)||!o)&&(r(b.persist.ghost.repos),yr().then(u))});const a=Et();return d.createElement(ee.ErrorBoundary,null,d.createElement("div",{className:"ysink_stain_search_row"},d.createElement(yt,{query:t,onChange:n}),d.createElement(_t,{filterMode:i,setFilterMode:g})),b.persist.ghost.repos.length===0?d.createElement(Bn,{goToRepos:()=>e(2)}):d.createElement("div",{className:"ysink_stain_cardcontainer"},mt(_.uniqBy(o??[],h=>h.url),t).filter(h=>i===0||i===1&&!h.compat||i===2&&h.compat).map(h=>d.createElement(tt,{key:h.url,theme:h,deleteHook:a}))))},Er=({items:e})=>{let[t,n]=d.useState(0);return d.createElement("div",{className:"ysink_stain_tabbar_root"},d.createElement("div",{className:"ysink_stain_tabbar"},e.map((s,r)=>d.createElement("button",{className:"ysink_stain_button"+(r===t?" ysink_stain_selected":""),onClick:()=>n(r)},d.createElement(re,null,s.text)))),d.createElement(Te,{className:"ysink_stain_divide"}),d.createElement("div",{className:"ysink_stain_tabbar_content"},d.createElement(e[t].component,{goTo:n})))},kr=()=>d.createElement(ee.ErrorBoundary,null,d.createElement(Ne,null,d.createElement(fe,{tag:"h1"},"Cumstain Settings"),d.createElement(Er,{items:[{text:"Installed",component:Un},{text:"Store",component:vr},{text:"Repos",component:pr},{text:"Quick CSS",component:lr}]}))),wr=()=>ie.findAndPatch(()=>Se.findByDisplayName("SettingsView"),e=>ie.after("getPredicateSections",e.prototype,(t,n)=>{if(n[1]?.section!="My Account")return;let s=n.findIndex(r=>r.section=="CUMCORD_PLUGINS")+1;return n.splice(s,0,{section:"ysink_stain_CUMSTAIN",label:"Themes",element:kr}),n})),br=()=>{const e=ie.injectCSS(O.default.persist.ghost.quickCSS);return O.default.reloadCSS=t=>e(t??O.default.persist.ghost.quickCSS),()=>{e(),O.default.reloadCSS=void 0,delete O.default.reloadCSS}};const ue=e=>b.persist.ghost.themes.find(t=>t.url===e),Tt=e=>!!ue(e)?.enabled,Nt=e=>Tt(e.url)?Wt(e):de(e),xr=async e=>await Nt(await oe(e)),Sr=e=>qe(ue(e)),Cr=async e=>{if(!ue(e))throw new Error(`Theme with ID ${e} was not installed`);Tt(e)?Ie(ue(e)):await Nt(ue(e))},J=async()=>{if(!window.cumstain){Me.error("|| CUMSTAIN || API was not found, so nests could not be updated.");return}for(const e in cumstain.installed.ghost)delete cumstain.installed.ghost[e],cumstain.installed.delete(e);for(const e of b.persist.ghost.themes)cumstain.installed.store[e.url]={enabled:e.enabled,manifest:e};for(const[e,t]of Object.entries(cumstain.installed.ghost))t.enabled?cumstain.enabled.store[e]=t:(delete cumstain.enabled.ghost[e],cumstain.installed.delete(e))};var Mr=()=>(window.cumstain={installed:U.nests.make({}),enabled:U.nests.make({}),importTheme:xr,removeTheme:Sr,toggleTheme:Cr},J(),b.persist.on(U.nests.Events.UPDATE,J),b.persist.on(U.nests.Events.SET,J),b.persist.on(U.nests.Events.DELETE,J),Me.log("|| CUMSTAIN || Initialised window.cumstain API"),()=>{b.persist.off(U.nests.Events.UPDATE,J),b.persist.off(U.nests.Events.SET,J),b.persist.off(U.nests.Events.DELETE,J),window.cumstain=void 0,delete window.cumstain,Me.log("|| CUMSTAIN || Disposed window.cumstain API")}),Ar=()=>ie.injectCSS(".ysink_stain_tabbar{padding:.5rem 1rem;display:grid;grid-auto-flow:column;grid-auto-columns:7rem}.ysink_stain_tabbar .ysink_stain_button *{cursor:pointer}.ysink_stain_tabbar>*{margin-right:1rem;padding:.2rem;border-radius:.3rem;min-width:5rem;text-align:center;background:none}.theme-dark .ysink_stain_tabbar>*.ysink_stain_selected{background:rgba(255,255,255,.2666666667)}.theme-light .ysink_stain_tabbar>*.ysink_stain_selected{background:rgba(0,0,0,.2)}.ysink_stain_tabbar>*:last-child{margin-right:0}.ysink_stain_cardcontainer{display:flex;flex-flow:row wrap;gap:.75rem}.ysink_stain_cardcontainer>*{width:20rem}.ysink_stain_card{padding:1rem;border:1px solid var(--background-modifier-accent);border-radius:.5rem;display:flex;flex-direction:column;z-index:1;background-color:var(--deprecated-card-bg)}.ysink_stain_card .ysink_stain_title{font-size:1rem;padding-top:.2rem;display:inline;flex:1;margin:0}.ysink_stain_card .ysink_stain_button{display:inline;padding:0}.ysink_stain_card .ysink_stain_button>div{padding:2px 16px}.ysink_stain_card .ysink_stain_card_row{display:flex;margin-bottom:.5rem}.ysink_stain_card .ysink_stain_author_licence{font-style:italic}.ysink_stain_card .ysink_stain_desc{flex:1}.ysink_stain_card .ysink_stain_carousel{margin-bottom:1rem}.ysink_stain_card .ysink_stain_carousel>div:not(.ysink_stain_noimg)>:last-child,.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg>div>:last-child{height:2.25rem}.ysink_stain_card .ysink_stain_carousel>div{border-radius:.5rem}.theme-dark .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:rgba(0,0,0,.3333333333)}.theme-light .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:rgba(0,0,0,.8666666667)}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg{display:grid}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div{grid-area:1/1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div:not(.ysink_stain_noimgtxt){visibility:hidden;z-index:-1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div.ysink_stain_noimgtxt{grid-area:1/1;font-size:1.5rem;text-align:center;padding-top:35%;text-transform:uppercase;opacity:.8}.ysink_stain_divide{margin:.5rem 0}.ysink_stain_card .ysink_stain_divide{margin:.2rem 0}.ysink_stain_delete{margin-right:.5rem;fill:var(--interactive-normal)}.ysink_stain_installbar{display:flex}.ysink_stain_installbar>*{flex:1}.ysink_stain_installbar>:last-child{flex:unset;margin-left:1rem}.ysink_stain_searchbar{margin:.75rem 0}.ysink_stain_search_row{display:flex;gap:.75rem;margin:.75rem 0}.ysink_stain_search_row .ysink_stain_dropdown{height:2.25rem;flex-basis:10rem;padding-top:.3rem}.ysink_stain_search_row .ysink_stain_searchbar{margin:unset;flex:1}.ysink_stain_editorroot{background:tranparent;color:#c5c8c6;font-family:var(--font-code);font-size:.9rem;line-height:1.1rem}.ysink_stain_badge{width:1.5rem;height:1.5rem;margin-right:.5rem;border-radius:50%}.ysink_stain_badge.ysink_stain_bd{padding:.25rem;background:#040405}.ysink_stain_badge.ysink_stain_cc{padding:.1rem;background:#f8f8f8;background:#7289DA}.ysink_stain_nosplash{display:flex;flex-direction:column;align-items:center;margin-top:15rem;gap:.5rem}.ysink_stain_nosplash h2{margin-bottom:0}.ysink_stain_nosplash>*{flex:0}.ysink_stain_nosplash .ysink_stain_button{margin-top:2rem}.ysink_stain_row{display:flex}.ysink_stain_row>*{flex:1}.ysink_stain_row>:last-child{flex:unset;margin-left:1rem}.ysink_stain_officialbadge{display:inline;margin-left:.5rem}.ysink_stain_repocard{margin-bottom:.25rem}");Array.isArray(b.persist.ghost.repos)||hr(),Array.isArray(b.persist.ghost.themes)||(b.persist.store.themes=[]);const Ir=[br(),Yt(),Mr(),wr(),Ar()],Tr=()=>_.forEachRight(Ir,e=>e());return xe.onUnload=Tr,Object.defineProperty(xe,"__esModule",{value:!0}),xe})({},cumcord.pluginData,cumcord.patcher,cumcord.modules.webpack,cumcord.modules.common.React,cumcord.utils,cumcord.ui.components,cumcord.ui.toasts,cumcord.modules.common.React,cumcord.modules.internal,cumcord.utils.logger);
