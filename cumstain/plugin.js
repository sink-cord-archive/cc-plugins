(function(N,ge,ft,$,Z,v,se,Oe,gt,pe){"use strict";function ye(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var R=ye(N),pt=ye(ft),yt=ye(gt);function me(t){if(!t?.id||!t.CSS)throw new Error("theme was missing either id or css.");const e=ge.injectCSS(t.CSS);R.default.state.ghost.unpatchCache.set(t.id,e);const r=R.default.persist.ghost.themes.findIndex(n=>n.id===t.id);let s={...t};s.enabled=!0,r===-1?R.default.persist.ghost.themes.push(s):R.default.persist.ghost.themes[r]=s,R.default.persist.store.themes=R.default.persist.ghost.themes}function Le(t){if(!t?.id)throw new Error("theme was missing id.");R.default.state.ghost.unpatchCache.get(t.id)?.(),R.default.state.ghost.unpatchCache.delete(t.id);const r=R.default.persist.ghost.themes.findIndex(n=>n.id===t.id);let s={...t};s.enabled=!1,r===-1?R.default.persist.ghost.themes.push(s):R.default.persist.ghost.themes[r]=s,R.default.persist.store.themes=R.default.persist.ghost.themes}function mt(t){try{Le(t)}catch(e){if(e.message!=="theme was not loaded.")throw e}R.default.persist.store.themes=R.default.persist.ghost.themes.filter(e=>e.id!==t.id)}function _t(){R.default.state.ghost.unpatchCache.forEach(t=>t?.()),R.default.state.ghost.unpatchCache.clear()}var vt=()=>(N.persist.ghost.themes&&N.persist.ghost.themes.filter(t=>t.enabled).forEach(me),_t),Et=()=>(R.default.persist.ghost.repos||(R.default.persist.store.repos=[]),R.default.persist.ghost.themes||(R.default.persist.store.themes=[]),R.default.state=pt.default.make({unpatchCache:new Map}),()=>{R.default.state=void 0,delete R.default.state});const St=v.React.useState,bt=v.React.createElement,kt=$.findByDisplayName("FormText"),xt=$.findByDisplayName("FormDivider");var wt=({items:t})=>{let[e,r]=St(0);return v.React.createElement("div",{className:"ysink_stain_tabbar_root"},v.React.createElement("div",{className:"ysink_stain_tabbar"},t.map((s,n)=>v.React.createElement("button",{className:"ysink_stain_button"+(n===e?" ysink_stain_selected":""),onClick:()=>r(n)},v.React.createElement(kt,null,s.text)))),v.React.createElement(xt,{className:"ysink_stain_divide"}),v.React.createElement("div",{className:"ysink_stain_tabbar_content"},bt(t[e].component)))},Ct=()=>v.React.createElement("img",{src:"https://betterdiscord.app/resources/branding/logo_small.svg",className:"ysink_stain_badge ysink_stain_bd"}),Mt=()=>v.React.createElement("img",{src:"https://avatars.githubusercontent.com/u/81397549",className:"ysink_stain_badge ysink_stain_cc"}),Rt=({theme:t,onClick:e})=>v.React.createElement("svg",{onClick:e,className:"ysink_stain_delete",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px"},v.React.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),v.React.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),v.React.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}));const It=$.findByDisplayName("FormTitle"),_e=$.findByDisplayName("FormText"),At=$.findByDisplayName("FormSection"),Tt=$.findByDisplayName("FormDivider"),Nt=$.findByDisplayName("Switch"),De=t=>{for(const e of N.persist.ghost.themes)if(e.id===t&&e.enabled)return!0;return!1},Ot=t=>N.persist.ghost.themes.some(e=>e.id===t);var Fe=({theme:t,deleteHook:e})=>(se.useNest(N.persist),v.React.createElement("div",{className:"ysink_stain_card"},v.React.createElement(At,null,v.React.createElement("div",{className:"ysink_stain_img",style:{backgroundImage:`url(${t.media})`}},t.media?[]:v.React.createElement(_e,null,"No Image")),v.React.createElement("div",{className:"ysink_stain_row"},t.compat?v.React.createElement(Ct,null):v.React.createElement(Mt,null),v.React.createElement(It,{tag:"p",className:"ysink_stain_title"},t.name),Ot(t.id)?v.React.createElement(Rt,{theme:t,onClick:()=>{mt(t),e?.()}}):[],v.React.createElement(Nt,{checked:De(t.id),onChange:()=>De(t.id)?Le(t):me(t)})),v.React.createElement(_e,{className:"ysink_stain_desc"},t.description),v.React.createElement(Tt,{className:"ysink_stain_divide"}),v.React.createElement(_e,{className:"ysink_stain_author_licence"},t.author?`by ${t.author} `:"",t.license?`under ${t.license}`:""))));const Lt=/[^\S\r\n]*?\r?\n[^\S\r\n]*?\*[^\S\r\n]?/,Dt=/^\\@/;function Ft(t){try{return JSON.parse(t)}catch{}}function $t(t){const e=t.split(`
`)[0];if(e.includes("//META"))return Kt(t);if(e.includes("/**"))return Pt(t);throw new Error("META was not found.")}function Kt(t){const e=t.split(`
`)[0],r=e.substring(e.lastIndexOf("//META")+6,e.lastIndexOf("*//")),s=Ft(r);if(!s)throw new Error("META could not be parsed.");if(!s.name)throw new Error("META missing name data.");return s}function Pt(t){const e=t.split("/**",2)[1].split("*/",1)[0],r={};let s="",n="";for(const o of e.split(Lt))if(o.length!==0)if(o.charAt(0)==="@"&&o.charAt(1)!==" "){r[s]=n;const u=o.indexOf(" ");s=o.substr(1,u-1),n=o.substr(u+1)}else n+=" "+o.replace("\\n",`
`).replace(Dt,"@");return r[s]=n.trim(),delete r[""],r}async function Bt(t,e){const r=await(await fetch(new URL(t,e).href)).text();return{id:t,CSS:r,compat:!0,...$t(r)}}async function zt(t,e){const r=await(await fetch(new URL(t,e).href)).text();let s=new URL(t,e).pathname.split("/");s.splice(s.length-1,1,"cumcord_theme.json");const n=new URL(s.join("/"),new URL(t,e).origin),o=await(await fetch(n.href)).json();return{id:t,CSS:r,compat:!1,...o}}var ve=async(t,e)=>{try{return await zt(t,e)}catch(r){try{return await Bt(t,e)}catch(s){let n=new Error("Failed to fetch theme - both CC and BD either failed to fetch or failed to parse");throw n.e1=r,n.e2=s,n}}};const{useState:Ut}=v.React,jt=$.findByProps("Sizes","Colors","Looks","DropdownSizes"),Ht=$.findByDisplayName("TextInput");var Wt=()=>{se.useNest(N.persist);let[t,e]=Ut("");return v.React.createElement(Z.ErrorBoundary,null,v.React.createElement("div",{className:"ysink_stain_installbar"},v.React.createElement(Ht,{className:"ysink_stain_input",placeholder:"Theme import URL",type:"text",value:t,onChange:r=>e(r)}),v.React.createElement(jt,{className:"ysink_stain_button",onClick:()=>{ve(t).then(r=>{me(r),Oe.showToast({title:`Loaded theme ${r.name}`,duration:5e3})},()=>Oe.showToast({title:"Failed to fetch theme - check URL",duration:5e3})),e("")}},"Install")))};function z(t){return Array.isArray?Array.isArray(t):Pe(t)==="[object Array]"}const Yt=1/0;function Vt(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-Yt?"-0":e}function Gt(t){return t==null?"":Vt(t)}function U(t){return typeof t=="string"}function $e(t){return typeof t=="number"}function qt(t){return t===!0||t===!1||Qt(t)&&Pe(t)=="[object Boolean]"}function Ke(t){return typeof t=="object"}function Qt(t){return Ke(t)&&t!==null}function P(t){return t!=null}function Ee(t){return!t.trim().length}function Pe(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const gr="Extended search is not available",Jt="Incorrect 'index' type",Xt=t=>`Invalid value for key ${t}`,Zt=t=>`Pattern length exceeds max of ${t}.`,en=t=>`Missing ${t} property in key`,tn=t=>`Property 'weight' in key '${t}' must be a positive integer`,Be=Object.prototype.hasOwnProperty;class nn{constructor(e){this._keys=[],this._keyMap={};let r=0;e.forEach(s=>{let n=ze(s);r+=n.weight,this._keys.push(n),this._keyMap[n.id]=n,r+=n.weight}),this._keys.forEach(s=>{s.weight/=r})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function ze(t){let e=null,r=null,s=null,n=1;if(U(t)||z(t))s=t,e=Ue(t),r=Se(t);else{if(!Be.call(t,"name"))throw new Error(en("name"));const o=t.name;if(s=o,Be.call(t,"weight")&&(n=t.weight,n<=0))throw new Error(tn(o));e=Ue(o),r=Se(o)}return{path:e,id:r,weight:n,src:s}}function Ue(t){return z(t)?t:t.split(".")}function Se(t){return z(t)?t.join("."):t}function rn(t,e){let r=[],s=!1;const n=(o,u,i)=>{if(!!P(o))if(!u[i])r.push(o);else{let f=u[i];const a=o[f];if(!P(a))return;if(i===u.length-1&&(U(a)||$e(a)||qt(a)))r.push(Gt(a));else if(z(a)){s=!0;for(let h=0,y=a.length;h<y;h+=1)n(a[h],u,i+1)}else u.length&&n(a,u,i+1)}};return n(t,U(e)?e.split("."):e,0),s?r:r[0]}var b={...{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:rn,ignoreLocation:!1,ignoreFieldNorm:!1}};const sn=/[^ ]+/g;function an(t=3){const e=new Map,r=Math.pow(10,t);return{get(s){const n=s.match(sn).length;if(e.has(n))return e.get(n);const o=1/Math.sqrt(n),u=parseFloat(Math.round(o*r)/r);return e.set(n,u),u},clear(){e.clear()}}}class be{constructor({getFn:e=b.getFn}={}){this.norm=an(3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((r,s)=>{this._keysMap[r.id]=s})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,U(this.docs[0])?this.docs.forEach((e,r)=>{this._addString(e,r)}):this.docs.forEach((e,r)=>{this._addObject(e,r)}),this.norm.clear())}add(e){const r=this.size();U(e)?this._addString(e,r):this._addObject(e,r)}removeAt(e){this.records.splice(e,1);for(let r=e,s=this.size();r<s;r+=1)this.records[r].i-=1}getValueForItemAtKeyId(e,r){return e[this._keysMap[r]]}size(){return this.records.length}_addString(e,r){if(!P(e)||Ee(e))return;let s={v:e,i:r,n:this.norm.get(e)};this.records.push(s)}_addObject(e,r){let s={i:r,$:{}};this.keys.forEach((n,o)=>{let u=this.getFn(e,n.path);if(!!P(u)){if(z(u)){let i=[];const f=[{nestedArrIndex:-1,value:u}];for(;f.length;){const{nestedArrIndex:a,value:h}=f.pop();if(!!P(h))if(U(h)&&!Ee(h)){let y={v:h,i:a,n:this.norm.get(h)};i.push(y)}else z(h)&&h.forEach((y,E)=>{f.push({nestedArrIndex:E,value:y})})}s.$[o]=i}else if(!Ee(u)){let i={v:u,n:this.norm.get(u)};s.$[o]=i}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}}function je(t,e,{getFn:r=b.getFn}={}){const s=new be({getFn:r});return s.setKeys(t.map(ze)),s.setSources(e),s.create(),s}function on(t,{getFn:e=b.getFn}={}){const{keys:r,records:s}=t,n=new be({getFn:e});return n.setKeys(r),n.setIndexRecords(s),n}function ae(t,{errors:e=0,currentLocation:r=0,expectedLocation:s=0,distance:n=b.distance,ignoreLocation:o=b.ignoreLocation}={}){const u=e/t.length;if(o)return u;const i=Math.abs(s-r);return n?u+i/n:i?1:u}function cn(t=[],e=b.minMatchCharLength){let r=[],s=-1,n=-1,o=0;for(let u=t.length;o<u;o+=1){let i=t[o];i&&s===-1?s=o:!i&&s!==-1&&(n=o-1,n-s+1>=e&&r.push([s,n]),s=-1)}return t[o-1]&&o-s>=e&&r.push([s,o-1]),r}const q=32;function ln(t,e,r,{location:s=b.location,distance:n=b.distance,threshold:o=b.threshold,findAllMatches:u=b.findAllMatches,minMatchCharLength:i=b.minMatchCharLength,includeMatches:f=b.includeMatches,ignoreLocation:a=b.ignoreLocation}={}){if(e.length>q)throw new Error(Zt(q));const h=e.length,y=t.length,E=Math.max(0,Math.min(s,y));let M=o,C=E;const I=i>1||f,w=I?Array(y):[];let k;for(;(k=t.indexOf(e,C))>-1;){let m=ae(e,{currentLocation:k,expectedLocation:E,distance:n,ignoreLocation:a});if(M=Math.min(m,M),C=k+h,I){let x=0;for(;x<h;)w[k+x]=1,x+=1}}C=-1;let l=[],c=1,d=h+y;const g=1<<h-1;for(let m=0;m<h;m+=1){let x=0,S=d;for(;x<S;)ae(e,{errors:m,currentLocation:E+S,expectedLocation:E,distance:n,ignoreLocation:a})<=M?x=S:d=S,S=Math.floor((d-x)/2+x);d=S;let T=Math.max(1,E-S+1),A=u?y:Math.min(E+S,y)+h,D=Array(A+2);D[A+1]=(1<<m)-1;for(let F=A;F>=T;F-=1){let V=F-1,Q=r[t.charAt(V)];if(I&&(w[V]=+!!Q),D[F]=(D[F+1]<<1|1)&Q,m&&(D[F]|=(l[F+1]|l[F])<<1|1|l[F+1]),D[F]&g&&(c=ae(e,{errors:m,currentLocation:V,expectedLocation:E,distance:n,ignoreLocation:a}),c<=M)){if(M=c,C=V,C<=E)break;T=Math.max(1,2*E-C)}}if(ae(e,{errors:m+1,currentLocation:E,expectedLocation:E,distance:n,ignoreLocation:a})>M)break;l=D}const p={isMatch:C>=0,score:Math.max(.001,c)};if(I){const m=cn(w,i);m.length?f&&(p.indices=m):p.isMatch=!1}return p}function hn(t){let e={};for(let r=0,s=t.length;r<s;r+=1){const n=t.charAt(r);e[n]=(e[n]||0)|1<<s-r-1}return e}class He{constructor(e,{location:r=b.location,threshold:s=b.threshold,distance:n=b.distance,includeMatches:o=b.includeMatches,findAllMatches:u=b.findAllMatches,minMatchCharLength:i=b.minMatchCharLength,isCaseSensitive:f=b.isCaseSensitive,ignoreLocation:a=b.ignoreLocation}={}){if(this.options={location:r,threshold:s,distance:n,includeMatches:o,findAllMatches:u,minMatchCharLength:i,isCaseSensitive:f,ignoreLocation:a},this.pattern=f?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const h=(E,M)=>{this.chunks.push({pattern:E,alphabet:hn(E),startIndex:M})},y=this.pattern.length;if(y>q){let E=0;const M=y%q,C=y-M;for(;E<C;)h(this.pattern.substr(E,q),E),E+=q;if(M){const I=y-q;h(this.pattern.substr(I),I)}}else h(this.pattern,0)}searchIn(e){const{isCaseSensitive:r,includeMatches:s}=this.options;if(r||(e=e.toLowerCase()),this.pattern===e){let C={isMatch:!0,score:0};return s&&(C.indices=[[0,e.length-1]]),C}const{location:n,distance:o,threshold:u,findAllMatches:i,minMatchCharLength:f,ignoreLocation:a}=this.options;let h=[],y=0,E=!1;this.chunks.forEach(({pattern:C,alphabet:I,startIndex:w})=>{const{isMatch:k,score:l,indices:c}=ln(e,C,I,{location:n+w,distance:o,threshold:u,findAllMatches:i,minMatchCharLength:f,includeMatches:s,ignoreLocation:a});k&&(E=!0),y+=l,k&&c&&(h=[...h,...c])});let M={isMatch:E,score:E?y/this.chunks.length:1};return E&&s&&(M.indices=h),M}}class H{constructor(e){this.pattern=e}static isMultiMatch(e){return We(e,this.multiRegex)}static isSingleMatch(e){return We(e,this.singleRegex)}search(){}}function We(t,e){const r=t.match(e);return r?r[1]:null}class un extends H{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const r=e===this.pattern;return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class dn extends H{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const s=e.indexOf(this.pattern)===-1;return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class fn extends H{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const r=e.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class gn extends H{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const r=!e.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class pn extends H{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const r=e.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class yn extends H{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const r=!e.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class Ye extends H{constructor(e,{location:r=b.location,threshold:s=b.threshold,distance:n=b.distance,includeMatches:o=b.includeMatches,findAllMatches:u=b.findAllMatches,minMatchCharLength:i=b.minMatchCharLength,isCaseSensitive:f=b.isCaseSensitive,ignoreLocation:a=b.ignoreLocation}={}){super(e);this._bitapSearch=new He(e,{location:r,threshold:s,distance:n,includeMatches:o,findAllMatches:u,minMatchCharLength:i,isCaseSensitive:f,ignoreLocation:a})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Ve extends H{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let r=0,s;const n=[],o=this.pattern.length;for(;(s=e.indexOf(this.pattern,r))>-1;)r=s+o,n.push([s,r-1]);const u=!!n.length;return{isMatch:u,score:u?0:1,indices:n}}}const ke=[un,Ve,fn,gn,yn,pn,dn,Ye],Ge=ke.length,mn=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,_n="|";function vn(t,e={}){return t.split(_n).map(r=>{let s=r.trim().split(mn).filter(o=>o&&!!o.trim()),n=[];for(let o=0,u=s.length;o<u;o+=1){const i=s[o];let f=!1,a=-1;for(;!f&&++a<Ge;){const h=ke[a];let y=h.isMultiMatch(i);y&&(n.push(new h(y,e)),f=!0)}if(!f)for(a=-1;++a<Ge;){const h=ke[a];let y=h.isSingleMatch(i);if(y){n.push(new h(y,e));break}}}return n})}const En=new Set([Ye.type,Ve.type]);class Sn{constructor(e,{isCaseSensitive:r=b.isCaseSensitive,includeMatches:s=b.includeMatches,minMatchCharLength:n=b.minMatchCharLength,ignoreLocation:o=b.ignoreLocation,findAllMatches:u=b.findAllMatches,location:i=b.location,threshold:f=b.threshold,distance:a=b.distance}={}){this.query=null,this.options={isCaseSensitive:r,includeMatches:s,minMatchCharLength:n,findAllMatches:u,ignoreLocation:o,location:i,threshold:f,distance:a},this.pattern=r?e:e.toLowerCase(),this.query=vn(this.pattern,this.options)}static condition(e,r){return r.useExtendedSearch}searchIn(e){const r=this.query;if(!r)return{isMatch:!1,score:1};const{includeMatches:s,isCaseSensitive:n}=this.options;e=n?e:e.toLowerCase();let o=0,u=[],i=0;for(let f=0,a=r.length;f<a;f+=1){const h=r[f];u.length=0,o=0;for(let y=0,E=h.length;y<E;y+=1){const M=h[y],{isMatch:C,indices:I,score:w}=M.search(e);if(C){if(o+=1,i+=w,s){const k=M.constructor.type;En.has(k)?u=[...u,...I]:u.push(I)}}else{i=0,o=0,u.length=0;break}}if(o){let y={isMatch:!0,score:i/o};return s&&(y.indices=u),y}}return{isMatch:!1,score:1}}}const xe=[];function bn(...t){xe.push(...t)}function we(t,e){for(let r=0,s=xe.length;r<s;r+=1){let n=xe[r];if(n.condition(t,e))return new n(t,e)}return new He(t,e)}const ee={AND:"$and",OR:"$or"},Ce={PATH:"$path",PATTERN:"$val"},Me=t=>!!(t[ee.AND]||t[ee.OR]),kn=t=>!!t[Ce.PATH],xn=t=>!z(t)&&Ke(t)&&!Me(t),qe=t=>({[ee.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function Qe(t,e,{auto:r=!0}={}){const s=n=>{let o=Object.keys(n);const u=kn(n);if(!u&&o.length>1&&!Me(n))return s(qe(n));if(xn(n)){const f=u?n[Ce.PATH]:o[0],a=u?n[Ce.PATTERN]:n[f];if(!U(a))throw new Error(Xt(f));const h={keyId:Se(f),pattern:a};return r&&(h.searcher=we(a,e)),h}let i={children:[],operator:o[0]};return o.forEach(f=>{const a=n[f];z(a)&&a.forEach(h=>{i.children.push(s(h))})}),i};return Me(t)||(t=qe(t)),s(t)}function wn(t,{ignoreFieldNorm:e=b.ignoreFieldNorm}){t.forEach(r=>{let s=1;r.matches.forEach(({key:n,norm:o,score:u})=>{const i=n?n.weight:null;s*=Math.pow(u===0&&i?Number.EPSILON:u,(i||1)*(e?1:o))}),r.score=s})}function Cn(t,e){const r=t.matches;e.matches=[],!!P(r)&&r.forEach(s=>{if(!P(s.indices)||!s.indices.length)return;const{indices:n,value:o}=s;let u={indices:n,value:o};s.key&&(u.key=s.key.src),s.idx>-1&&(u.refIndex=s.idx),e.matches.push(u)})}function Mn(t,e){e.score=t.score}function Rn(t,e,{includeMatches:r=b.includeMatches,includeScore:s=b.includeScore}={}){const n=[];return r&&n.push(Cn),s&&n.push(Mn),t.map(o=>{const{idx:u}=o,i={item:e[u],refIndex:u};return n.length&&n.forEach(f=>{f(o,i)}),i})}class X{constructor(e,r={},s){this.options={...b,...r},this.options.useExtendedSearch,this._keyStore=new nn(this.options.keys),this.setCollection(e,s)}setCollection(e,r){if(this._docs=e,r&&!(r instanceof be))throw new Error(Jt);this._myIndex=r||je(this.options.keys,this._docs,{getFn:this.options.getFn})}add(e){!P(e)||(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const r=[];for(let s=0,n=this._docs.length;s<n;s+=1){const o=this._docs[s];e(o,s)&&(this.removeAt(s),s-=1,n-=1,r.push(o))}return r}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:r=-1}={}){const{includeMatches:s,includeScore:n,shouldSort:o,sortFn:u,ignoreFieldNorm:i}=this.options;let f=U(e)?U(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return wn(f,{ignoreFieldNorm:i}),o&&f.sort(u),$e(r)&&r>-1&&(f=f.slice(0,r)),Rn(f,this._docs,{includeMatches:s,includeScore:n})}_searchStringList(e){const r=we(e,this.options),{records:s}=this._myIndex,n=[];return s.forEach(({v:o,i:u,n:i})=>{if(!P(o))return;const{isMatch:f,score:a,indices:h}=r.searchIn(o);f&&n.push({item:o,idx:u,matches:[{score:a,value:o,norm:i,indices:h}]})}),n}_searchLogical(e){const r=Qe(e,this.options),s=(i,f,a)=>{if(!i.children){const{keyId:h,searcher:y}=i,E=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(f,h),searcher:y});return E&&E.length?[{idx:a,item:f,matches:E}]:[]}switch(i.operator){case ee.AND:{const h=[];for(let y=0,E=i.children.length;y<E;y+=1){const M=i.children[y],C=s(M,f,a);if(C.length)h.push(...C);else return[]}return h}case ee.OR:{const h=[];for(let y=0,E=i.children.length;y<E;y+=1){const M=i.children[y],C=s(M,f,a);if(C.length){h.push(...C);break}}return h}}},n=this._myIndex.records,o={},u=[];return n.forEach(({$:i,i:f})=>{if(P(i)){let a=s(r,i,f);a.length&&(o[f]||(o[f]={idx:f,item:i,matches:[]},u.push(o[f])),a.forEach(({matches:h})=>{o[f].matches.push(...h)}))}}),u}_searchObjectList(e){const r=we(e,this.options),{keys:s,records:n}=this._myIndex,o=[];return n.forEach(({$:u,i})=>{if(!P(u))return;let f=[];s.forEach((a,h)=>{f.push(...this._findMatches({key:a,value:u[h],searcher:r}))}),f.length&&o.push({idx:i,item:u,matches:f})}),o}_findMatches({key:e,value:r,searcher:s}){if(!P(r))return[];let n=[];if(z(r))r.forEach(({v:o,i:u,n:i})=>{if(!P(o))return;const{isMatch:f,score:a,indices:h}=s.searchIn(o);f&&n.push({score:a,key:e,value:o,idx:u,norm:i,indices:h})});else{const{v:o,n:u}=r,{isMatch:i,score:f,indices:a}=s.searchIn(o);i&&n.push({score:f,key:e,value:o,norm:u,indices:a})}return n}}X.version="6.4.6",X.createIndex=je,X.parseIndex=on,X.config=b,X.parseQuery=Qe,bn(Sn);const In={threshold:.5,useExtendedSearch:!0,keys:["name","author","description"]};var Je=(t,e)=>!e||e==""?t:new X(t,In).search(e).map(r=>r.item);const Xe=$.findByDisplayName("SearchBar");var Ze=({query:t,onChange:e})=>v.React.createElement(Xe,{className:"ysink_stain_searchbar",query:t,onQueryChange:e,placeholder:"Search themes...",size:Xe.Sizes.MEDIUM});const{SingleSelect:An}=$.findByDisplayName("Select",!1);var et=({filterMode:t,setFilterMode:e})=>v.React.createElement(An,{options:[{value:0,label:"Show All"},{value:1,label:"CC Only"},{value:2,label:"BD Only"}],value:t,onChange:e,isDisabled:!1,className:"ysink_stain_dropdown"});const{useState:tt,useReducer:Tn}=v.React;var Nn=()=>{se.useNest(N.persist);const[t,e]=tt("");let[r,s]=tt(0);const[,n]=Tn(o=>~o,0);return v.React.createElement(Z.ErrorBoundary,null,v.React.createElement(Wt,null),v.React.createElement("div",{className:"ysink_stain_search_row"},v.React.createElement(Ze,{query:t,onChange:e}),v.React.createElement(et,{filterMode:r,setFilterMode:s})),v.React.createElement("div",{className:"ysink_stain_cardcontainer"},Je(N.persist.ghost.themes,t).filter(o=>r===0||r===1&&!o.compat||r===2&&o.compat).map(o=>v.React.createElement(Fe,{theme:o,deleteHook:n}))))},ie=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},nt={};Object.defineProperty(nt,"__esModule",{value:!0});var W=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},On=function(){function t(e,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,r,s){return r&&t(e.prototype,r),s&&t(e,s),e}}(),Ln=yt.default,te=Dn(Ln);function Dn(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Fn(t,e){var r={};for(var s in t)e.indexOf(s)>=0||!Object.prototype.hasOwnProperty.call(t,s)||(r[s]=t[s]);return r}function $n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Kn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Pn=13,Bn=9,zn=8,Un=89,oe=90,jn=77,st=57,at=219,it=222,ot=192,Hn=27,ct=100,Wn=3e3,Yn="navigator"in ie&&/Win/i.test(navigator.platform),Re="navigator"in ie&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),ce="npm__react-simple-code-editor__textarea",Vn=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`+ce+`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`+ce+` {
    color: transparent !important;
  }

  .`+ce+`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`,lt=function(t){Kn(e,t);function e(){var r,s,n,o;$n(this,e);for(var u=arguments.length,i=Array(u),f=0;f<u;f++)i[f]=arguments[f];return o=(s=(n=rt(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(i))),n),n.state={capture:!0},n._recordCurrentState=function(){var a=n._input;if(!!a){var h=a.value,y=a.selectionStart,E=a.selectionEnd;n._recordChange({value:h,selectionStart:y,selectionEnd:E})}},n._getLines=function(a,h){return a.substring(0,h).split(`
`)},n._recordChange=function(a){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=n._history,E=y.stack,M=y.offset;if(E.length&&M>-1){n._history.stack=E.slice(0,M+1);var C=n._history.stack.length;if(C>ct){var I=C-ct;n._history.stack=E.slice(I,C),n._history.offset=Math.max(n._history.offset-I,0)}}var w=Date.now();if(h){var k=n._history.stack[n._history.offset];if(k&&w-k.timestamp<Wn){var l=/[^a-z0-9]([a-z0-9]+)$/i,c=n._getLines(k.value,k.selectionStart).pop().match(l),d=n._getLines(a.value,a.selectionStart).pop().match(l);if(c&&d&&d[1].startsWith(c[1])){n._history.stack[n._history.offset]=W({},a,{timestamp:w});return}}}n._history.stack.push(W({},a,{timestamp:w})),n._history.offset++},n._updateInput=function(a){var h=n._input;!h||(h.value=a.value,h.selectionStart=a.selectionStart,h.selectionEnd=a.selectionEnd,n.props.onValueChange(a.value))},n._applyEdits=function(a){var h=n._input,y=n._history.stack[n._history.offset];y&&h&&(n._history.stack[n._history.offset]=W({},y,{selectionStart:h.selectionStart,selectionEnd:h.selectionEnd})),n._recordChange(a),n._updateInput(a)},n._undoEdit=function(){var a=n._history,h=a.stack,y=a.offset,E=h[y-1];E&&(n._updateInput(E),n._history.offset=Math.max(y-1,0))},n._redoEdit=function(){var a=n._history,h=a.stack,y=a.offset,E=h[y+1];E&&(n._updateInput(E),n._history.offset=Math.min(y+1,h.length-1))},n._handleKeyDown=function(a){var h=n.props,y=h.tabSize,E=h.insertSpaces,M=h.ignoreTabKey,C=h.onKeyDown;if(!(C&&(C(a),a.defaultPrevented))){a.keyCode===Hn&&a.target.blur();var I=a.target,w=I.value,k=I.selectionStart,l=I.selectionEnd,c=(E?" ":"	").repeat(y);if(a.keyCode===Bn&&!M&&n.state.capture)if(a.preventDefault(),a.shiftKey){var d=n._getLines(w,k),g=d.length-1,p=n._getLines(w,l).length-1,m=w.split(`
`).map(function(L,J){return J>=g&&J<=p&&L.startsWith(c)?L.substring(c.length):L}).join(`
`);if(w!==m){var x=d[g];n._applyEdits({value:m,selectionStart:x.startsWith(c)?k-c.length:k,selectionEnd:l-(w.length-m.length)})}}else if(k!==l){var S=n._getLines(w,k),T=S.length-1,A=n._getLines(w,l).length-1,D=S[T];n._applyEdits({value:w.split(`
`).map(function(L,J){return J>=T&&J<=A?c+L:L}).join(`
`),selectionStart:/\S/.test(D)?k+c.length:k,selectionEnd:l+c.length*(A-T+1)})}else{var Y=k+c.length;n._applyEdits({value:w.substring(0,k)+c+w.substring(l),selectionStart:Y,selectionEnd:Y})}else if(a.keyCode===zn){var F=k!==l,V=w.substring(0,k);if(V.endsWith(c)&&!F){a.preventDefault();var Q=k-c.length;n._applyEdits({value:w.substring(0,k-c.length)+w.substring(l),selectionStart:Q,selectionEnd:Q})}}else if(a.keyCode===Pn){if(k===l){var he=n._getLines(w,k).pop(),O=he.match(/^\s+/);if(O&&O[0]){a.preventDefault();var B=`
`+O[0],j=k+B.length;n._applyEdits({value:w.substring(0,k)+B+w.substring(l),selectionStart:j,selectionEnd:j})}}}else if(a.keyCode===st||a.keyCode===at||a.keyCode===it||a.keyCode===ot){var K=void 0;a.keyCode===st&&a.shiftKey?K=["(",")"]:a.keyCode===at?a.shiftKey?K=["{","}"]:K=["[","]"]:a.keyCode===it?a.shiftKey?K=['"','"']:K=["'","'"]:a.keyCode===ot&&!a.shiftKey&&(K=["`","`"]),k!==l&&K&&(a.preventDefault(),n._applyEdits({value:w.substring(0,k)+K[0]+w.substring(k,l)+K[1]+w.substring(l),selectionStart:k,selectionEnd:l+2}))}else(Re?a.metaKey&&a.keyCode===oe:a.ctrlKey&&a.keyCode===oe)&&!a.shiftKey&&!a.altKey?(a.preventDefault(),n._undoEdit()):(Re?a.metaKey&&a.keyCode===oe&&a.shiftKey:Yn?a.ctrlKey&&a.keyCode===Un:a.ctrlKey&&a.keyCode===oe&&a.shiftKey)&&!a.altKey?(a.preventDefault(),n._redoEdit()):a.keyCode===jn&&a.ctrlKey&&(Re?a.shiftKey:!0)&&(a.preventDefault(),n.setState(function(L){return{capture:!L.capture}}))}},n._handleChange=function(a){var h=a.target,y=h.value,E=h.selectionStart,M=h.selectionEnd;n._recordChange({value:y,selectionStart:E,selectionEnd:M},!0),n.props.onValueChange(y)},n._history={stack:[],offset:-1},s),rt(n,o)}return On(e,[{key:"componentDidMount",value:function(){this._recordCurrentState()}},{key:"render",value:function(){var s=this,n=this.props,o=n.value,u=n.style,i=n.padding,f=n.highlight,a=n.textareaId,h=n.textareaClassName,y=n.autoFocus,E=n.disabled,M=n.form,C=n.maxLength,I=n.minLength,w=n.name,k=n.placeholder,l=n.readOnly,c=n.required,d=n.onClick,g=n.onFocus,p=n.onBlur,m=n.onKeyUp;n.onKeyDown,n.onValueChange,n.tabSize,n.insertSpaces,n.ignoreTabKey;var x=n.preClassName,S=Fn(n,["value","style","padding","highlight","textareaId","textareaClassName","autoFocus","disabled","form","maxLength","minLength","name","placeholder","readOnly","required","onClick","onFocus","onBlur","onKeyUp","onKeyDown","onValueChange","tabSize","insertSpaces","ignoreTabKey","preClassName"]),T={paddingTop:i,paddingRight:i,paddingBottom:i,paddingLeft:i},A=f(o);return te.createElement("div",W({},S,{style:W({},ne.container,u)}),te.createElement("textarea",{ref:function(Y){return s._input=Y},style:W({},ne.editor,ne.textarea,T),className:ce+(h?" "+h:""),id:a,value:o,onChange:this._handleChange,onKeyDown:this._handleKeyDown,onClick:d,onKeyUp:m,onFocus:g,onBlur:p,disabled:E,form:M,maxLength:C,minLength:I,name:w,placeholder:k,readOnly:l,required:c,autoFocus:y,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),te.createElement("pre",W({className:x,"aria-hidden":"true",style:W({},ne.editor,ne.highlight,T)},typeof A=="string"?{dangerouslySetInnerHTML:{__html:A+"<br />"}}:{children:A})),te.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:Vn}}))}},{key:"session",get:function(){return{history:this._history}},set:function(s){this._history=s.history}}]),e}(te.Component);lt.defaultProps={tabSize:2,insertSpaces:!0,ignoreTabKey:!1,padding:0};var Gn=nt.default=lt,ne={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}},Ie={exports:{}};(function(t){var e=typeof window!="undefined"?window:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=function(s){var n=/\blang(?:uage)?-([\w-]+)\b/i,o=0,u={},i={manual:s.Prism&&s.Prism.manual,disableWorkerMessageHandler:s.Prism&&s.Prism.disableWorkerMessageHandler,util:{encode:function l(c){return c instanceof f?new f(c.type,l(c.content),c.alias):Array.isArray(c)?c.map(l):c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(l){return Object.prototype.toString.call(l).slice(8,-1)},objId:function(l){return l.__id||Object.defineProperty(l,"__id",{value:++o}),l.__id},clone:function l(c,d){d=d||{};var g,p;switch(i.util.type(c)){case"Object":if(p=i.util.objId(c),d[p])return d[p];g={},d[p]=g;for(var m in c)c.hasOwnProperty(m)&&(g[m]=l(c[m],d));return g;case"Array":return p=i.util.objId(c),d[p]?d[p]:(g=[],d[p]=g,c.forEach(function(x,S){g[S]=l(x,d)}),g);default:return c}},getLanguage:function(l){for(;l&&!n.test(l.className);)l=l.parentElement;return l?(l.className.match(n)||[,"none"])[1].toLowerCase():"none"},currentScript:function(){if(typeof document=="undefined")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(g){var l=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(g.stack)||[])[1];if(l){var c=document.getElementsByTagName("script");for(var d in c)if(c[d].src==l)return c[d]}return null}},isActive:function(l,c,d){for(var g="no-"+c;l;){var p=l.classList;if(p.contains(c))return!0;if(p.contains(g))return!1;l=l.parentElement}return!!d}},languages:{plain:u,plaintext:u,text:u,txt:u,extend:function(l,c){var d=i.util.clone(i.languages[l]);for(var g in c)d[g]=c[g];return d},insertBefore:function(l,c,d,g){g=g||i.languages;var p=g[l],m={};for(var x in p)if(p.hasOwnProperty(x)){if(x==c)for(var S in d)d.hasOwnProperty(S)&&(m[S]=d[S]);d.hasOwnProperty(x)||(m[x]=p[x])}var T=g[l];return g[l]=m,i.languages.DFS(i.languages,function(A,D){D===T&&A!=l&&(this[A]=m)}),m},DFS:function l(c,d,g,p){p=p||{};var m=i.util.objId;for(var x in c)if(c.hasOwnProperty(x)){d.call(c,x,c[x],g||x);var S=c[x],T=i.util.type(S);T==="Object"&&!p[m(S)]?(p[m(S)]=!0,l(S,d,null,p)):T==="Array"&&!p[m(S)]&&(p[m(S)]=!0,l(S,d,x,p))}}},plugins:{},highlightAll:function(l,c){i.highlightAllUnder(document,l,c)},highlightAllUnder:function(l,c,d){var g={callback:d,container:l,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",g),g.elements=Array.prototype.slice.apply(g.container.querySelectorAll(g.selector)),i.hooks.run("before-all-elements-highlight",g);for(var p=0,m;m=g.elements[p++];)i.highlightElement(m,c===!0,g.callback)},highlightElement:function(l,c,d){var g=i.util.getLanguage(l),p=i.languages[g];l.className=l.className.replace(n,"").replace(/\s+/g," ")+" language-"+g;var m=l.parentElement;m&&m.nodeName.toLowerCase()==="pre"&&(m.className=m.className.replace(n,"").replace(/\s+/g," ")+" language-"+g);var x=l.textContent,S={element:l,language:g,grammar:p,code:x};function T(D){S.highlightedCode=D,i.hooks.run("before-insert",S),S.element.innerHTML=S.highlightedCode,i.hooks.run("after-highlight",S),i.hooks.run("complete",S),d&&d.call(S.element)}if(i.hooks.run("before-sanity-check",S),m=S.element.parentElement,m&&m.nodeName.toLowerCase()==="pre"&&!m.hasAttribute("tabindex")&&m.setAttribute("tabindex","0"),!S.code){i.hooks.run("complete",S),d&&d.call(S.element);return}if(i.hooks.run("before-highlight",S),!S.grammar){T(i.util.encode(S.code));return}if(c&&s.Worker){var A=new Worker(i.filename);A.onmessage=function(D){T(D.data)},A.postMessage(JSON.stringify({language:S.language,code:S.code,immediateClose:!0}))}else T(i.highlight(S.code,S.grammar,S.language))},highlight:function(l,c,d){var g={code:l,grammar:c,language:d};return i.hooks.run("before-tokenize",g),g.tokens=i.tokenize(g.code,g.grammar),i.hooks.run("after-tokenize",g),f.stringify(i.util.encode(g.tokens),g.language)},tokenize:function(l,c){var d=c.rest;if(d){for(var g in d)c[g]=d[g];delete c.rest}var p=new y;return E(p,p.head,l),h(l,p,c,p.head,0),C(p)},hooks:{all:{},add:function(l,c){var d=i.hooks.all;d[l]=d[l]||[],d[l].push(c)},run:function(l,c){var d=i.hooks.all[l];if(!(!d||!d.length))for(var g=0,p;p=d[g++];)p(c)}},Token:f};s.Prism=i;function f(l,c,d,g){this.type=l,this.content=c,this.alias=d,this.length=(g||"").length|0}f.stringify=function l(c,d){if(typeof c=="string")return c;if(Array.isArray(c)){var g="";return c.forEach(function(T){g+=l(T,d)}),g}var p={type:c.type,content:l(c.content,d),tag:"span",classes:["token",c.type],attributes:{},language:d},m=c.alias;m&&(Array.isArray(m)?Array.prototype.push.apply(p.classes,m):p.classes.push(m)),i.hooks.run("wrap",p);var x="";for(var S in p.attributes)x+=" "+S+'="'+(p.attributes[S]||"").replace(/"/g,"&quot;")+'"';return"<"+p.tag+' class="'+p.classes.join(" ")+'"'+x+">"+p.content+"</"+p.tag+">"};function a(l,c,d,g){l.lastIndex=c;var p=l.exec(d);if(p&&g&&p[1]){var m=p[1].length;p.index+=m,p[0]=p[0].slice(m)}return p}function h(l,c,d,g,p,m){for(var x in d)if(!(!d.hasOwnProperty(x)||!d[x])){var S=d[x];S=Array.isArray(S)?S:[S];for(var T=0;T<S.length;++T){if(m&&m.cause==x+","+T)return;var A=S[T],D=A.inside,Y=!!A.lookbehind,F=!!A.greedy,V=A.alias;if(F&&!A.pattern.global){var Q=A.pattern.toString().match(/[imsuy]*$/)[0];A.pattern=RegExp(A.pattern.source,Q+"g")}for(var he=A.pattern||A,O=g.next,B=p;O!==c.tail&&!(m&&B>=m.reach);B+=O.value.length,O=O.next){var j=O.value;if(c.length>l.length)return;if(!(j instanceof f)){var K=1,L;if(F){if(L=a(he,B,l,Y),!L)break;var ue=L.index,J=L.index+L[0].length,G=B;for(G+=O.value.length;ue>=G;)O=O.next,G+=O.value.length;if(G-=O.value.length,B=G,O.value instanceof f)continue;for(var re=O;re!==c.tail&&(G<J||typeof re.value=="string");re=re.next)K++,G+=re.value.length;K--,j=l.slice(B,G),L.index-=B}else if(L=a(he,0,j,Y),!L)continue;var ue=L.index,de=L[0],Ae=j.slice(0,ue),dt=j.slice(ue+de.length),Te=B+j.length;m&&Te>m.reach&&(m.reach=Te);var fe=O.prev;Ae&&(fe=E(c,fe,Ae),B+=Ae.length),M(c,fe,K);var fr=new f(x,D?i.tokenize(de,D):de,V,de);if(O=E(c,fe,fr),dt&&E(c,O,dt),K>1){var Ne={cause:x+","+T,reach:Te};h(l,c,d,O.prev,B,Ne),m&&Ne.reach>m.reach&&(m.reach=Ne.reach)}}}}}}function y(){var l={value:null,prev:null,next:null},c={value:null,prev:l,next:null};l.next=c,this.head=l,this.tail=c,this.length=0}function E(l,c,d){var g=c.next,p={value:d,prev:c,next:g};return c.next=p,g.prev=p,l.length++,p}function M(l,c,d){for(var g=c.next,p=0;p<d&&g!==l.tail;p++)g=g.next;c.next=g,g.prev=c,l.length-=p}function C(l){for(var c=[],d=l.head.next;d!==l.tail;)c.push(d.value),d=d.next;return c}if(!s.document)return s.addEventListener&&(i.disableWorkerMessageHandler||s.addEventListener("message",function(l){var c=JSON.parse(l.data),d=c.language,g=c.code,p=c.immediateClose;s.postMessage(i.highlight(g,i.languages[d],d)),p&&s.close()},!1)),i;var I=i.util.currentScript();I&&(i.filename=I.src,I.hasAttribute("data-manual")&&(i.manual=!0));function w(){i.manual||i.highlightAll()}if(!i.manual){var k=document.readyState;k==="loading"||k==="interactive"&&I&&I.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return i}(e);t.exports&&(t.exports=r),typeof ie!="undefined"&&(ie.Prism=r)})(Ie),function(t){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;t.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},t.languages.css.atrule.inside.rest=t.languages.css;var r=t.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))}(Prism);const{useState:qn,useCallback:Qn}=v.React;var Jn=()=>{const[t,e]=qn(N.persist.ghost.quickCSS),r=n=>{N.persist.store.quickCSS=n,N.reloadCSS()},s=Qn(_.throttle(r,250,{leading:!0,trailing:!0}),[]);return v.React.createElement(Z.ErrorBoundary,null,v.React.createElement("div",{class:"ysink_stain_quickcss"},v.React.createElement(Gn,{className:"ysink_stain_editorroot",value:t??"",onValueChange:n=>{e(n),s(n)},highlight:n=>Ie.exports.highlight(n,Ie.exports.languages.css),padding:10}),v.React.createElement("link",{href:"https://cdn.jsdelivr.net/gh/PrismJS/prism-themes@master/themes/prism-atom-dark.css",rel:"stylesheet"}),v.React.createElement("style",null,":root { --background-primary: 1d1f21; }")))};async function Xn(t){const e=new URL("repo.json",t).href,r=await(await fetch(e)).json();if(!r.themes||r.themes?.length===0)throw new Error("No themes found in repo");if(!r.meta)throw new Error("No repo metadata");if(!r?.meta.name)throw new Error("Repo did not have a name");return r}var ht=async t=>{const e=await Xn(t),r=await Promise.all(e.themes.map(s=>ve(s,t)));return{manifest:e,themes:r}};const{useState:le,useEffect:Zn,useReducer:er}=v.React,tr=()=>Promise.all(N.persist.ghost.repos.map(ht)),nr=t=>t.flatMap(e=>e.themes);async function rr(){let t=await tr();return{repos:t,themes:nr(t)}}var sr=()=>{se.useNest(N.persist,!1,(a,h)=>h?.[0]==="repos");const[t,e]=le("");let[r,s]=le(void 0),[n,o]=le(void 0),[u,i]=le(0);Zn(()=>{(!r||!n)&&rr().then(({repos:a,themes:h})=>{s(a),o(h)})});const[,f]=er(a=>~a,0);return v.React.createElement(Z.ErrorBoundary,null,v.React.createElement("div",{className:"ysink_stain_search_row"},v.React.createElement(Ze,{query:t,onChange:e}),v.React.createElement(et,{filterMode:u,setFilterMode:i})),v.React.createElement("div",{className:"ysink_stain_cardcontainer"},Je(n??[],t).filter(a=>u===0||u===1&&!a.compat||u===2&&a.compat).map(a=>v.React.createElement(Fe,{theme:a,deleteHook:f}))))};const ar=$.findByDisplayName("FormTitle"),ir=$.findByDisplayName("FormSection");var or=()=>v.React.createElement(Z.ErrorBoundary,null,v.React.createElement(ir,null,v.React.createElement(ar,{tag:"h1"},"Cumstain"),v.React.createElement(wt,{items:[{text:"Installed",component:Nn},{text:"Store",component:sr},{text:"Quick CSS",component:Jn}]}))),cr=()=>ge.after("getPredicateSections",$.findByDisplayName("SettingsView").prototype,(t,e)=>{if(e[1]?.section!="My Account")return;let r=e.findIndex(s=>s.section=="CUMCORD_PLUGINS")+1;return e.splice(r,0,{section:"ysink_stain_CUMSTAIN",label:"Themes",element:or}),e}),lr=()=>cumcord.patcher.injectCSS(".ysink_stain_tabbar{padding:.5rem 1rem;display:grid;grid-auto-flow:column;grid-auto-columns:7rem}.ysink_stain_tabbar .ysink_stain_button *{cursor:pointer}.ysink_stain_tabbar>*{margin-right:1rem;padding:.2rem;border-radius:.3rem;min-width:5rem;text-align:center;background:none}.theme-dark .ysink_stain_tabbar>*.ysink_stain_selected{background:#fff4}.theme-light .ysink_stain_tabbar>*.ysink_stain_selected{background:#0003}.ysink_stain_tabbar>*:last-child{margin-right:0}.ysink_stain_cardcontainer{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.ysink_stain_card{padding:1rem;border:1px solid var(--background-modifier-accent);border-radius:.5rem;display:flex;flex-direction:column;z-index:1;background-color:var(--deprecated-card-bg)}.ysink_stain_card .ysink_stain_title{font-size:1rem;padding-top:.2rem;display:inline;flex:1;margin:0}.ysink_stain_card .ysink_stain_button{display:inline;padding:0}.ysink_stain_card .ysink_stain_button>div{padding:2px 16px}.ysink_stain_card .ysink_stain_row{display:flex;margin-bottom:.5rem}.ysink_stain_card .ysink_stain_author_licence{font-style:italic}.ysink_stain_card .ysink_stain_desc{flex:1}.ysink_stain_card .ysink_stain_img{height:13rem;background-repeat:no-repeat;background-size:cover;background-position:center;margin:-1rem -1rem 1rem;border-radius:.5rem .5rem 0 0}.ysink_stain_card .ysink_stain_img div{font-size:1.5rem;text-align:center;padding-top:calc(6.5rem - .5em);text-transform:uppercase;opacity:.8}.ysink_stain_divide{margin:0 0 1rem}.ysink_stain_card .ysink_stain_divide{margin:.2rem 0}.ysink_stain_delete{margin-right:.5rem;fill:var(--interactive-normal)}.ysink_stain_installbar{display:flex}.ysink_stain_installbar>*{flex:1}.ysink_stain_installbar>:last-child{flex:unset;margin-left:1rem}.ysink_stain_searchbar{margin:.75rem 0}.ysink_stain_search_row{display:flex;gap:.75rem;margin:.75rem 0}.ysink_stain_search_row .ysink_stain_dropdown{height:2.25rem;flex-basis:10rem;padding-top:.3rem}.ysink_stain_search_row .ysink_stain_searchbar{margin:unset;flex:1}.ysink_stain_editorroot{background:tranparent;color:#c5c8c6;font-family:var(--font-code);font-size:.9rem;line-height:1.1rem}.ysink_stain_badge{width:1.5rem;height:1.5rem;margin-right:.5rem;border-radius:50%}.ysink_stain_badge.ysink_stain_bd{padding:.25rem;background:#040405}.ysink_stain_badge.ysink_stain_cc{padding:.1rem;background:#f8f8f8;background:#7289DA}"),hr=()=>{const t=ge.injectCSS(R.default.persist.ghost.quickCSS);return R.default.reloadCSS=()=>t(R.default.persist.ghost.quickCSS),()=>{t(),R.default.reloadCSS=void 0,delete R.default.reloadCSS}};const ut=async()=>{pe.log("|| CUMSTAIN || Started periodic theme update check");const e=(await Promise.all(N.persist.ghost.repos.map(ht))).flatMap(r=>r.themes);for(let r=0;r<N.persist.ghost.themes.length;r++){const s=N.persist.ghost.themes[r],n=e.find(o=>o.id===s.id);if(n)N.persist.ghost.themes[r]=n;else{const o=await ve(s.url).catch(()=>{});o&&(N.persist.ghost.themes[r]=o)}N.persist.store.themes[r].enabled=s.enabled,s.enabled&&N.state.ghost.unpatchCache.get(s.id)?.(N.persist.ghost.themes[r].CSS),pe.log(`|| CUMSTAIN || Updated theme ${N.persist.ghost.themes[r].name}`)}pe.log("|| CUMSTAIN || Completed periodic theme update check")};var ur=()=>{setTimeout(ut,10);const t=setInterval(ut,6e5);return()=>clearInterval(t)},dr=({persist:t})=>{let e=[];return{onLoad:async()=>{t.store.repos=["http://127.0.0.1:8080/"],e.push(lr(),Et(),vt(),hr(),cr(),ur())},onUnload:()=>e.reduceRight((r,s)=>s?.(),null)}};return dr})(cumcord.pluginData,cumcord.patcher,cumcord.modules.internal.nests,cumcord.modules.webpack,cumcord.ui.components,cumcord.modules.common,cumcord.utils,cumcord.ui.toasts,cumcord.modules.common.React,cumcord.utils.logger);
