(function(w,ne,bt,A,Ct,se,ee,ke,Mt,W,we){"use strict";function Se(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function At(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var N=Se(w),Nt=Se(bt),d=At(Ct),It=Se(Mt);const Tt=/[^\S\r\n]*?\r?\n[^\S\r\n]*?\*[^\S\r\n]?/,Dt=/^\\@/;function Lt(e){try{return JSON.parse(e)}catch{}}function Ot(e){const t=e.split(`
`)[0];if(t.includes("//META"))return Rt(e);if(t.includes("/**"))return $t(e);throw new Error("META was not found.")}function Rt(e){const t=e.split(`
`)[0],n=t.substring(t.lastIndexOf("//META")+6,t.lastIndexOf("*//")),r=Lt(n);if(!r)throw new Error("META could not be parsed.");if(!r.name)throw new Error("META missing name data.");return r}function $t(e){const t=e.split("/**",2)[1].split("*/",1)[0],n={};let r="",s="";for(const o of t.split(Tt))if(o.length!==0)if(o.charAt(0)==="@"&&o.charAt(1)!==" "){n[r]=s;const u=o.indexOf(" ");r=o.substr(1,u-1),s=o.substr(u+1)}else s+=" "+o.replace("\\n",`
`).replace(Dt,"@");return n[r]=s.trim(),delete n[""],n}async function Ft(e,t){const n=new URL(e,t).href;let r;const s=w.state.ghost.caches.css[n];if(s?.[0]===200)r=s[1];else{if(s)throw new Error(`BD theme existed in cache with non-200 status ${s[0]}`);{const o=await fetch(n);o.status!==200&&(w.state.ghost.caches.css[n]=[o.status,null]),r=await o.text(),w.state.ghost.caches.css[n]=[o.status,r]}}return{url:n,CSS:()=>Promise.resolve(r),compat:!0,repoUrl:t,...Ot(r)}}async function Bt(e,t){const n=new URL(e,t).href;let r=new URL(e,t).pathname.split("/");r.splice(r.length-1,1,"cumcord_theme.json");const s=new URL(r.join("/"),new URL(e,t).origin).href;let o;const u=w.state.ghost.caches.manifest[s];if(u?.[0]===200)o=u[1];else{if(u)throw new Error(`CC manifest existed in cache with non-200 status ${u[0]}`);{const a=await fetch(s);a.status!==200&&(w.state.ghost.caches.manifest[s]=[a.status,null]),o=await a.json(),w.state.ghost.caches.manifest[s]=[a.status,o]}}return{url:n,compat:!1,...o,repoUrl:t,CSS:async()=>{const a=w.state.ghost.caches.css[n];if(a?.[0]===200)return a[1];if(a)throw new Error(`CC CSS existed in cache with non-200 status ${a[0]}`);const g=await fetch(n);g.status!==200&&(w.state.ghost.caches.css[n]=[g.status,null]);const i=await g.text();return w.state.ghost.caches.css[n]=[g.status,i],i}}}var re=async(e,t)=>{try{return await Bt(e,t)}catch(n){try{return await Ft(e,t)}catch(r){let s=new Error("Failed to fetch theme - both CC and BD either failed to fetch or failed to parse");throw s.e1=n,s.e2=r,s}}};async function ue(e){if(!e?.url||!await e.CSS())throw new Error("theme was missing either id or css.");const t=ne.injectCSS(await e.CSS());N.default.state.ghost.unpatchCache.set(e.url,t);const n=N.default.persist.ghost.themes.findIndex(s=>s.url===e.url);let r={...e};delete r.CSS,r.enabled=!0,n===-1?N.default.persist.ghost.themes.push(r):N.default.persist.ghost.themes[n]=r,N.default.persist.store.themes=N.default.persist.ghost.themes}function xe(e){if(!e?.url)throw new Error("theme was missing id.");N.default.state.ghost.unpatchCache.get(e.url)?.(),N.default.state.ghost.unpatchCache.delete(e.url);const t=N.default.persist.ghost.themes.findIndex(r=>r.url===e.url);let n={...e};n.enabled=!1,t===-1?N.default.persist.ghost.themes.push(n):N.default.persist.ghost.themes[t]=n,N.default.persist.store.themes=N.default.persist.ghost.themes}function Ke(e){try{xe(e)}catch(t){if(t.message!=="theme was not loaded.")throw t}N.default.persist.store.themes=N.default.persist.ghost.themes.filter(t=>t.url!==e.url)}async function Pt(e){N.default.state.ghost.unpatchCache.get(e.url)?.(await e.CSS());let t={...e};t.enabled=!0;const n=N.default.persist.ghost.themes.findIndex(r=>r.url===e.url);n!==-1&&(N.default.persist.ghost.themes[n]=t,N.default.persist.store.themes=N.default.persist.ghost.themes)}function zt(){N.default.state.ghost.unpatchCache.forEach(e=>e?.()),N.default.state.ghost.unpatchCache.clear()}var Kt=()=>(w.persist.ghost.themes&&w.persist.ghost.themes.filter(e=>e.enabled).forEach(async e=>ue(await re(e.url,e.repoUrl))),zt);async function jt(e){if(w.state.ghost.caches.repo[e])return w.state.ghost.caches.repo[e];const t=new URL("repo.json",e).href,n=await(await fetch(t)).json();if(!n.themes||n.themes?.length===0)throw new Error("No themes found in repo");if(!n.meta)throw new Error("No repo metadata");if(!n?.meta.name)throw new Error("Repo did not have a name");return w.state.ghost.caches.repo[e]=n,n}var he=async e=>{const t=await jt(e),n=await Promise.all(t.themes.map(r=>re(r,e)));return{manifest:t,themes:n}};const je=["https://cumcordthemes.github.io/Cumsock/"],Ut=je;var Wt=async()=>{Array.isArray(w.persist.ghost.repos)||(w.persist.ghost.repos=[]);for(const e of je)if(!w.persist.ghost.repos.find(t=>t.url===e.url)){try{await he(e)}catch{continue}w.persist.ghost.repos.push(e)}w.persist.set({path:["repos"],value:w.persist.ghost.repos})},Ht=()=>(N.default.state=Nt.default.make({unpatchCache:new Map,caches:{css:{},repo:{},manifest:{}}}),Array.isArray(N.default.persist.ghost.repos)||Wt(),Array.isArray(N.default.persist.ghost.themes)||(N.default.persist.store.themes=[]),()=>{delete N.default.state});const Ue=(e,t)=>()=>d.createElement("img",{src:e,className:`ysink_stain_badge ysink_stain_${t}`}),Yt=Ue("https://betterdiscord.app/resources/branding/logo_small.svg","bd"),Gt=Ue("https://raw.githubusercontent.com/Cumcord/assets/main/logo/filled.svg","cc");var Vt=({theme:e,onClick:t})=>d.createElement("svg",{onClick:t,className:"ysink_stain_delete",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px"},d.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),d.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),d.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}));const qt=A.findByDisplayName("FormText"),We=A.findByDisplayName("SmallMediaCarousel");var Qt=({media:e})=>d.createElement("div",{class:"ysink_stain_carousel"},e?d.createElement(We,{items:(typeof e=="string"?[e]:e).map(t=>({type:1,src:t})),autoplayInterval:5e3}):d.createElement("div",{className:"ysink_stain_noimg"},d.createElement(qt,{className:"ysink_stain_noimgtxt"},"No Image"),d.createElement(We,{items:[{type:1,src:""}]})));const Jt=A.findByDisplayName("FormTitle"),He=A.findByDisplayName("FormText");A.findByDisplayName("FormSection");const Xt=A.findByDisplayName("FormDivider"),Zt=A.findByDisplayName("Switch"),Ye=e=>{for(const t of w.persist.ghost.themes)if(t.url===e&&t.enabled)return!0;return!1},en=e=>w.persist.ghost.themes.some(t=>t.url===e);var Ge=({theme:e,deleteHook:t})=>(se.useNest(w.persist),d.createElement("div",{className:"ysink_stain_card"},d.createElement(Qt,{media:e.media}),d.createElement("div",{className:"ysink_stain_card_row"},e.compat?d.createElement(Yt,null):d.createElement(Gt,null),d.createElement(Jt,{tag:"p",className:"ysink_stain_title"},e.name),en(e.url)?d.createElement(Vt,{theme:e,onClick:()=>{Ke(e),t?.()}}):[],d.createElement(Zt,{checked:Ye(e.url),onChange:async()=>Ye(e.url)?xe(e):ue(await re(e.url))})),d.createElement(He,{className:"ysink_stain_desc"},e.description),d.createElement(Xt,{className:"ysink_stain_divide"}),d.createElement(He,{className:"ysink_stain_author_licence"},e.author?`by ${e.author} `:"",e.license?`under ${e.license}`:"")));const{useState:tn}=d,nn=A.findByProps("Sizes","Colors","Looks","DropdownSizes"),sn=A.findByDisplayName("TextInput");var rn=()=>{se.useNest(w.persist);let[e,t]=tn("");return d.createElement(ee.ErrorBoundary,null,d.createElement("div",{className:"ysink_stain_installbar"},d.createElement(sn,{className:"ysink_stain_input",placeholder:"Theme import URL",type:"text",value:e,onChange:n=>t(n)}),d.createElement(nn,{className:"ysink_stain_button",onClick:()=>{re(e).then(async n=>{await ue(n),ke.showToast({title:`Loaded theme ${n.name}`,duration:5e3})},()=>ke.showToast({title:"Failed to fetch theme - check URL",duration:5e3})),t("")}},"Install")))};function K(e){return Array.isArray?Array.isArray(e):Qe(e)==="[object Array]"}const an=1/0;function on(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-an?"-0":t}function ln(e){return e==null?"":on(e)}function j(e){return typeof e=="string"}function Ve(e){return typeof e=="number"}function cn(e){return e===!0||e===!1||un(e)&&Qe(e)=="[object Boolean]"}function qe(e){return typeof e=="object"}function un(e){return qe(e)&&e!==null}function P(e){return e!=null}function be(e){return!e.trim().length}function Qe(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const rr="Extended search is not available",hn="Incorrect 'index' type",dn=e=>`Invalid value for key ${e}`,fn=e=>`Pattern length exceeds max of ${e}.`,gn=e=>`Missing ${e} property in key`,mn=e=>`Property 'weight' in key '${e}' must be a positive integer`,Je=Object.prototype.hasOwnProperty;class pn{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(r=>{let s=Xe(r);n+=s.weight,this._keys.push(s),this._keyMap[s.id]=s,n+=s.weight}),this._keys.forEach(r=>{r.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Xe(e){let t=null,n=null,r=null,s=1;if(j(e)||K(e))r=e,t=Ze(e),n=Ce(e);else{if(!Je.call(e,"name"))throw new Error(gn("name"));const o=e.name;if(r=o,Je.call(e,"weight")&&(s=e.weight,s<=0))throw new Error(mn(o));t=Ze(o),n=Ce(o)}return{path:t,id:n,weight:s,src:r}}function Ze(e){return K(e)?e:e.split(".")}function Ce(e){return K(e)?e.join("."):e}function yn(e,t){let n=[],r=!1;const s=(o,u,a)=>{if(!!P(o))if(!u[a])n.push(o);else{let g=u[a];const i=o[g];if(!P(i))return;if(a===u.length-1&&(j(i)||Ve(i)||cn(i)))n.push(ln(i));else if(K(i)){r=!0;for(let h=0,v=i.length;h<v;h+=1)s(i[h],u,a+1)}else u.length&&s(i,u,a+1)}};return s(e,j(t)?t.split("."):t,0),r?n:n[0]}var S={...{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:yn,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const _n=/[^ ]+/g;function vn(e=1,t=3){const n=new Map,r=Math.pow(10,t);return{get(s){const o=s.match(_n).length;if(n.has(o))return n.get(o);const u=1/Math.pow(o,.5*e),a=parseFloat(Math.round(u*r)/r);return n.set(o,a),a},clear(){n.clear()}}}class Me{constructor({getFn:t=S.getFn,fieldNormWeight:n=S.fieldNormWeight}={}){this.norm=vn(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,j(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){const n=this.size();j(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!P(t)||be(t))return;let r={v:t,i:n,n:this.norm.get(t)};this.records.push(r)}_addObject(t,n){let r={i:n,$:{}};this.keys.forEach((s,o)=>{let u=this.getFn(t,s.path);if(!!P(u)){if(K(u)){let a=[];const g=[{nestedArrIndex:-1,value:u}];for(;g.length;){const{nestedArrIndex:i,value:h}=g.pop();if(!!P(h))if(j(h)&&!be(h)){let v={v:h,i,n:this.norm.get(h)};a.push(v)}else K(h)&&h.forEach((v,y)=>{g.push({nestedArrIndex:y,value:v})})}r.$[o]=a}else if(!be(u)){let a={v:u,n:this.norm.get(u)};r.$[o]=a}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function et(e,t,{getFn:n=S.getFn,fieldNormWeight:r=S.fieldNormWeight}={}){const s=new Me({getFn:n,fieldNormWeight:r});return s.setKeys(e.map(Xe)),s.setSources(t),s.create(),s}function En(e,{getFn:t=S.getFn,fieldNormWeight:n=S.fieldNormWeight}={}){const{keys:r,records:s}=e,o=new Me({getFn:t,fieldNormWeight:n});return o.setKeys(r),o.setIndexRecords(s),o}function de(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:s=S.distance,ignoreLocation:o=S.ignoreLocation}={}){const u=t/e.length;if(o)return u;const a=Math.abs(r-n);return s?u+a/s:a?1:u}function kn(e=[],t=S.minMatchCharLength){let n=[],r=-1,s=-1,o=0;for(let u=e.length;o<u;o+=1){let a=e[o];a&&r===-1?r=o:!a&&r!==-1&&(s=o-1,s-r+1>=t&&n.push([r,s]),r=-1)}return e[o-1]&&o-r>=t&&n.push([r,o-1]),n}const Q=32;function wn(e,t,n,{location:r=S.location,distance:s=S.distance,threshold:o=S.threshold,findAllMatches:u=S.findAllMatches,minMatchCharLength:a=S.minMatchCharLength,includeMatches:g=S.includeMatches,ignoreLocation:i=S.ignoreLocation}={}){if(t.length>Q)throw new Error(fn(Q));const h=t.length,v=e.length,y=Math.max(0,Math.min(r,v));let M=o,I=y;const T=a>1||g,C=T?Array(v):[];let x;for(;(x=e.indexOf(t,I))>-1;){let E=de(t,{currentLocation:x,expectedLocation:y,distance:s,ignoreLocation:i});if(M=Math.min(E,M),I=x+h,T){let b=0;for(;b<h;)C[x+b]=1,b+=1}}I=-1;let c=[],l=1,f=h+v;const m=1<<h-1;for(let E=0;E<h;E+=1){let b=0,k=f;for(;b<k;)de(t,{errors:E,currentLocation:y+k,expectedLocation:y,distance:s,ignoreLocation:i})<=M?b=k:f=k,k=Math.floor((f-b)/2+b);f=k;let L=Math.max(1,y-k+1),D=u?v:Math.min(y+k,v)+h,$=Array(D+2);$[D+1]=(1<<E)-1;for(let F=D;F>=L;F-=1){let V=F-1,X=n[e.charAt(V)];if(T&&(C[V]=+!!X),$[F]=($[F+1]<<1|1)&X,E&&($[F]|=(c[F+1]|c[F])<<1|1|c[F+1]),$[F]&m&&(l=de(t,{errors:E,currentLocation:V,expectedLocation:y,distance:s,ignoreLocation:i}),l<=M)){if(M=l,I=V,I<=y)break;L=Math.max(1,2*y-I)}}if(de(t,{errors:E+1,currentLocation:y,expectedLocation:y,distance:s,ignoreLocation:i})>M)break;c=$}const p={isMatch:I>=0,score:Math.max(.001,l)};if(T){const E=kn(C,a);E.length?g&&(p.indices=E):p.isMatch=!1}return p}function Sn(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const s=e.charAt(n);t[s]=(t[s]||0)|1<<r-n-1}return t}class tt{constructor(t,{location:n=S.location,threshold:r=S.threshold,distance:s=S.distance,includeMatches:o=S.includeMatches,findAllMatches:u=S.findAllMatches,minMatchCharLength:a=S.minMatchCharLength,isCaseSensitive:g=S.isCaseSensitive,ignoreLocation:i=S.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:s,includeMatches:o,findAllMatches:u,minMatchCharLength:a,isCaseSensitive:g,ignoreLocation:i},this.pattern=g?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const h=(y,M)=>{this.chunks.push({pattern:y,alphabet:Sn(y),startIndex:M})},v=this.pattern.length;if(v>Q){let y=0;const M=v%Q,I=v-M;for(;y<I;)h(this.pattern.substr(y,Q),y),y+=Q;if(M){const T=v-Q;h(this.pattern.substr(T),T)}}else h(this.pattern,0)}searchIn(t){const{isCaseSensitive:n,includeMatches:r}=this.options;if(n||(t=t.toLowerCase()),this.pattern===t){let I={isMatch:!0,score:0};return r&&(I.indices=[[0,t.length-1]]),I}const{location:s,distance:o,threshold:u,findAllMatches:a,minMatchCharLength:g,ignoreLocation:i}=this.options;let h=[],v=0,y=!1;this.chunks.forEach(({pattern:I,alphabet:T,startIndex:C})=>{const{isMatch:x,score:c,indices:l}=wn(t,I,T,{location:s+C,distance:o,threshold:u,findAllMatches:a,minMatchCharLength:g,includeMatches:r,ignoreLocation:i});x&&(y=!0),v+=c,x&&l&&(h=[...h,...l])});let M={isMatch:y,score:y?v/this.chunks.length:1};return y&&r&&(M.indices=h),M}}class H{constructor(t){this.pattern=t}static isMultiMatch(t){return nt(t,this.multiRegex)}static isSingleMatch(t){return nt(t,this.singleRegex)}search(){}}function nt(e,t){const n=e.match(t);return n?n[1]:null}class xn extends H{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class bn extends H{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const r=t.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class Cn extends H{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class Mn extends H{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class An extends H{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class Nn extends H{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class st extends H{constructor(t,{location:n=S.location,threshold:r=S.threshold,distance:s=S.distance,includeMatches:o=S.includeMatches,findAllMatches:u=S.findAllMatches,minMatchCharLength:a=S.minMatchCharLength,isCaseSensitive:g=S.isCaseSensitive,ignoreLocation:i=S.ignoreLocation}={}){super(t);this._bitapSearch=new tt(t,{location:n,threshold:r,distance:s,includeMatches:o,findAllMatches:u,minMatchCharLength:a,isCaseSensitive:g,ignoreLocation:i})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class rt extends H{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n=0,r;const s=[],o=this.pattern.length;for(;(r=t.indexOf(this.pattern,n))>-1;)n=r+o,s.push([r,n-1]);const u=!!s.length;return{isMatch:u,score:u?0:1,indices:s}}}const Ae=[xn,rt,Cn,Mn,Nn,An,bn,st],it=Ae.length,In=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,Tn="|";function Dn(e,t={}){return e.split(Tn).map(n=>{let r=n.trim().split(In).filter(o=>o&&!!o.trim()),s=[];for(let o=0,u=r.length;o<u;o+=1){const a=r[o];let g=!1,i=-1;for(;!g&&++i<it;){const h=Ae[i];let v=h.isMultiMatch(a);v&&(s.push(new h(v,t)),g=!0)}if(!g)for(i=-1;++i<it;){const h=Ae[i];let v=h.isSingleMatch(a);if(v){s.push(new h(v,t));break}}}return s})}const Ln=new Set([st.type,rt.type]);class On{constructor(t,{isCaseSensitive:n=S.isCaseSensitive,includeMatches:r=S.includeMatches,minMatchCharLength:s=S.minMatchCharLength,ignoreLocation:o=S.ignoreLocation,findAllMatches:u=S.findAllMatches,location:a=S.location,threshold:g=S.threshold,distance:i=S.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:s,findAllMatches:u,ignoreLocation:o,location:a,threshold:g,distance:i},this.pattern=n?t:t.toLowerCase(),this.query=Dn(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:s}=this.options;t=s?t:t.toLowerCase();let o=0,u=[],a=0;for(let g=0,i=n.length;g<i;g+=1){const h=n[g];u.length=0,o=0;for(let v=0,y=h.length;v<y;v+=1){const M=h[v],{isMatch:I,indices:T,score:C}=M.search(t);if(I){if(o+=1,a+=C,r){const x=M.constructor.type;Ln.has(x)?u=[...u,...T]:u.push(T)}}else{a=0,o=0,u.length=0;break}}if(o){let v={isMatch:!0,score:a/o};return r&&(v.indices=u),v}}return{isMatch:!1,score:1}}}const Ne=[];function Rn(...e){Ne.push(...e)}function Ie(e,t){for(let n=0,r=Ne.length;n<r;n+=1){let s=Ne[n];if(s.condition(e,t))return new s(e,t)}return new tt(e,t)}const fe={AND:"$and",OR:"$or"},Te={PATH:"$path",PATTERN:"$val"},De=e=>!!(e[fe.AND]||e[fe.OR]),$n=e=>!!e[Te.PATH],Fn=e=>!K(e)&&qe(e)&&!De(e),at=e=>({[fe.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function ot(e,t,{auto:n=!0}={}){const r=s=>{let o=Object.keys(s);const u=$n(s);if(!u&&o.length>1&&!De(s))return r(at(s));if(Fn(s)){const g=u?s[Te.PATH]:o[0],i=u?s[Te.PATTERN]:s[g];if(!j(i))throw new Error(dn(g));const h={keyId:Ce(g),pattern:i};return n&&(h.searcher=Ie(i,t)),h}let a={children:[],operator:o[0]};return o.forEach(g=>{const i=s[g];K(i)&&i.forEach(h=>{a.children.push(r(h))})}),a};return De(e)||(e=at(e)),r(e)}function Bn(e,{ignoreFieldNorm:t=S.ignoreFieldNorm}){e.forEach(n=>{let r=1;n.matches.forEach(({key:s,norm:o,score:u})=>{const a=s?s.weight:null;r*=Math.pow(u===0&&a?Number.EPSILON:u,(a||1)*(t?1:o))}),n.score=r})}function Pn(e,t){const n=e.matches;t.matches=[],!!P(n)&&n.forEach(r=>{if(!P(r.indices)||!r.indices.length)return;const{indices:s,value:o}=r;let u={indices:s,value:o};r.key&&(u.key=r.key.src),r.idx>-1&&(u.refIndex=r.idx),t.matches.push(u)})}function zn(e,t){t.score=e.score}function Kn(e,t,{includeMatches:n=S.includeMatches,includeScore:r=S.includeScore}={}){const s=[];return n&&s.push(Pn),r&&s.push(zn),e.map(o=>{const{idx:u}=o,a={item:t[u],refIndex:u};return s.length&&s.forEach(g=>{g(o,a)}),a})}class te{constructor(t,n={},r){this.options={...S,...n},this.options.useExtendedSearch,this._keyStore=new pn(this.options.keys),this.setCollection(t,r)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof Me))throw new Error(hn);this._myIndex=n||et(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){!P(t)||(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const n=[];for(let r=0,s=this._docs.length;r<s;r+=1){const o=this._docs[r];t(o,r)&&(this.removeAt(r),r-=1,s-=1,n.push(o))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){const{includeMatches:r,includeScore:s,shouldSort:o,sortFn:u,ignoreFieldNorm:a}=this.options;let g=j(t)?j(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return Bn(g,{ignoreFieldNorm:a}),o&&g.sort(u),Ve(n)&&n>-1&&(g=g.slice(0,n)),Kn(g,this._docs,{includeMatches:r,includeScore:s})}_searchStringList(t){const n=Ie(t,this.options),{records:r}=this._myIndex,s=[];return r.forEach(({v:o,i:u,n:a})=>{if(!P(o))return;const{isMatch:g,score:i,indices:h}=n.searchIn(o);g&&s.push({item:o,idx:u,matches:[{score:i,value:o,norm:a,indices:h}]})}),s}_searchLogical(t){const n=ot(t,this.options),r=(a,g,i)=>{if(!a.children){const{keyId:v,searcher:y}=a,M=this._findMatches({key:this._keyStore.get(v),value:this._myIndex.getValueForItemAtKeyId(g,v),searcher:y});return M&&M.length?[{idx:i,item:g,matches:M}]:[]}const h=[];for(let v=0,y=a.children.length;v<y;v+=1){const M=a.children[v],I=r(M,g,i);if(I.length)h.push(...I);else if(a.operator===fe.AND)return[]}return h},s=this._myIndex.records,o={},u=[];return s.forEach(({$:a,i:g})=>{if(P(a)){let i=r(n,a,g);i.length&&(o[g]||(o[g]={idx:g,item:a,matches:[]},u.push(o[g])),i.forEach(({matches:h})=>{o[g].matches.push(...h)}))}}),u}_searchObjectList(t){const n=Ie(t,this.options),{keys:r,records:s}=this._myIndex,o=[];return s.forEach(({$:u,i:a})=>{if(!P(u))return;let g=[];r.forEach((i,h)=>{g.push(...this._findMatches({key:i,value:u[h],searcher:n}))}),g.length&&o.push({idx:a,item:u,matches:g})}),o}_findMatches({key:t,value:n,searcher:r}){if(!P(n))return[];let s=[];if(K(n))n.forEach(({v:o,i:u,n:a})=>{if(!P(o))return;const{isMatch:g,score:i,indices:h}=r.searchIn(o);g&&s.push({score:i,key:t,value:o,idx:u,norm:a,indices:h})});else{const{v:o,n:u}=n,{isMatch:a,score:g,indices:i}=r.searchIn(o);a&&s.push({score:g,key:t,value:o,norm:u,indices:i})}return s}}te.version="6.5.3",te.createIndex=et,te.parseIndex=En,te.config=S,te.parseQuery=ot,Rn(On);const jn={threshold:.5,useExtendedSearch:!0,keys:["name","author","description"]};var lt=(e,t)=>!t||t==""?e:new te(e,jn).search(t).map(n=>n.item);const ct=A.findByDisplayName("SearchBar");var ut=({query:e,onChange:t})=>d.createElement(ct,{className:"ysink_stain_searchbar",query:e,onQueryChange:t,placeholder:"Search themes...",size:ct.Sizes.MEDIUM});const{SingleSelect:Un}=A.findByDisplayName("Select",!1);var ht=({filterMode:e,setFilterMode:t})=>d.createElement(Un,{options:[{value:0,label:"Show All"},{value:1,label:"CC Only"},{value:2,label:"BD Only"}],value:e,onChange:t,isDisabled:!1,className:"ysink_stain_dropdown"});const Wn=A.findByDisplayName("FormTitle"),Hn=A.findByDisplayName("FormText"),Yn=A.findByDisplayName("FormSection"),Le=A.findByProps("Sizes","Colors","Looks","DropdownSizes");var Gn=({goToStore:e})=>d.createElement(Yn,{className:"ysink_stain_nosplash"},d.createElement(Wn,{tag:"h2"},"No Themes"),d.createElement(Hn,null,"Paste a link in above, or head over to the store"),d.createElement(Le,{className:"ysink_stain_button",color:Le.Colors.GREEN,sizes:Le.Sizes.LARGE,onClick:e},"Get some themes"));const{useState:dt,useReducer:Vn}=d;var qn=({goTo:e})=>{se.useNest(w.persist);const[t,n]=dt("");let[r,s]=dt(0);const[,o]=Vn(u=>~u,0);return d.createElement(ee.ErrorBoundary,null,d.createElement(rn,null),d.createElement("div",{className:"ysink_stain_search_row"},d.createElement(ut,{query:t,onChange:n}),d.createElement(ht,{filterMode:r,setFilterMode:s})),w.persist.ghost.themes.length===0?d.createElement(Gn,{goToStore:()=>e(1)}):d.createElement("div",{className:"ysink_stain_cardcontainer"},lt(w.persist.ghost.themes,t).filter(u=>r===0||r===1&&!u.compat||r===2&&u.compat).map(u=>d.createElement(Ge,{theme:u,deleteHook:o}))))},ge=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},ft={};Object.defineProperty(ft,"__esModule",{value:!0});var Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qn=function(){function e(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Jn=It.default,ie=Xn(Jn);function Xn(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function Zn(e,t){var n={};for(var r in e)t.indexOf(r)>=0||!Object.prototype.hasOwnProperty.call(e,r)||(n[r]=e[r]);return n}function es(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function ts(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ns=13,ss=9,rs=8,is=89,me=90,as=77,mt=57,pt=219,yt=222,_t=192,os=27,vt=100,ls=3e3,cs="navigator"in ge&&/Win/i.test(navigator.platform),Oe="navigator"in ge&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),pe="npm__react-simple-code-editor__textarea",us=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`+pe+`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`+pe+` {
    color: transparent !important;
  }

  .`+pe+`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`,Et=function(e){ts(t,e);function t(){var n,r,s,o;es(this,t);for(var u=arguments.length,a=Array(u),g=0;g<u;g++)a[g]=arguments[g];return o=(r=(s=gt(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(a))),s),s.state={capture:!0},s._recordCurrentState=function(){var i=s._input;if(!!i){var h=i.value,v=i.selectionStart,y=i.selectionEnd;s._recordChange({value:h,selectionStart:v,selectionEnd:y})}},s._getLines=function(i,h){return i.substring(0,h).split(`
`)},s._recordChange=function(i){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=s._history,y=v.stack,M=v.offset;if(y.length&&M>-1){s._history.stack=y.slice(0,M+1);var I=s._history.stack.length;if(I>vt){var T=I-vt;s._history.stack=y.slice(T,I),s._history.offset=Math.max(s._history.offset-T,0)}}var C=Date.now();if(h){var x=s._history.stack[s._history.offset];if(x&&C-x.timestamp<ls){var c=/[^a-z0-9]([a-z0-9]+)$/i,l=s._getLines(x.value,x.selectionStart).pop().match(c),f=s._getLines(i.value,i.selectionStart).pop().match(c);if(l&&f&&f[1].startsWith(l[1])){s._history.stack[s._history.offset]=Y({},i,{timestamp:C});return}}}s._history.stack.push(Y({},i,{timestamp:C})),s._history.offset++},s._updateInput=function(i){var h=s._input;!h||(h.value=i.value,h.selectionStart=i.selectionStart,h.selectionEnd=i.selectionEnd,s.props.onValueChange(i.value))},s._applyEdits=function(i){var h=s._input,v=s._history.stack[s._history.offset];v&&h&&(s._history.stack[s._history.offset]=Y({},v,{selectionStart:h.selectionStart,selectionEnd:h.selectionEnd})),s._recordChange(i),s._updateInput(i)},s._undoEdit=function(){var i=s._history,h=i.stack,v=i.offset,y=h[v-1];y&&(s._updateInput(y),s._history.offset=Math.max(v-1,0))},s._redoEdit=function(){var i=s._history,h=i.stack,v=i.offset,y=h[v+1];y&&(s._updateInput(y),s._history.offset=Math.min(v+1,h.length-1))},s._handleKeyDown=function(i){var h=s.props,v=h.tabSize,y=h.insertSpaces,M=h.ignoreTabKey,I=h.onKeyDown;if(!(I&&(I(i),i.defaultPrevented))){i.keyCode===os&&i.target.blur();var T=i.target,C=T.value,x=T.selectionStart,c=T.selectionEnd,l=(y?" ":"	").repeat(v);if(i.keyCode===ss&&!M&&s.state.capture)if(i.preventDefault(),i.shiftKey){var f=s._getLines(C,x),m=f.length-1,p=s._getLines(C,c).length-1,E=C.split(`
`).map(function(R,Z){return Z>=m&&Z<=p&&R.startsWith(l)?R.substring(l.length):R}).join(`
`);if(C!==E){var b=f[m];s._applyEdits({value:E,selectionStart:b.startsWith(l)?x-l.length:x,selectionEnd:c-(C.length-E.length)})}}else if(x!==c){var k=s._getLines(C,x),L=k.length-1,D=s._getLines(C,c).length-1,$=k[L];s._applyEdits({value:C.split(`
`).map(function(R,Z){return Z>=L&&Z<=D?l+R:R}).join(`
`),selectionStart:/\S/.test($)?x+l.length:x,selectionEnd:c+l.length*(D-L+1)})}else{var G=x+l.length;s._applyEdits({value:C.substring(0,x)+l+C.substring(c),selectionStart:G,selectionEnd:G})}else if(i.keyCode===rs){var F=x!==c,V=C.substring(0,x);if(V.endsWith(l)&&!F){i.preventDefault();var X=x-l.length;s._applyEdits({value:C.substring(0,x-l.length)+C.substring(c),selectionStart:X,selectionEnd:X})}}else if(i.keyCode===ns){if(x===c){var ye=s._getLines(C,x).pop(),O=ye.match(/^\s+/);if(O&&O[0]){i.preventDefault();var z=`
`+O[0],U=x+z.length;s._applyEdits({value:C.substring(0,x)+z+C.substring(c),selectionStart:U,selectionEnd:U})}}}else if(i.keyCode===mt||i.keyCode===pt||i.keyCode===yt||i.keyCode===_t){var B=void 0;i.keyCode===mt&&i.shiftKey?B=["(",")"]:i.keyCode===pt?i.shiftKey?B=["{","}"]:B=["[","]"]:i.keyCode===yt?i.shiftKey?B=['"','"']:B=["'","'"]:i.keyCode===_t&&!i.shiftKey&&(B=["`","`"]),x!==c&&B&&(i.preventDefault(),s._applyEdits({value:C.substring(0,x)+B[0]+C.substring(x,c)+B[1]+C.substring(c),selectionStart:x,selectionEnd:c+2}))}else(Oe?i.metaKey&&i.keyCode===me:i.ctrlKey&&i.keyCode===me)&&!i.shiftKey&&!i.altKey?(i.preventDefault(),s._undoEdit()):(Oe?i.metaKey&&i.keyCode===me&&i.shiftKey:cs?i.ctrlKey&&i.keyCode===is:i.ctrlKey&&i.keyCode===me&&i.shiftKey)&&!i.altKey?(i.preventDefault(),s._redoEdit()):i.keyCode===as&&i.ctrlKey&&(Oe?i.shiftKey:!0)&&(i.preventDefault(),s.setState(function(R){return{capture:!R.capture}}))}},s._handleChange=function(i){var h=i.target,v=h.value,y=h.selectionStart,M=h.selectionEnd;s._recordChange({value:v,selectionStart:y,selectionEnd:M},!0),s.props.onValueChange(v)},s._history={stack:[],offset:-1},r),gt(s,o)}return Qn(t,[{key:"componentDidMount",value:function(){this._recordCurrentState()}},{key:"render",value:function(){var r=this,s=this.props,o=s.value,u=s.style,a=s.padding,g=s.highlight,i=s.textareaId,h=s.textareaClassName,v=s.autoFocus,y=s.disabled,M=s.form,I=s.maxLength,T=s.minLength,C=s.name,x=s.placeholder,c=s.readOnly,l=s.required,f=s.onClick,m=s.onFocus,p=s.onBlur,E=s.onKeyUp;s.onKeyDown,s.onValueChange,s.tabSize,s.insertSpaces,s.ignoreTabKey;var b=s.preClassName,k=Zn(s,["value","style","padding","highlight","textareaId","textareaClassName","autoFocus","disabled","form","maxLength","minLength","name","placeholder","readOnly","required","onClick","onFocus","onBlur","onKeyUp","onKeyDown","onValueChange","tabSize","insertSpaces","ignoreTabKey","preClassName"]),L={paddingTop:a,paddingRight:a,paddingBottom:a,paddingLeft:a},D=g(o);return ie.createElement("div",Y({},k,{style:Y({},ae.container,u)}),ie.createElement("textarea",{ref:function(G){return r._input=G},style:Y({},ae.editor,ae.textarea,L),className:pe+(h?" "+h:""),id:i,value:o,onChange:this._handleChange,onKeyDown:this._handleKeyDown,onClick:f,onKeyUp:E,onFocus:m,onBlur:p,disabled:y,form:M,maxLength:I,minLength:T,name:C,placeholder:x,readOnly:c,required:l,autoFocus:v,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),ie.createElement("pre",Y({className:b,"aria-hidden":"true",style:Y({},ae.editor,ae.highlight,L)},typeof D=="string"?{dangerouslySetInnerHTML:{__html:D+"<br />"}}:{children:D})),ie.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:us}}))}},{key:"session",get:function(){return{history:this._history}},set:function(r){this._history=r.history}}]),t}(ie.Component);Et.defaultProps={tabSize:2,insertSpaces:!0,ignoreTabKey:!1,padding:0};var hs=ft.default=Et,ae={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}},Re={exports:{}};(function(e){var t=typeof window!="undefined"?window:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,o=0,u={},a={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function c(l){return l instanceof g?new g(l.type,c(l.content),l.alias):Array.isArray(l)?l.map(c):l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(c){return Object.prototype.toString.call(c).slice(8,-1)},objId:function(c){return c.__id||Object.defineProperty(c,"__id",{value:++o}),c.__id},clone:function c(l,f){f=f||{};var m,p;switch(a.util.type(l)){case"Object":if(p=a.util.objId(l),f[p])return f[p];m={},f[p]=m;for(var E in l)l.hasOwnProperty(E)&&(m[E]=c(l[E],f));return m;case"Array":return p=a.util.objId(l),f[p]?f[p]:(m=[],f[p]=m,l.forEach(function(b,k){m[k]=c(b,f)}),m);default:return l}},getLanguage:function(c){for(;c;){var l=s.exec(c.className);if(l)return l[1].toLowerCase();c=c.parentElement}return"none"},setLanguage:function(c,l){c.className=c.className.replace(RegExp(s,"gi"),""),c.classList.add("language-"+l)},currentScript:function(){if(typeof document=="undefined")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(m){var c=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(m.stack)||[])[1];if(c){var l=document.getElementsByTagName("script");for(var f in l)if(l[f].src==c)return l[f]}return null}},isActive:function(c,l,f){for(var m="no-"+l;c;){var p=c.classList;if(p.contains(l))return!0;if(p.contains(m))return!1;c=c.parentElement}return!!f}},languages:{plain:u,plaintext:u,text:u,txt:u,extend:function(c,l){var f=a.util.clone(a.languages[c]);for(var m in l)f[m]=l[m];return f},insertBefore:function(c,l,f,m){m=m||a.languages;var p=m[c],E={};for(var b in p)if(p.hasOwnProperty(b)){if(b==l)for(var k in f)f.hasOwnProperty(k)&&(E[k]=f[k]);f.hasOwnProperty(b)||(E[b]=p[b])}var L=m[c];return m[c]=E,a.languages.DFS(a.languages,function(D,$){$===L&&D!=c&&(this[D]=E)}),E},DFS:function c(l,f,m,p){p=p||{};var E=a.util.objId;for(var b in l)if(l.hasOwnProperty(b)){f.call(l,b,l[b],m||b);var k=l[b],L=a.util.type(k);L==="Object"&&!p[E(k)]?(p[E(k)]=!0,c(k,f,null,p)):L==="Array"&&!p[E(k)]&&(p[E(k)]=!0,c(k,f,b,p))}}},plugins:{},highlightAll:function(c,l){a.highlightAllUnder(document,c,l)},highlightAllUnder:function(c,l,f){var m={callback:f,container:c,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};a.hooks.run("before-highlightall",m),m.elements=Array.prototype.slice.apply(m.container.querySelectorAll(m.selector)),a.hooks.run("before-all-elements-highlight",m);for(var p=0,E;E=m.elements[p++];)a.highlightElement(E,l===!0,m.callback)},highlightElement:function(c,l,f){var m=a.util.getLanguage(c),p=a.languages[m];a.util.setLanguage(c,m);var E=c.parentElement;E&&E.nodeName.toLowerCase()==="pre"&&a.util.setLanguage(E,m);var b=c.textContent,k={element:c,language:m,grammar:p,code:b};function L($){k.highlightedCode=$,a.hooks.run("before-insert",k),k.element.innerHTML=k.highlightedCode,a.hooks.run("after-highlight",k),a.hooks.run("complete",k),f&&f.call(k.element)}if(a.hooks.run("before-sanity-check",k),E=k.element.parentElement,E&&E.nodeName.toLowerCase()==="pre"&&!E.hasAttribute("tabindex")&&E.setAttribute("tabindex","0"),!k.code){a.hooks.run("complete",k),f&&f.call(k.element);return}if(a.hooks.run("before-highlight",k),!k.grammar){L(a.util.encode(k.code));return}if(l&&r.Worker){var D=new Worker(a.filename);D.onmessage=function($){L($.data)},D.postMessage(JSON.stringify({language:k.language,code:k.code,immediateClose:!0}))}else L(a.highlight(k.code,k.grammar,k.language))},highlight:function(c,l,f){var m={code:c,grammar:l,language:f};if(a.hooks.run("before-tokenize",m),!m.grammar)throw new Error('The language "'+m.language+'" has no grammar.');return m.tokens=a.tokenize(m.code,m.grammar),a.hooks.run("after-tokenize",m),g.stringify(a.util.encode(m.tokens),m.language)},tokenize:function(c,l){var f=l.rest;if(f){for(var m in f)l[m]=f[m];delete l.rest}var p=new v;return y(p,p.head,c),h(c,p,l,p.head,0),I(p)},hooks:{all:{},add:function(c,l){var f=a.hooks.all;f[c]=f[c]||[],f[c].push(l)},run:function(c,l){var f=a.hooks.all[c];if(!(!f||!f.length))for(var m=0,p;p=f[m++];)p(l)}},Token:g};r.Prism=a;function g(c,l,f,m){this.type=c,this.content=l,this.alias=f,this.length=(m||"").length|0}g.stringify=function c(l,f){if(typeof l=="string")return l;if(Array.isArray(l)){var m="";return l.forEach(function(L){m+=c(L,f)}),m}var p={type:l.type,content:c(l.content,f),tag:"span",classes:["token",l.type],attributes:{},language:f},E=l.alias;E&&(Array.isArray(E)?Array.prototype.push.apply(p.classes,E):p.classes.push(E)),a.hooks.run("wrap",p);var b="";for(var k in p.attributes)b+=" "+k+'="'+(p.attributes[k]||"").replace(/"/g,"&quot;")+'"';return"<"+p.tag+' class="'+p.classes.join(" ")+'"'+b+">"+p.content+"</"+p.tag+">"};function i(c,l,f,m){c.lastIndex=l;var p=c.exec(f);if(p&&m&&p[1]){var E=p[1].length;p.index+=E,p[0]=p[0].slice(E)}return p}function h(c,l,f,m,p,E){for(var b in f)if(!(!f.hasOwnProperty(b)||!f[b])){var k=f[b];k=Array.isArray(k)?k:[k];for(var L=0;L<k.length;++L){if(E&&E.cause==b+","+L)return;var D=k[L],$=D.inside,G=!!D.lookbehind,F=!!D.greedy,V=D.alias;if(F&&!D.pattern.global){var X=D.pattern.toString().match(/[imsuy]*$/)[0];D.pattern=RegExp(D.pattern.source,X+"g")}for(var ye=D.pattern||D,O=m.next,z=p;O!==l.tail&&!(E&&z>=E.reach);z+=O.value.length,O=O.next){var U=O.value;if(l.length>c.length)return;if(!(U instanceof g)){var B=1,R;if(F){if(R=i(ye,z,c,G),!R||R.index>=c.length)break;var _e=R.index,Z=R.index+R[0].length,q=z;for(q+=O.value.length;_e>=q;)O=O.next,q+=O.value.length;if(q-=O.value.length,z=q,O.value instanceof g)continue;for(var ce=O;ce!==l.tail&&(q<Z||typeof ce.value=="string");ce=ce.next)B++,q+=ce.value.length;B--,U=c.slice(z,q),R.index-=z}else if(R=i(ye,0,U,G),!R)continue;var _e=R.index,ve=R[0],Be=U.slice(0,_e),xt=U.slice(_e+ve.length),Pe=z+U.length;E&&Pe>E.reach&&(E.reach=Pe);var Ee=O.prev;Be&&(Ee=y(l,Ee,Be),z+=Be.length),M(l,Ee,B);var sr=new g(b,$?a.tokenize(ve,$):ve,V,ve);if(O=y(l,Ee,sr),xt&&y(l,O,xt),B>1){var ze={cause:b+","+L,reach:Pe};h(c,l,f,O.prev,z,ze),E&&ze.reach>E.reach&&(E.reach=ze.reach)}}}}}}function v(){var c={value:null,prev:null,next:null},l={value:null,prev:c,next:null};c.next=l,this.head=c,this.tail=l,this.length=0}function y(c,l,f){var m=l.next,p={value:f,prev:l,next:m};return l.next=p,m.prev=p,c.length++,p}function M(c,l,f){for(var m=l.next,p=0;p<f&&m!==c.tail;p++)m=m.next;l.next=m,m.prev=l,c.length-=p}function I(c){for(var l=[],f=c.head.next;f!==c.tail;)l.push(f.value),f=f.next;return l}if(!r.document)return r.addEventListener&&(a.disableWorkerMessageHandler||r.addEventListener("message",function(c){var l=JSON.parse(c.data),f=l.language,m=l.code,p=l.immediateClose;r.postMessage(a.highlight(m,a.languages[f],f)),p&&r.close()},!1)),a;var T=a.util.currentScript();T&&(a.filename=T.src,T.hasAttribute("data-manual")&&(a.manual=!0));function C(){a.manual||a.highlightAll()}if(!a.manual){var x=document.readyState;x==="loading"||x==="interactive"&&T&&T.defer?document.addEventListener("DOMContentLoaded",C):window.requestAnimationFrame?window.requestAnimationFrame(C):window.setTimeout(C,16)}return a}(t);e.exports&&(e.exports=n),typeof ge!="undefined"&&(ge.Prism=n)})(Re),function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(Prism);const{useState:ds,useCallback:cr}=d,fs=e=>w.reloadCSS(w.persist.store.quickCSS=e),gs=_.debounce(fs,250);var ms=()=>{const[e,t]=ds(w.persist.ghost.quickCSS);return d.createElement(ee.ErrorBoundary,null,d.createElement("div",{class:"ysink_stain_quickcss"},d.createElement(hs,{className:"ysink_stain_editorroot",value:e??"",onValueChange:n=>{t(n),gs(n)},highlight:n=>Re.exports.highlight(n,Re.exports.languages.css),padding:10}),d.createElement("link",{href:"https://cdn.jsdelivr.net/gh/PrismJS/prism-themes@master/themes/prism-atom-dark.css",rel:"stylesheet"}),d.createElement("style",null,`:root { --background-primary: #1d1f21; } .theme-light .${A.findByProps("contentColumn").contentColumn} { --text-normal: white; }`)))};const{useEffect:ps}=d,ys=A.findByDisplayName("FormTitle"),_s=A.findByDisplayName("FormText");A.findByDisplayName("FormDivider");const kt=A.findByProps("Sizes","Colors","Looks","DropdownSizes"),vs=A.findByProps("BadgeShapes");var Es=({repo:e})=>{const[t,n]=d.useState(void 0);return ps(async()=>{t||n(await he(e))}),d.createElement("div",{className:"ysink_stain_card ysink_stain_repocard"},d.createElement("div",{className:"ysink_stain_row"},d.createElement("div",null,d.createElement(ys,{tag:"p",className:"ysink_stain_title"},t?.manifest.meta.name,Ut.includes(e)?d.createElement(vs.TextBadge,{className:"ysink_stain_officialbadge",text:"official repo",color:"var(--info-positive-foreground)"}):[]),d.createElement(_s,null,e)),d.createElement(kt,{color:kt.Colors.RED,className:"ysink_stain_button",onClick:()=>w.persist.store.repos=w.persist.ghost.repos.filter(r=>r!=e)},"Remove Repo")))};const{useState:ks}=d,ws=A.findByDisplayName("Flex"),Ss=A.findByDisplayName("FormSection"),xs=A.findByDisplayName("FormDivider"),bs=A.findByDisplayName("TextInput"),Cs=A.findByProps("Sizes","Colors","Looks","DropdownSizes");async function Ms(e){try{return await he(e),!0}catch{return!1}}const $e=e=>ke.showToast({title:e,duration:5e3});async function As(e){if(e.endsWith("/")||(e+="/"),w.persist.ghost.repos.find(t=>t.url==e)!==void 0)return $e("You already have this repo!"),!1;if(await Ms(e)){let t=w.persist.ghost.repos;return t.push(e),w.persist.store.repos=t,$e("Added repo"),!0}else return $e("Repo was invalid"),!1}var Ns=({goTo:e})=>{const[t,n]=ks("");return se.useNest(w.persist),d.createElement(ee.ErrorBoundary,null,d.createElement(Ss,null,d.createElement(ws,{basis:"auto",grow:1,shrink:1,className:"ysink_stain_row"},d.createElement(bs,{placeholder:"https://example.com/repo",type:"text",value:t,onChange:r=>n(r)}),d.createElement(Cs,{className:"ysink_stain_button",onClick:async()=>{await As(t)&&n("")}},"Add")),d.createElement(xs,{className:"ysink_stain_divide"}),w.persist.ghost.repos.map(r=>d.createElement(Es,{repo:r}))))};const Is=A.findByDisplayName("FormTitle"),Ts=A.findByDisplayName("FormText"),Ds=A.findByDisplayName("FormSection"),Fe=A.findByProps("Sizes","Colors","Looks","DropdownSizes");var Ls=({goToRepos:e})=>d.createElement(Ds,{className:"ysink_stain_nosplash"},d.createElement(Is,{tag:"h2"},"No Repos"),d.createElement(Ts,null,"Add one in the repo manager!"),d.createElement(Fe,{className:"ysink_stain_button",color:Fe.Colors.GREEN,sizes:Fe.Sizes.LARGE,onClick:e},"Open repo manager"));const{useState:oe,useEffect:Os,useReducer:Rs}=d,$s=()=>Promise.all(w.persist.ghost.repos.map(he)),Fs=e=>e.flatMap(t=>t.themes);async function Bs(){let e=await $s();return{repos:e,themes:Fs(e)}}const Ps=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((n,r)=>n===t[r]);var zs=({goTo:e})=>{se.useNest(w.persist);const[t,n]=oe(""),[r,s]=oe([]),[o,u]=oe(void 0),[a,g]=oe(void 0),[i,h]=oe(0);Os(()=>{let y=()=>Bs().then(({repos:M,themes:I})=>{u(M),g(I)});Ps(r,w.persist.ghost.repos)||(s(w.persist.ghost.repos),y()),(!o||!a)&&y()});const[,v]=Rs(y=>~y,0);return d.createElement(ee.ErrorBoundary,null,d.createElement("div",{className:"ysink_stain_search_row"},d.createElement(ut,{query:t,onChange:n}),d.createElement(ht,{filterMode:i,setFilterMode:h})),w.persist.ghost.repos.length===0?d.createElement(Ls,{goToRepos:()=>e(2)}):d.createElement("div",{className:"ysink_stain_cardcontainer"},lt(_.uniqBy(a??[],y=>y.url),t).filter(y=>i===0||i===1&&!y.compat||i===2&&y.compat).map(y=>d.createElement(Ge,{theme:y,deleteHook:v}))))};const{useState:Ks,createElement:js}=d,Us=A.findByDisplayName("FormText"),Ws=A.findByDisplayName("FormDivider");var Hs=({items:e})=>{let[t,n]=Ks(0);return d.createElement("div",{className:"ysink_stain_tabbar_root"},d.createElement("div",{className:"ysink_stain_tabbar"},e.map((r,s)=>d.createElement("button",{className:"ysink_stain_button"+(s===t?" ysink_stain_selected":""),onClick:()=>n(s)},d.createElement(Us,null,r.text)))),d.createElement(Ws,{className:"ysink_stain_divide"}),d.createElement("div",{className:"ysink_stain_tabbar_content"},js(e[t].component,{goTo:n})))};const Ys=A.findByDisplayName("FormTitle"),Gs=A.findByDisplayName("FormSection");var Vs=()=>d.createElement(ee.ErrorBoundary,null,d.createElement(Gs,null,d.createElement(Ys,{tag:"h1"},"Cumstain Settings"),d.createElement(Hs,{items:[{text:"Installed",component:qn},{text:"Store",component:zs},{text:"Repos",component:Ns},{text:"Quick CSS",component:ms}]}))),qs=()=>ne.findAndPatch(()=>A.findByDisplayName("SettingsView"),e=>ne.after("getPredicateSections",e.prototype,(t,n)=>{if(n[1]?.section!="My Account")return;let r=n.findIndex(s=>s.section=="CUMCORD_PLUGINS")+1;return n.splice(r,0,{section:"ysink_stain_CUMSTAIN",label:"Themes",element:Vs}),n})),Qs=()=>ne.injectCSS(".ysink_stain_tabbar{padding:.5rem 1rem;display:grid;grid-auto-flow:column;grid-auto-columns:7rem}.ysink_stain_tabbar .ysink_stain_button *{cursor:pointer}.ysink_stain_tabbar>*{margin-right:1rem;padding:.2rem;border-radius:.3rem;min-width:5rem;text-align:center;background:none}.theme-dark .ysink_stain_tabbar>*.ysink_stain_selected{background:rgba(255,255,255,.2666666667)}.theme-light .ysink_stain_tabbar>*.ysink_stain_selected{background:rgba(0,0,0,.2)}.ysink_stain_tabbar>*:last-child{margin-right:0}.ysink_stain_cardcontainer{display:flex;flex-flow:row wrap;gap:.75rem}.ysink_stain_cardcontainer>*{width:20rem}.ysink_stain_card{padding:1rem;border:1px solid var(--background-modifier-accent);border-radius:.5rem;display:flex;flex-direction:column;z-index:1;background-color:var(--deprecated-card-bg)}.ysink_stain_card .ysink_stain_title{font-size:1rem;padding-top:.2rem;display:inline;flex:1;margin:0}.ysink_stain_card .ysink_stain_button{display:inline;padding:0}.ysink_stain_card .ysink_stain_button>div{padding:2px 16px}.ysink_stain_card .ysink_stain_card_row{display:flex;margin-bottom:.5rem}.ysink_stain_card .ysink_stain_author_licence{font-style:italic}.ysink_stain_card .ysink_stain_desc{flex:1}.ysink_stain_card .ysink_stain_carousel{margin-bottom:1rem}.ysink_stain_card .ysink_stain_carousel>div:not(.ysink_stain_noimg)>:last-child,.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg>div>:last-child{height:2.25rem}.ysink_stain_card .ysink_stain_carousel>div{border-radius:.5rem}.theme-dark .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:rgba(0,0,0,.3333333333)}.theme-light .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:rgba(0,0,0,.8666666667)}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg{display:grid}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div{grid-area:1/1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div:not(.ysink_stain_noimgtxt){visibility:hidden;z-index:-1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div.ysink_stain_noimgtxt{grid-area:1/1;font-size:1.5rem;text-align:center;padding-top:35%;text-transform:uppercase;opacity:.8}.ysink_stain_divide{margin:.5rem 0}.ysink_stain_card .ysink_stain_divide{margin:.2rem 0}.ysink_stain_delete{margin-right:.5rem;fill:var(--interactive-normal)}.ysink_stain_installbar{display:flex}.ysink_stain_installbar>*{flex:1}.ysink_stain_installbar>:last-child{flex:unset;margin-left:1rem}.ysink_stain_searchbar{margin:.75rem 0}.ysink_stain_search_row{display:flex;gap:.75rem;margin:.75rem 0}.ysink_stain_search_row .ysink_stain_dropdown{height:2.25rem;flex-basis:10rem;padding-top:.3rem}.ysink_stain_search_row .ysink_stain_searchbar{margin:unset;flex:1}.ysink_stain_editorroot{background:tranparent;color:#c5c8c6;font-family:var(--font-code);font-size:.9rem;line-height:1.1rem}.ysink_stain_badge{width:1.5rem;height:1.5rem;margin-right:.5rem;border-radius:50%}.ysink_stain_badge.ysink_stain_bd{padding:.25rem;background:#040405}.ysink_stain_badge.ysink_stain_cc{padding:.1rem;background:#f8f8f8;background:#7289DA}.ysink_stain_nosplash{display:flex;flex-direction:column;align-items:center;margin-top:15rem;gap:.5rem}.ysink_stain_nosplash h2{margin-bottom:0}.ysink_stain_nosplash>*{flex:0}.ysink_stain_nosplash .ysink_stain_button{margin-top:2rem}.ysink_stain_row{display:flex}.ysink_stain_row>*{flex:1}.ysink_stain_row>:last-child{flex:unset;margin-left:1rem}.ysink_stain_officialbadge{display:inline;margin-left:.5rem}.ysink_stain_repocard{margin-bottom:.25rem}"),Js=()=>{const e=ne.injectCSS(N.default.persist.ghost.quickCSS);return N.default.reloadCSS=t=>e(t??N.default.persist.ghost.quickCSS),()=>{e(),N.default.reloadCSS=void 0,delete N.default.reloadCSS}};const le=e=>w.persist.ghost.themes.find(t=>t.url===e),wt=e=>!!le(e)?.enabled,St=e=>wt(e.url)?Pt(e):ue(e),Xs=async e=>await St(await re(e)),Zs=e=>Ke(le(e)),er=async e=>{if(!le(e))throw new Error(`Theme with ID ${e} was not installed`);wt(e)?xe(le(e)):await St(le(e))},J=async()=>{if(!window.cumstain){we.error("|| CUMSTAIN || API was not found, so nests could not be updated.");return}for(const e in cumstain.installed.ghost)delete cumstain.installed.ghost[e],cumstain.installed.delete(e);for(const e of w.persist.ghost.themes)cumstain.installed.store[e.url]={enabled:e.enabled,manifest:e};for(const[e,t]of Object.entries(cumstain.installed.ghost))t.enabled?cumstain.enabled.store[e]=t:(delete cumstain.enabled.ghost[e],cumstain.installed.delete(e))};var tr=()=>(window.cumstain={installed:W.nests.make({}),enabled:W.nests.make({}),importTheme:Xs,removeTheme:Zs,toggleTheme:er},J(),w.persist.on(W.nests.Events.UPDATE,J),w.persist.on(W.nests.Events.SET,J),w.persist.on(W.nests.Events.DELETE,J),we.log("|| CUMSTAIN || Initialised window.cumstain API"),()=>{w.persist.off(W.nests.Events.UPDATE,J),w.persist.off(W.nests.Events.SET,J),w.persist.off(W.nests.Events.DELETE,J),window.cumstain=void 0,delete window.cumstain,we.log("|| CUMSTAIN || Disposed window.cumstain API")}),nr=({persist:e})=>{const t=[Qs(),Ht(),Kt(),Js(),qs(),tr()];return{onUnload:()=>_.forEachRight(t,n=>n())}};return nr})(cumcord.pluginData,cumcord.patcher,cumcord.modules.internal.nests,cumcord.modules.webpack,cumcord.modules.common.React,cumcord.utils,cumcord.ui.components,cumcord.ui.toasts,cumcord.modules.common.React,cumcord.modules.internal,cumcord.utils.logger);
