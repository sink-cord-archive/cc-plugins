(function(x,ue,It,w,ee,ne,xe,u,Tt,se,j){"use strict";function we(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var M=we(x),At=we(It),Dt=we(Tt);function he(e){if(!e?.id||!e.CSS)throw new Error("theme was missing either id or css.");const t=ue.injectCSS(e.CSS);M.default.state.ghost.unpatchCache.set(e.id,t);const s=M.default.persist.ghost.themes.findIndex(n=>n.id===e.id);let r={...e};r.enabled=!0,s===-1?M.default.persist.ghost.themes.push(r):M.default.persist.ghost.themes[s]=r,M.default.persist.store.themes=M.default.persist.ghost.themes}function Re(e){if(!e?.id)throw new Error("theme was missing id.");M.default.state.ghost.unpatchCache.get(e.id)?.(),M.default.state.ghost.unpatchCache.delete(e.id);const s=M.default.persist.ghost.themes.findIndex(n=>n.id===e.id);let r={...e};r.enabled=!1,s===-1?M.default.persist.ghost.themes.push(r):M.default.persist.ghost.themes[s]=r,M.default.persist.store.themes=M.default.persist.ghost.themes}function He(e){try{Re(e)}catch(t){if(t.message!=="theme was not loaded.")throw t}M.default.persist.store.themes=M.default.persist.ghost.themes.filter(t=>t.id!==e.id)}function Ft(e){M.default.state.ghost.unpatchCache.get(e.id)?.(e.CSS);let s={...e};s.enabled=!0;const r=M.default.persist.ghost.themes.findIndex(n=>n.id===e.id);r!==-1&&(M.default.persist.ghost.themes[r]=s,M.default.persist.store.themes=M.default.persist.ghost.themes)}function Lt(){M.default.state.ghost.unpatchCache.forEach(e=>e?.()),M.default.state.ghost.unpatchCache.clear()}var Ot=()=>(x.persist.ghost.themes&&x.persist.ghost.themes.filter(e=>e.enabled).forEach(he),Lt),Bt=()=>(M.default.persist.ghost.repos||(M.default.persist.store.repos=[]),M.default.persist.ghost.themes||(M.default.persist.store.themes=[]),M.default.state=At.default.make({unpatchCache:new Map}),()=>{M.default.state=void 0,delete M.default.state});const $t=/[^\S\r\n]*?\r?\n[^\S\r\n]*?\*[^\S\r\n]?/,Pt=/^\\@/;function zt(e){try{return JSON.parse(e)}catch{}}function Kt(e){const t=e.split(`
`)[0];if(t.includes("//META"))return Ut(e);if(t.includes("/**"))return Wt(e);throw new Error("META was not found.")}function Ut(e){const t=e.split(`
`)[0],s=t.substring(t.lastIndexOf("//META")+6,t.lastIndexOf("*//")),r=zt(s);if(!r)throw new Error("META could not be parsed.");if(!r.name)throw new Error("META missing name data.");return r}function Wt(e){const t=e.split("/**",2)[1].split("*/",1)[0],s={};let r="",n="";for(const o of t.split($t))if(o.length!==0)if(o.charAt(0)==="@"&&o.charAt(1)!==" "){s[r]=n;const h=o.indexOf(" ");r=o.substr(1,h-1),n=o.substr(h+1)}else n+=" "+o.replace("\\n",`
`).replace(Pt,"@");return s[r]=n.trim(),delete s[""],s}async function jt(e,t){const s=await(await fetch(new URL(e,t).href)).text();return{id:e,CSS:s,compat:!0,...Kt(s)}}async function Ht(e,t){const s=await(await fetch(new URL(e,t).href)).text();let r=new URL(e,t).pathname.split("/");r.splice(r.length-1,1,"cumcord_theme.json");const n=new URL(r.join("/"),new URL(e,t).origin),o=await(await fetch(n.href)).json();return{id:e,CSS:s,compat:!1,...o}}var de=async(e,t)=>{try{return await Ht(e,t)}catch(s){try{return await jt(e,t)}catch(r){let n=new Error("Failed to fetch theme - both CC and BD either failed to fetch or failed to parse");throw n.e1=s,n.e2=r,n}}};async function Yt(e){const t=new URL("repo.json",e).href,s=await(await fetch(t)).json();if(!s.themes||s.themes?.length===0)throw new Error("No themes found in repo");if(!s.meta)throw new Error("No repo metadata");if(!s?.meta.name)throw new Error("Repo did not have a name");return s}var fe=async e=>{const t=await Yt(e),s=await Promise.all(t.themes.map(r=>de(r,e)));return{manifest:t,themes:s}};const{useEffect:Gt}=u.React,Vt=w.findByDisplayName("FormTitle"),qt=w.findByDisplayName("FormText");w.findByDisplayName("FormDivider");const Ye=w.findByProps("Sizes","Colors","Looks","DropdownSizes");var Qt=({repo:e})=>{const[t,s]=u.React.useState(void 0);return Gt(async()=>{t||s(await fe(e))}),u.React.createElement("div",{className:"ysink_stain_card ysink_stain_repocard"},u.React.createElement("div",{className:"ysink_stain_row"},u.React.createElement("div",null,u.React.createElement(Vt,{tag:"p",className:"ysink_stain_title"},t?.manifest.meta.name),u.React.createElement(qt,null,e)),u.React.createElement(Ye,{color:Ye.Colors.RED,className:"ysink_stain_button",onClick:()=>x.persist.store.repos=x.persist.ghost.repos.filter(r=>r!=e)},"Remove Repo")))};const{useState:Jt}=u.React,ge=w.findByProps("ModalCloseButton"),Ge=w.findByProps("Sizes","Tags"),be=w.findByDisplayName("Flex"),{openModal:Xt}=w.findByProps("openModalLazy"),Zt=w.findByDisplayName("FormSection"),en=w.findByDisplayName("FormDivider"),tn=w.findByDisplayName("TextInput"),nn=w.findByProps("Sizes","Colors","Looks","DropdownSizes");async function sn(e){try{return await fe(e),!0}catch{return!1}}const Ce=e=>xe.showToast({title:e,duration:5e3});async function rn(e){if(e.endsWith("/")||(e+="/"),x.persist.ghost.repos.find(t=>t.url==e)!==void 0)return Ce("You already have this repo!"),!1;if(await sn(e)){let t=x.persist.ghost.repos;return e.split("/"),t.push(e),x.persist.store.repos=t,Ce("Added repo"),!0}else return Ce("Repo was invalid"),!1}const an=({e})=>{const[t,s]=Jt("");return ne.useNest(x.persist),u.React.createElement(ee.ErrorBoundary,null,u.React.createElement(ge.ModalRoot,{transitionState:e.transitionState,size:"large",className:"ysink_stain_modal"},u.React.createElement(ge.ModalHeader,{separator:!1},u.React.createElement(be.Child,{basis:"auto",grow:1,shrink:1,wrap:!1},u.React.createElement(Ge,{tag:"h2",size:Ge.Sizes.SIZE_20},"Repo Manager")),u.React.createElement(be.Child,{basis:"auto",grow:0,shrink:1,wrap:!1},u.React.createElement(ge.ModalCloseButton,{onClick:e.onClose}))),u.React.createElement(ge.ModalContent,null,u.React.createElement(Zt,null,u.React.createElement(be,{basis:"auto",grow:1,shrink:1,className:"ysink_stain_row"},u.React.createElement(tn,{className:"ysink_stain_input",placeholder:"https://example.com/repo",type:"text",value:t,onChange:r=>s(r)}),u.React.createElement(nn,{className:"ysink_stain_button",onClick:async()=>{await rn(t)&&s("")}},"Add")),u.React.createElement(en,{className:"ysink_stain_divide"}),x.persist.ghost.repos.map(r=>u.React.createElement(Qt,{repo:r}))))))};var Ve=()=>Xt(e=>u.React.createElement(an,{e}));const on=u.React.useState,ln=u.React.createElement,cn=w.findByDisplayName("FormText"),un=w.findByDisplayName("FormDivider");var hn=({items:e})=>{let[t,s]=on(0);return u.React.createElement("div",{className:"ysink_stain_tabbar_root"},u.React.createElement("div",{className:"ysink_stain_tabbar"},e.map((r,n)=>u.React.createElement("button",{className:"ysink_stain_button"+(n===t?" ysink_stain_selected":""),onClick:()=>s(n)},u.React.createElement(cn,null,r.text)))),u.React.createElement(un,{className:"ysink_stain_divide"}),u.React.createElement("div",{className:"ysink_stain_tabbar_content"},ln(e[t].component,{goTo:s})))},dn=()=>u.React.createElement("img",{src:"https://betterdiscord.app/resources/branding/logo_small.svg",className:"ysink_stain_badge ysink_stain_bd"}),fn=()=>u.React.createElement("img",{src:"https://avatars.githubusercontent.com/u/81397549",className:"ysink_stain_badge ysink_stain_cc"}),gn=({theme:e,onClick:t})=>u.React.createElement("svg",{onClick:t,className:"ysink_stain_delete",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px"},u.React.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),u.React.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),u.React.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}));const pn=w.findByDisplayName("FormText"),qe=w.findByDisplayName("SmallMediaCarousel");var yn=({media:e})=>u.React.createElement("div",{class:"ysink_stain_carousel"},e?u.React.createElement(qe,{items:(typeof e=="string"?[e]:e).map(t=>({type:1,src:t})),autoplayInterval:5e3}):u.React.createElement("div",{className:"ysink_stain_noimg"},u.React.createElement(pn,{className:"ysink_stain_noimgtxt"},"No Image"),u.React.createElement(qe,{items:[{type:1,src:""}]})));const mn=w.findByDisplayName("FormTitle"),Qe=w.findByDisplayName("FormText"),_n=w.findByDisplayName("FormSection"),vn=w.findByDisplayName("FormDivider"),En=w.findByDisplayName("Switch"),Je=e=>{for(const t of x.persist.ghost.themes)if(t.id===e&&t.enabled)return!0;return!1},Sn=e=>x.persist.ghost.themes.some(t=>t.id===e);var Xe=({theme:e,deleteHook:t})=>(ne.useNest(x.persist),u.React.createElement("div",{className:"ysink_stain_card"},u.React.createElement(_n,null,u.React.createElement(yn,{media:e.media}),u.React.createElement("div",{className:"ysink_stain_row"},e.compat?u.React.createElement(dn,null):u.React.createElement(fn,null),u.React.createElement(mn,{tag:"p",className:"ysink_stain_title"},e.name),Sn(e.id)?u.React.createElement(gn,{theme:e,onClick:()=>{He(e),t?.()}}):[],u.React.createElement(En,{checked:Je(e.id),onChange:()=>Je(e.id)?Re(e):he(e)})),u.React.createElement(Qe,{className:"ysink_stain_desc"},e.description),u.React.createElement(vn,{className:"ysink_stain_divide"}),u.React.createElement(Qe,{className:"ysink_stain_author_licence"},e.author?`by ${e.author} `:"",e.license?`under ${e.license}`:""))));const{useState:kn}=u.React,xn=w.findByProps("Sizes","Colors","Looks","DropdownSizes"),wn=w.findByDisplayName("TextInput");var Rn=()=>{ne.useNest(x.persist);let[e,t]=kn("");return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement("div",{className:"ysink_stain_installbar"},u.React.createElement(wn,{className:"ysink_stain_input",placeholder:"Theme import URL",type:"text",value:e,onChange:s=>t(s)}),u.React.createElement(xn,{className:"ysink_stain_button",onClick:()=>{de(e).then(s=>{he(s),xe.showToast({title:`Loaded theme ${s.name}`,duration:5e3})},()=>xe.showToast({title:"Failed to fetch theme - check URL",duration:5e3})),t("")}},"Install")))};function K(e){return Array.isArray?Array.isArray(e):tt(e)==="[object Array]"}const bn=1/0;function Cn(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-bn?"-0":t}function Mn(e){return e==null?"":Cn(e)}function U(e){return typeof e=="string"}function Ze(e){return typeof e=="number"}function Nn(e){return e===!0||e===!1||In(e)&&tt(e)=="[object Boolean]"}function et(e){return typeof e=="object"}function In(e){return et(e)&&e!==null}function P(e){return e!=null}function Me(e){return!e.trim().length}function tt(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const lr="Extended search is not available",Tn="Incorrect 'index' type",An=e=>`Invalid value for key ${e}`,Dn=e=>`Pattern length exceeds max of ${e}.`,Fn=e=>`Missing ${e} property in key`,Ln=e=>`Property 'weight' in key '${e}' must be a positive integer`,nt=Object.prototype.hasOwnProperty;class On{constructor(t){this._keys=[],this._keyMap={};let s=0;t.forEach(r=>{let n=st(r);s+=n.weight,this._keys.push(n),this._keyMap[n.id]=n,s+=n.weight}),this._keys.forEach(r=>{r.weight/=s})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function st(e){let t=null,s=null,r=null,n=1;if(U(e)||K(e))r=e,t=rt(e),s=Ne(e);else{if(!nt.call(e,"name"))throw new Error(Fn("name"));const o=e.name;if(r=o,nt.call(e,"weight")&&(n=e.weight,n<=0))throw new Error(Ln(o));t=rt(o),s=Ne(o)}return{path:t,id:s,weight:n,src:r}}function rt(e){return K(e)?e:e.split(".")}function Ne(e){return K(e)?e.join("."):e}function Bn(e,t){let s=[],r=!1;const n=(o,h,a)=>{if(!!P(o))if(!h[a])s.push(o);else{let g=h[a];const i=o[g];if(!P(i))return;if(a===h.length-1&&(U(i)||Ze(i)||Nn(i)))s.push(Mn(i));else if(K(i)){r=!0;for(let d=0,y=i.length;d<y;d+=1)n(i[d],h,a+1)}else h.length&&n(i,h,a+1)}};return n(e,U(t)?t.split("."):t,0),r?s:s[0]}var k={...{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:Bn,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const $n=/[^ ]+/g;function Pn(e=1,t=3){const s=new Map,r=Math.pow(10,t);return{get(n){const o=n.match($n).length;if(s.has(o))return s.get(o);const h=1/Math.pow(o,.5*e),a=parseFloat(Math.round(h*r)/r);return s.set(o,a),a},clear(){s.clear()}}}class Ie{constructor({getFn:t=k.getFn,fieldNormWeight:s=k.fieldNormWeight}={}){this.norm=Pn(s,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((s,r)=>{this._keysMap[s.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,U(this.docs[0])?this.docs.forEach((t,s)=>{this._addString(t,s)}):this.docs.forEach((t,s)=>{this._addObject(t,s)}),this.norm.clear())}add(t){const s=this.size();U(t)?this._addString(t,s):this._addObject(t,s)}removeAt(t){this.records.splice(t,1);for(let s=t,r=this.size();s<r;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(t,s){return t[this._keysMap[s]]}size(){return this.records.length}_addString(t,s){if(!P(t)||Me(t))return;let r={v:t,i:s,n:this.norm.get(t)};this.records.push(r)}_addObject(t,s){let r={i:s,$:{}};this.keys.forEach((n,o)=>{let h=this.getFn(t,n.path);if(!!P(h)){if(K(h)){let a=[];const g=[{nestedArrIndex:-1,value:h}];for(;g.length;){const{nestedArrIndex:i,value:d}=g.pop();if(!!P(d))if(U(d)&&!Me(d)){let y={v:d,i,n:this.norm.get(d)};a.push(y)}else K(d)&&d.forEach((y,E)=>{g.push({nestedArrIndex:E,value:y})})}r.$[o]=a}else if(!Me(h)){let a={v:h,n:this.norm.get(h)};r.$[o]=a}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function it(e,t,{getFn:s=k.getFn,fieldNormWeight:r=k.fieldNormWeight}={}){const n=new Ie({getFn:s,fieldNormWeight:r});return n.setKeys(e.map(st)),n.setSources(t),n.create(),n}function zn(e,{getFn:t=k.getFn,fieldNormWeight:s=k.fieldNormWeight}={}){const{keys:r,records:n}=e,o=new Ie({getFn:t,fieldNormWeight:s});return o.setKeys(r),o.setIndexRecords(n),o}function pe(e,{errors:t=0,currentLocation:s=0,expectedLocation:r=0,distance:n=k.distance,ignoreLocation:o=k.ignoreLocation}={}){const h=t/e.length;if(o)return h;const a=Math.abs(r-s);return n?h+a/n:a?1:h}function Kn(e=[],t=k.minMatchCharLength){let s=[],r=-1,n=-1,o=0;for(let h=e.length;o<h;o+=1){let a=e[o];a&&r===-1?r=o:!a&&r!==-1&&(n=o-1,n-r+1>=t&&s.push([r,n]),r=-1)}return e[o-1]&&o-r>=t&&s.push([r,o-1]),s}const Q=32;function Un(e,t,s,{location:r=k.location,distance:n=k.distance,threshold:o=k.threshold,findAllMatches:h=k.findAllMatches,minMatchCharLength:a=k.minMatchCharLength,includeMatches:g=k.includeMatches,ignoreLocation:i=k.ignoreLocation}={}){if(t.length>Q)throw new Error(Dn(Q));const d=t.length,y=e.length,E=Math.max(0,Math.min(r,y));let N=o,I=E;const T=a>1||g,C=T?Array(y):[];let R;for(;(R=e.indexOf(t,I))>-1;){let v=pe(t,{currentLocation:R,expectedLocation:E,distance:n,ignoreLocation:i});if(N=Math.min(v,N),I=R+d,T){let b=0;for(;b<d;)C[R+b]=1,b+=1}}I=-1;let c=[],l=1,f=d+y;const p=1<<d-1;for(let v=0;v<d;v+=1){let b=0,S=f;for(;b<S;)pe(t,{errors:v,currentLocation:E+S,expectedLocation:E,distance:n,ignoreLocation:i})<=N?b=S:f=S,S=Math.floor((f-b)/2+b);f=S;let D=Math.max(1,E-S+1),A=h?y:Math.min(E+S,y)+d,O=Array(A+2);O[A+1]=(1<<v)-1;for(let B=A;B>=D;B-=1){let V=B-1,X=s[e.charAt(V)];if(T&&(C[V]=+!!X),O[B]=(O[B+1]<<1|1)&X,v&&(O[B]|=(c[B+1]|c[B])<<1|1|c[B+1]),O[B]&p&&(l=pe(t,{errors:v,currentLocation:V,expectedLocation:E,distance:n,ignoreLocation:i}),l<=N)){if(N=l,I=V,I<=E)break;D=Math.max(1,2*E-I)}}if(pe(t,{errors:v+1,currentLocation:E,expectedLocation:E,distance:n,ignoreLocation:i})>N)break;c=O}const m={isMatch:I>=0,score:Math.max(.001,l)};if(T){const v=Kn(C,a);v.length?g&&(m.indices=v):m.isMatch=!1}return m}function Wn(e){let t={};for(let s=0,r=e.length;s<r;s+=1){const n=e.charAt(s);t[n]=(t[n]||0)|1<<r-s-1}return t}class at{constructor(t,{location:s=k.location,threshold:r=k.threshold,distance:n=k.distance,includeMatches:o=k.includeMatches,findAllMatches:h=k.findAllMatches,minMatchCharLength:a=k.minMatchCharLength,isCaseSensitive:g=k.isCaseSensitive,ignoreLocation:i=k.ignoreLocation}={}){if(this.options={location:s,threshold:r,distance:n,includeMatches:o,findAllMatches:h,minMatchCharLength:a,isCaseSensitive:g,ignoreLocation:i},this.pattern=g?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const d=(E,N)=>{this.chunks.push({pattern:E,alphabet:Wn(E),startIndex:N})},y=this.pattern.length;if(y>Q){let E=0;const N=y%Q,I=y-N;for(;E<I;)d(this.pattern.substr(E,Q),E),E+=Q;if(N){const T=y-Q;d(this.pattern.substr(T),T)}}else d(this.pattern,0)}searchIn(t){const{isCaseSensitive:s,includeMatches:r}=this.options;if(s||(t=t.toLowerCase()),this.pattern===t){let I={isMatch:!0,score:0};return r&&(I.indices=[[0,t.length-1]]),I}const{location:n,distance:o,threshold:h,findAllMatches:a,minMatchCharLength:g,ignoreLocation:i}=this.options;let d=[],y=0,E=!1;this.chunks.forEach(({pattern:I,alphabet:T,startIndex:C})=>{const{isMatch:R,score:c,indices:l}=Un(t,I,T,{location:n+C,distance:o,threshold:h,findAllMatches:a,minMatchCharLength:g,includeMatches:r,ignoreLocation:i});R&&(E=!0),y+=c,R&&l&&(d=[...d,...l])});let N={isMatch:E,score:E?y/this.chunks.length:1};return E&&r&&(N.indices=d),N}}class H{constructor(t){this.pattern=t}static isMultiMatch(t){return ot(t,this.multiRegex)}static isSingleMatch(t){return ot(t,this.singleRegex)}search(){}}function ot(e,t){const s=e.match(t);return s?s[1]:null}class jn extends H{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const s=t===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class Hn extends H{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const r=t.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class Yn extends H{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const s=t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class Gn extends H{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const s=!t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class Vn extends H{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const s=t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class qn extends H{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const s=!t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class lt extends H{constructor(t,{location:s=k.location,threshold:r=k.threshold,distance:n=k.distance,includeMatches:o=k.includeMatches,findAllMatches:h=k.findAllMatches,minMatchCharLength:a=k.minMatchCharLength,isCaseSensitive:g=k.isCaseSensitive,ignoreLocation:i=k.ignoreLocation}={}){super(t);this._bitapSearch=new at(t,{location:s,threshold:r,distance:n,includeMatches:o,findAllMatches:h,minMatchCharLength:a,isCaseSensitive:g,ignoreLocation:i})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class ct extends H{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let s=0,r;const n=[],o=this.pattern.length;for(;(r=t.indexOf(this.pattern,s))>-1;)s=r+o,n.push([r,s-1]);const h=!!n.length;return{isMatch:h,score:h?0:1,indices:n}}}const Te=[jn,ct,Yn,Gn,qn,Vn,Hn,lt],ut=Te.length,Qn=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,Jn="|";function Xn(e,t={}){return e.split(Jn).map(s=>{let r=s.trim().split(Qn).filter(o=>o&&!!o.trim()),n=[];for(let o=0,h=r.length;o<h;o+=1){const a=r[o];let g=!1,i=-1;for(;!g&&++i<ut;){const d=Te[i];let y=d.isMultiMatch(a);y&&(n.push(new d(y,t)),g=!0)}if(!g)for(i=-1;++i<ut;){const d=Te[i];let y=d.isSingleMatch(a);if(y){n.push(new d(y,t));break}}}return n})}const Zn=new Set([lt.type,ct.type]);class es{constructor(t,{isCaseSensitive:s=k.isCaseSensitive,includeMatches:r=k.includeMatches,minMatchCharLength:n=k.minMatchCharLength,ignoreLocation:o=k.ignoreLocation,findAllMatches:h=k.findAllMatches,location:a=k.location,threshold:g=k.threshold,distance:i=k.distance}={}){this.query=null,this.options={isCaseSensitive:s,includeMatches:r,minMatchCharLength:n,findAllMatches:h,ignoreLocation:o,location:a,threshold:g,distance:i},this.pattern=s?t:t.toLowerCase(),this.query=Xn(this.pattern,this.options)}static condition(t,s){return s.useExtendedSearch}searchIn(t){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:n}=this.options;t=n?t:t.toLowerCase();let o=0,h=[],a=0;for(let g=0,i=s.length;g<i;g+=1){const d=s[g];h.length=0,o=0;for(let y=0,E=d.length;y<E;y+=1){const N=d[y],{isMatch:I,indices:T,score:C}=N.search(t);if(I){if(o+=1,a+=C,r){const R=N.constructor.type;Zn.has(R)?h=[...h,...T]:h.push(T)}}else{a=0,o=0,h.length=0;break}}if(o){let y={isMatch:!0,score:a/o};return r&&(y.indices=h),y}}return{isMatch:!1,score:1}}}const Ae=[];function ts(...e){Ae.push(...e)}function De(e,t){for(let s=0,r=Ae.length;s<r;s+=1){let n=Ae[s];if(n.condition(e,t))return new n(e,t)}return new at(e,t)}const re={AND:"$and",OR:"$or"},Fe={PATH:"$path",PATTERN:"$val"},Le=e=>!!(e[re.AND]||e[re.OR]),ns=e=>!!e[Fe.PATH],ss=e=>!K(e)&&et(e)&&!Le(e),ht=e=>({[re.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function dt(e,t,{auto:s=!0}={}){const r=n=>{let o=Object.keys(n);const h=ns(n);if(!h&&o.length>1&&!Le(n))return r(ht(n));if(ss(n)){const g=h?n[Fe.PATH]:o[0],i=h?n[Fe.PATTERN]:n[g];if(!U(i))throw new Error(An(g));const d={keyId:Ne(g),pattern:i};return s&&(d.searcher=De(i,t)),d}let a={children:[],operator:o[0]};return o.forEach(g=>{const i=n[g];K(i)&&i.forEach(d=>{a.children.push(r(d))})}),a};return Le(e)||(e=ht(e)),r(e)}function rs(e,{ignoreFieldNorm:t=k.ignoreFieldNorm}){e.forEach(s=>{let r=1;s.matches.forEach(({key:n,norm:o,score:h})=>{const a=n?n.weight:null;r*=Math.pow(h===0&&a?Number.EPSILON:h,(a||1)*(t?1:o))}),s.score=r})}function is(e,t){const s=e.matches;t.matches=[],!!P(s)&&s.forEach(r=>{if(!P(r.indices)||!r.indices.length)return;const{indices:n,value:o}=r;let h={indices:n,value:o};r.key&&(h.key=r.key.src),r.idx>-1&&(h.refIndex=r.idx),t.matches.push(h)})}function as(e,t){t.score=e.score}function os(e,t,{includeMatches:s=k.includeMatches,includeScore:r=k.includeScore}={}){const n=[];return s&&n.push(is),r&&n.push(as),e.map(o=>{const{idx:h}=o,a={item:t[h],refIndex:h};return n.length&&n.forEach(g=>{g(o,a)}),a})}class te{constructor(t,s={},r){this.options={...k,...s},this.options.useExtendedSearch,this._keyStore=new On(this.options.keys),this.setCollection(t,r)}setCollection(t,s){if(this._docs=t,s&&!(s instanceof Ie))throw new Error(Tn);this._myIndex=s||it(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){!P(t)||(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const s=[];for(let r=0,n=this._docs.length;r<n;r+=1){const o=this._docs[r];t(o,r)&&(this.removeAt(r),r-=1,n-=1,s.push(o))}return s}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:s=-1}={}){const{includeMatches:r,includeScore:n,shouldSort:o,sortFn:h,ignoreFieldNorm:a}=this.options;let g=U(t)?U(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return rs(g,{ignoreFieldNorm:a}),o&&g.sort(h),Ze(s)&&s>-1&&(g=g.slice(0,s)),os(g,this._docs,{includeMatches:r,includeScore:n})}_searchStringList(t){const s=De(t,this.options),{records:r}=this._myIndex,n=[];return r.forEach(({v:o,i:h,n:a})=>{if(!P(o))return;const{isMatch:g,score:i,indices:d}=s.searchIn(o);g&&n.push({item:o,idx:h,matches:[{score:i,value:o,norm:a,indices:d}]})}),n}_searchLogical(t){const s=dt(t,this.options),r=(a,g,i)=>{if(!a.children){const{keyId:d,searcher:y}=a,E=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(g,d),searcher:y});return E&&E.length?[{idx:i,item:g,matches:E}]:[]}switch(a.operator){case re.AND:{const d=[];for(let y=0,E=a.children.length;y<E;y+=1){const N=a.children[y],I=r(N,g,i);if(I.length)d.push(...I);else return[]}return d}case re.OR:{const d=[];for(let y=0,E=a.children.length;y<E;y+=1){const N=a.children[y],I=r(N,g,i);if(I.length){d.push(...I);break}}return d}}},n=this._myIndex.records,o={},h=[];return n.forEach(({$:a,i:g})=>{if(P(a)){let i=r(s,a,g);i.length&&(o[g]||(o[g]={idx:g,item:a,matches:[]},h.push(o[g])),i.forEach(({matches:d})=>{o[g].matches.push(...d)}))}}),h}_searchObjectList(t){const s=De(t,this.options),{keys:r,records:n}=this._myIndex,o=[];return n.forEach(({$:h,i:a})=>{if(!P(h))return;let g=[];r.forEach((i,d)=>{g.push(...this._findMatches({key:i,value:h[d],searcher:s}))}),g.length&&o.push({idx:a,item:h,matches:g})}),o}_findMatches({key:t,value:s,searcher:r}){if(!P(s))return[];let n=[];if(K(s))s.forEach(({v:o,i:h,n:a})=>{if(!P(o))return;const{isMatch:g,score:i,indices:d}=r.searchIn(o);g&&n.push({score:i,key:t,value:o,idx:h,norm:a,indices:d})});else{const{v:o,n:h}=s,{isMatch:a,score:g,indices:i}=r.searchIn(o);a&&n.push({score:g,key:t,value:o,norm:h,indices:i})}return n}}te.version="6.5.0",te.createIndex=it,te.parseIndex=zn,te.config=k,te.parseQuery=dt,ts(es);const ls={threshold:.5,useExtendedSearch:!0,keys:["name","author","description"]};var ft=(e,t)=>!t||t==""?e:new te(e,ls).search(t).map(s=>s.item);const gt=w.findByDisplayName("SearchBar");var pt=({query:e,onChange:t})=>u.React.createElement(gt,{className:"ysink_stain_searchbar",query:e,onQueryChange:t,placeholder:"Search themes...",size:gt.Sizes.MEDIUM});const{SingleSelect:cs}=w.findByDisplayName("Select",!1);var yt=({filterMode:e,setFilterMode:t})=>u.React.createElement(cs,{options:[{value:0,label:"Show All"},{value:1,label:"CC Only"},{value:2,label:"BD Only"}],value:e,onChange:t,isDisabled:!1,className:"ysink_stain_dropdown"});const us=w.findByDisplayName("FormTitle"),hs=w.findByDisplayName("FormText"),ds=w.findByDisplayName("FormSection"),Oe=w.findByProps("Sizes","Colors","Looks","DropdownSizes");var fs=({goToStore:e})=>u.React.createElement(ds,{className:"ysink_stain_nosplash"},u.React.createElement(us,{tag:"h2"},"No Themes"),u.React.createElement(hs,null,"Paste a link in above, or head over to the store"),u.React.createElement(Oe,{className:"ysink_stain_button",color:Oe.Colors.GREEN,sizes:Oe.Sizes.LARGE,onClick:e},"Get some themes"));const{useState:mt,useReducer:gs}=u.React;var ps=({goTo:e})=>{ne.useNest(x.persist);const[t,s]=mt("");let[r,n]=mt(0);const[,o]=gs(h=>~h,0);return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement(Rn,null),u.React.createElement("div",{className:"ysink_stain_search_row"},u.React.createElement(pt,{query:t,onChange:s}),u.React.createElement(yt,{filterMode:r,setFilterMode:n})),x.persist.ghost.themes.length===0?u.React.createElement(fs,{goToStore:()=>e(1)}):u.React.createElement("div",{className:"ysink_stain_cardcontainer"},ft(x.persist.ghost.themes,t).filter(h=>r===0||r===1&&!h.compat||r===2&&h.compat).map(h=>u.React.createElement(Xe,{theme:h,deleteHook:o}))))},ye=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},_t={};Object.defineProperty(_t,"__esModule",{value:!0});var Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},ys=function(){function e(t,s){for(var r=0;r<s.length;r++){var n=s[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,s,r){return s&&e(t.prototype,s),r&&e(t,r),t}}(),ms=Dt.default,ie=_s(ms);function _s(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}function vs(e,t){var s={};for(var r in e)t.indexOf(r)>=0||!Object.prototype.hasOwnProperty.call(e,r)||(s[r]=e[r]);return s}function Es(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function Ss(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ks=13,xs=9,ws=8,Rs=89,me=90,bs=77,Et=57,St=219,kt=222,xt=192,Cs=27,wt=100,Ms=3e3,Ns="navigator"in ye&&/Win/i.test(navigator.platform),Be="navigator"in ye&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),_e="npm__react-simple-code-editor__textarea",Is=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`+_e+`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`+_e+` {
    color: transparent !important;
  }

  .`+_e+`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`,Rt=function(e){Ss(t,e);function t(){var s,r,n,o;Es(this,t);for(var h=arguments.length,a=Array(h),g=0;g<h;g++)a[g]=arguments[g];return o=(r=(n=vt(this,(s=t.__proto__||Object.getPrototypeOf(t)).call.apply(s,[this].concat(a))),n),n.state={capture:!0},n._recordCurrentState=function(){var i=n._input;if(!!i){var d=i.value,y=i.selectionStart,E=i.selectionEnd;n._recordChange({value:d,selectionStart:y,selectionEnd:E})}},n._getLines=function(i,d){return i.substring(0,d).split(`
`)},n._recordChange=function(i){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=n._history,E=y.stack,N=y.offset;if(E.length&&N>-1){n._history.stack=E.slice(0,N+1);var I=n._history.stack.length;if(I>wt){var T=I-wt;n._history.stack=E.slice(T,I),n._history.offset=Math.max(n._history.offset-T,0)}}var C=Date.now();if(d){var R=n._history.stack[n._history.offset];if(R&&C-R.timestamp<Ms){var c=/[^a-z0-9]([a-z0-9]+)$/i,l=n._getLines(R.value,R.selectionStart).pop().match(c),f=n._getLines(i.value,i.selectionStart).pop().match(c);if(l&&f&&f[1].startsWith(l[1])){n._history.stack[n._history.offset]=Y({},i,{timestamp:C});return}}}n._history.stack.push(Y({},i,{timestamp:C})),n._history.offset++},n._updateInput=function(i){var d=n._input;!d||(d.value=i.value,d.selectionStart=i.selectionStart,d.selectionEnd=i.selectionEnd,n.props.onValueChange(i.value))},n._applyEdits=function(i){var d=n._input,y=n._history.stack[n._history.offset];y&&d&&(n._history.stack[n._history.offset]=Y({},y,{selectionStart:d.selectionStart,selectionEnd:d.selectionEnd})),n._recordChange(i),n._updateInput(i)},n._undoEdit=function(){var i=n._history,d=i.stack,y=i.offset,E=d[y-1];E&&(n._updateInput(E),n._history.offset=Math.max(y-1,0))},n._redoEdit=function(){var i=n._history,d=i.stack,y=i.offset,E=d[y+1];E&&(n._updateInput(E),n._history.offset=Math.min(y+1,d.length-1))},n._handleKeyDown=function(i){var d=n.props,y=d.tabSize,E=d.insertSpaces,N=d.ignoreTabKey,I=d.onKeyDown;if(!(I&&(I(i),i.defaultPrevented))){i.keyCode===Cs&&i.target.blur();var T=i.target,C=T.value,R=T.selectionStart,c=T.selectionEnd,l=(E?" ":"	").repeat(y);if(i.keyCode===xs&&!N&&n.state.capture)if(i.preventDefault(),i.shiftKey){var f=n._getLines(C,R),p=f.length-1,m=n._getLines(C,c).length-1,v=C.split(`
`).map(function(L,Z){return Z>=p&&Z<=m&&L.startsWith(l)?L.substring(l.length):L}).join(`
`);if(C!==v){var b=f[p];n._applyEdits({value:v,selectionStart:b.startsWith(l)?R-l.length:R,selectionEnd:c-(C.length-v.length)})}}else if(R!==c){var S=n._getLines(C,R),D=S.length-1,A=n._getLines(C,c).length-1,O=S[D];n._applyEdits({value:C.split(`
`).map(function(L,Z){return Z>=D&&Z<=A?l+L:L}).join(`
`),selectionStart:/\S/.test(O)?R+l.length:R,selectionEnd:c+l.length*(A-D+1)})}else{var G=R+l.length;n._applyEdits({value:C.substring(0,R)+l+C.substring(c),selectionStart:G,selectionEnd:G})}else if(i.keyCode===ws){var B=R!==c,V=C.substring(0,R);if(V.endsWith(l)&&!B){i.preventDefault();var X=R-l.length;n._applyEdits({value:C.substring(0,R-l.length)+C.substring(c),selectionStart:X,selectionEnd:X})}}else if(i.keyCode===ks){if(R===c){var ve=n._getLines(C,R).pop(),F=ve.match(/^\s+/);if(F&&F[0]){i.preventDefault();var z=`
`+F[0],W=R+z.length;n._applyEdits({value:C.substring(0,R)+z+C.substring(c),selectionStart:W,selectionEnd:W})}}}else if(i.keyCode===Et||i.keyCode===St||i.keyCode===kt||i.keyCode===xt){var $=void 0;i.keyCode===Et&&i.shiftKey?$=["(",")"]:i.keyCode===St?i.shiftKey?$=["{","}"]:$=["[","]"]:i.keyCode===kt?i.shiftKey?$=['"','"']:$=["'","'"]:i.keyCode===xt&&!i.shiftKey&&($=["`","`"]),R!==c&&$&&(i.preventDefault(),n._applyEdits({value:C.substring(0,R)+$[0]+C.substring(R,c)+$[1]+C.substring(c),selectionStart:R,selectionEnd:c+2}))}else(Be?i.metaKey&&i.keyCode===me:i.ctrlKey&&i.keyCode===me)&&!i.shiftKey&&!i.altKey?(i.preventDefault(),n._undoEdit()):(Be?i.metaKey&&i.keyCode===me&&i.shiftKey:Ns?i.ctrlKey&&i.keyCode===Rs:i.ctrlKey&&i.keyCode===me&&i.shiftKey)&&!i.altKey?(i.preventDefault(),n._redoEdit()):i.keyCode===bs&&i.ctrlKey&&(Be?i.shiftKey:!0)&&(i.preventDefault(),n.setState(function(L){return{capture:!L.capture}}))}},n._handleChange=function(i){var d=i.target,y=d.value,E=d.selectionStart,N=d.selectionEnd;n._recordChange({value:y,selectionStart:E,selectionEnd:N},!0),n.props.onValueChange(y)},n._history={stack:[],offset:-1},r),vt(n,o)}return ys(t,[{key:"componentDidMount",value:function(){this._recordCurrentState()}},{key:"render",value:function(){var r=this,n=this.props,o=n.value,h=n.style,a=n.padding,g=n.highlight,i=n.textareaId,d=n.textareaClassName,y=n.autoFocus,E=n.disabled,N=n.form,I=n.maxLength,T=n.minLength,C=n.name,R=n.placeholder,c=n.readOnly,l=n.required,f=n.onClick,p=n.onFocus,m=n.onBlur,v=n.onKeyUp;n.onKeyDown,n.onValueChange,n.tabSize,n.insertSpaces,n.ignoreTabKey;var b=n.preClassName,S=vs(n,["value","style","padding","highlight","textareaId","textareaClassName","autoFocus","disabled","form","maxLength","minLength","name","placeholder","readOnly","required","onClick","onFocus","onBlur","onKeyUp","onKeyDown","onValueChange","tabSize","insertSpaces","ignoreTabKey","preClassName"]),D={paddingTop:a,paddingRight:a,paddingBottom:a,paddingLeft:a},A=g(o);return ie.createElement("div",Y({},S,{style:Y({},ae.container,h)}),ie.createElement("textarea",{ref:function(G){return r._input=G},style:Y({},ae.editor,ae.textarea,D),className:_e+(d?" "+d:""),id:i,value:o,onChange:this._handleChange,onKeyDown:this._handleKeyDown,onClick:f,onKeyUp:v,onFocus:p,onBlur:m,disabled:E,form:N,maxLength:I,minLength:T,name:C,placeholder:R,readOnly:c,required:l,autoFocus:y,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),ie.createElement("pre",Y({className:b,"aria-hidden":"true",style:Y({},ae.editor,ae.highlight,D)},typeof A=="string"?{dangerouslySetInnerHTML:{__html:A+"<br />"}}:{children:A})),ie.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:Is}}))}},{key:"session",get:function(){return{history:this._history}},set:function(r){this._history=r.history}}]),t}(ie.Component);Rt.defaultProps={tabSize:2,insertSpaces:!0,ignoreTabKey:!1,padding:0};var Ts=_t.default=Rt,ae={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}},$e={exports:{}};(function(e){var t=typeof window!="undefined"?window:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var s=function(r){var n=/\blang(?:uage)?-([\w-]+)\b/i,o=0,h={},a={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function c(l){return l instanceof g?new g(l.type,c(l.content),l.alias):Array.isArray(l)?l.map(c):l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(c){return Object.prototype.toString.call(c).slice(8,-1)},objId:function(c){return c.__id||Object.defineProperty(c,"__id",{value:++o}),c.__id},clone:function c(l,f){f=f||{};var p,m;switch(a.util.type(l)){case"Object":if(m=a.util.objId(l),f[m])return f[m];p={},f[m]=p;for(var v in l)l.hasOwnProperty(v)&&(p[v]=c(l[v],f));return p;case"Array":return m=a.util.objId(l),f[m]?f[m]:(p=[],f[m]=p,l.forEach(function(b,S){p[S]=c(b,f)}),p);default:return l}},getLanguage:function(c){for(;c&&!n.test(c.className);)c=c.parentElement;return c?(c.className.match(n)||[,"none"])[1].toLowerCase():"none"},currentScript:function(){if(typeof document=="undefined")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(p){var c=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(p.stack)||[])[1];if(c){var l=document.getElementsByTagName("script");for(var f in l)if(l[f].src==c)return l[f]}return null}},isActive:function(c,l,f){for(var p="no-"+l;c;){var m=c.classList;if(m.contains(l))return!0;if(m.contains(p))return!1;c=c.parentElement}return!!f}},languages:{plain:h,plaintext:h,text:h,txt:h,extend:function(c,l){var f=a.util.clone(a.languages[c]);for(var p in l)f[p]=l[p];return f},insertBefore:function(c,l,f,p){p=p||a.languages;var m=p[c],v={};for(var b in m)if(m.hasOwnProperty(b)){if(b==l)for(var S in f)f.hasOwnProperty(S)&&(v[S]=f[S]);f.hasOwnProperty(b)||(v[b]=m[b])}var D=p[c];return p[c]=v,a.languages.DFS(a.languages,function(A,O){O===D&&A!=c&&(this[A]=v)}),v},DFS:function c(l,f,p,m){m=m||{};var v=a.util.objId;for(var b in l)if(l.hasOwnProperty(b)){f.call(l,b,l[b],p||b);var S=l[b],D=a.util.type(S);D==="Object"&&!m[v(S)]?(m[v(S)]=!0,c(S,f,null,m)):D==="Array"&&!m[v(S)]&&(m[v(S)]=!0,c(S,f,b,m))}}},plugins:{},highlightAll:function(c,l){a.highlightAllUnder(document,c,l)},highlightAllUnder:function(c,l,f){var p={callback:f,container:c,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};a.hooks.run("before-highlightall",p),p.elements=Array.prototype.slice.apply(p.container.querySelectorAll(p.selector)),a.hooks.run("before-all-elements-highlight",p);for(var m=0,v;v=p.elements[m++];)a.highlightElement(v,l===!0,p.callback)},highlightElement:function(c,l,f){var p=a.util.getLanguage(c),m=a.languages[p];c.className=c.className.replace(n,"").replace(/\s+/g," ")+" language-"+p;var v=c.parentElement;v&&v.nodeName.toLowerCase()==="pre"&&(v.className=v.className.replace(n,"").replace(/\s+/g," ")+" language-"+p);var b=c.textContent,S={element:c,language:p,grammar:m,code:b};function D(O){S.highlightedCode=O,a.hooks.run("before-insert",S),S.element.innerHTML=S.highlightedCode,a.hooks.run("after-highlight",S),a.hooks.run("complete",S),f&&f.call(S.element)}if(a.hooks.run("before-sanity-check",S),v=S.element.parentElement,v&&v.nodeName.toLowerCase()==="pre"&&!v.hasAttribute("tabindex")&&v.setAttribute("tabindex","0"),!S.code){a.hooks.run("complete",S),f&&f.call(S.element);return}if(a.hooks.run("before-highlight",S),!S.grammar){D(a.util.encode(S.code));return}if(l&&r.Worker){var A=new Worker(a.filename);A.onmessage=function(O){D(O.data)},A.postMessage(JSON.stringify({language:S.language,code:S.code,immediateClose:!0}))}else D(a.highlight(S.code,S.grammar,S.language))},highlight:function(c,l,f){var p={code:c,grammar:l,language:f};return a.hooks.run("before-tokenize",p),p.tokens=a.tokenize(p.code,p.grammar),a.hooks.run("after-tokenize",p),g.stringify(a.util.encode(p.tokens),p.language)},tokenize:function(c,l){var f=l.rest;if(f){for(var p in f)l[p]=f[p];delete l.rest}var m=new y;return E(m,m.head,c),d(c,m,l,m.head,0),I(m)},hooks:{all:{},add:function(c,l){var f=a.hooks.all;f[c]=f[c]||[],f[c].push(l)},run:function(c,l){var f=a.hooks.all[c];if(!(!f||!f.length))for(var p=0,m;m=f[p++];)m(l)}},Token:g};r.Prism=a;function g(c,l,f,p){this.type=c,this.content=l,this.alias=f,this.length=(p||"").length|0}g.stringify=function c(l,f){if(typeof l=="string")return l;if(Array.isArray(l)){var p="";return l.forEach(function(D){p+=c(D,f)}),p}var m={type:l.type,content:c(l.content,f),tag:"span",classes:["token",l.type],attributes:{},language:f},v=l.alias;v&&(Array.isArray(v)?Array.prototype.push.apply(m.classes,v):m.classes.push(v)),a.hooks.run("wrap",m);var b="";for(var S in m.attributes)b+=" "+S+'="'+(m.attributes[S]||"").replace(/"/g,"&quot;")+'"';return"<"+m.tag+' class="'+m.classes.join(" ")+'"'+b+">"+m.content+"</"+m.tag+">"};function i(c,l,f,p){c.lastIndex=l;var m=c.exec(f);if(m&&p&&m[1]){var v=m[1].length;m.index+=v,m[0]=m[0].slice(v)}return m}function d(c,l,f,p,m,v){for(var b in f)if(!(!f.hasOwnProperty(b)||!f[b])){var S=f[b];S=Array.isArray(S)?S:[S];for(var D=0;D<S.length;++D){if(v&&v.cause==b+","+D)return;var A=S[D],O=A.inside,G=!!A.lookbehind,B=!!A.greedy,V=A.alias;if(B&&!A.pattern.global){var X=A.pattern.toString().match(/[imsuy]*$/)[0];A.pattern=RegExp(A.pattern.source,X+"g")}for(var ve=A.pattern||A,F=p.next,z=m;F!==l.tail&&!(v&&z>=v.reach);z+=F.value.length,F=F.next){var W=F.value;if(l.length>c.length)return;if(!(W instanceof g)){var $=1,L;if(B){if(L=i(ve,z,c,G),!L)break;var Ee=L.index,Z=L.index+L[0].length,q=z;for(q+=F.value.length;Ee>=q;)F=F.next,q+=F.value.length;if(q-=F.value.length,z=q,F.value instanceof g)continue;for(var ce=F;ce!==l.tail&&(q<Z||typeof ce.value=="string");ce=ce.next)$++,q+=ce.value.length;$--,W=c.slice(z,q),L.index-=z}else if(L=i(ve,0,W,G),!L)continue;var Ee=L.index,Se=L[0],Ue=W.slice(0,Ee),Nt=W.slice(Ee+Se.length),We=z+W.length;v&&We>v.reach&&(v.reach=We);var ke=F.prev;Ue&&(ke=E(l,ke,Ue),z+=Ue.length),N(l,ke,$);var or=new g(b,O?a.tokenize(Se,O):Se,V,Se);if(F=E(l,ke,or),Nt&&E(l,F,Nt),$>1){var je={cause:b+","+D,reach:We};d(c,l,f,F.prev,z,je),v&&je.reach>v.reach&&(v.reach=je.reach)}}}}}}function y(){var c={value:null,prev:null,next:null},l={value:null,prev:c,next:null};c.next=l,this.head=c,this.tail=l,this.length=0}function E(c,l,f){var p=l.next,m={value:f,prev:l,next:p};return l.next=m,p.prev=m,c.length++,m}function N(c,l,f){for(var p=l.next,m=0;m<f&&p!==c.tail;m++)p=p.next;l.next=p,p.prev=l,c.length-=m}function I(c){for(var l=[],f=c.head.next;f!==c.tail;)l.push(f.value),f=f.next;return l}if(!r.document)return r.addEventListener&&(a.disableWorkerMessageHandler||r.addEventListener("message",function(c){var l=JSON.parse(c.data),f=l.language,p=l.code,m=l.immediateClose;r.postMessage(a.highlight(p,a.languages[f],f)),m&&r.close()},!1)),a;var T=a.util.currentScript();T&&(a.filename=T.src,T.hasAttribute("data-manual")&&(a.manual=!0));function C(){a.manual||a.highlightAll()}if(!a.manual){var R=document.readyState;R==="loading"||R==="interactive"&&T&&T.defer?document.addEventListener("DOMContentLoaded",C):window.requestAnimationFrame?window.requestAnimationFrame(C):window.setTimeout(C,16)}return a}(t);e.exports&&(e.exports=s),typeof ye!="undefined"&&(ye.Prism=s)})($e),function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var s=e.languages.markup;s&&(s.tag.addInlined("style","css"),s.tag.addAttribute("style","css"))}(Prism);const As=w.findByProps("contentColumn").contentColumn,{useState:Ds,useCallback:Fs}=u.React;var Ls=()=>{const[e,t]=Ds(x.persist.ghost.quickCSS),s=n=>{x.persist.store.quickCSS=n,x.reloadCSS()},r=Fs(_.throttle(s,250,{leading:!0,trailing:!0}),[]);return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement("div",{class:"ysink_stain_quickcss"},u.React.createElement(Ts,{className:"ysink_stain_editorroot",value:e??"",onValueChange:n=>{t(n),r(n)},highlight:n=>$e.exports.highlight(n,$e.exports.languages.css),padding:10}),u.React.createElement("link",{href:"https://cdn.jsdelivr.net/gh/PrismJS/prism-themes@master/themes/prism-atom-dark.css",rel:"stylesheet"}),u.React.createElement("style",null,`:root { --background-primary: #1d1f21; } .theme-light .${As} { --text-normal: white; }`)))};const Os=w.findByDisplayName("FormTitle"),Bs=w.findByDisplayName("FormText"),$s=w.findByDisplayName("FormSection"),Pe=w.findByProps("Sizes","Colors","Looks","DropdownSizes");var Ps=({})=>u.React.createElement($s,{className:"ysink_stain_nosplash"},u.React.createElement(Os,{tag:"h2"},"No Repos"),u.React.createElement(Bs,null,"Add one in the repo manager!"),u.React.createElement(Pe,{className:"ysink_stain_button",color:Pe.Colors.GREEN,sizes:Pe.Sizes.LARGE,onClick:Ve},"Open repo manager"));const{useState:oe,useEffect:zs,useReducer:Ks}=u.React,Us=()=>Promise.all(x.persist.ghost.repos.map(fe)),Ws=e=>e.flatMap(t=>t.themes);async function js(){let e=await Us();return{repos:e,themes:Ws(e)}}const Hs=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((s,r)=>s===t[r]);var Ys=()=>{ne.useNest(x.persist);const[e,t]=oe(""),[s,r]=oe([]),[n,o]=oe(void 0),[h,a]=oe(void 0),[g,i]=oe(0);zs(()=>{let y=()=>js().then(({repos:E,themes:N})=>{o(E),a(N)});Hs(s,x.persist.ghost.repos)||(r(x.persist.ghost.repos),y()),(!n||!h)&&y()});const[,d]=Ks(y=>~y,0);return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement("div",{className:"ysink_stain_search_row"},u.React.createElement(pt,{query:e,onChange:t}),u.React.createElement(yt,{filterMode:g,setFilterMode:i})),x.persist.ghost.repos.length===0?u.React.createElement(Ps,null):u.React.createElement("div",{className:"ysink_stain_cardcontainer"},ft(h??[],e).filter(y=>g===0||g===1&&!y.compat||g===2&&y.compat).map(y=>u.React.createElement(Xe,{theme:y,deleteHook:d}))))};const Gs=w.findByDisplayName("FormTitle"),Vs=w.findByDisplayName("FormSection");w.findByDisplayName("FormText");const qs=w.findByDisplayName("Flex"),ze=w.findByProps("Sizes","Colors","Looks","DropdownSizes");var Qs=()=>u.React.createElement(ee.ErrorBoundary,null,u.React.createElement(Vs,null,u.React.createElement(qs,{basis:"auto",grow:1,shrink:1,className:"ysink_stain_row"},u.React.createElement(Gs,{tag:"h1"},"Cumstain Settings"),u.React.createElement(ze,{className:"ysink_stain_button",color:ze.Colors.GREEN,sizes:ze.Sizes.LARGE,onClick:Ve},"Repo Manager")),u.React.createElement(hn,{items:[{text:"Installed",component:ps},{text:"Store",component:Ys},{text:"Quick CSS",component:Ls}]}))),Js=()=>ue.after("getPredicateSections",w.findByDisplayName("SettingsView").prototype,(e,t)=>{if(t[1]?.section!="My Account")return;let s=t.findIndex(r=>r.section=="CUMCORD_PLUGINS")+1;return t.splice(s,0,{section:"ysink_stain_CUMSTAIN",label:"Themes",element:Qs}),t}),Xs=()=>cumcord.patcher.injectCSS(".ysink_stain_tabbar{padding:.5rem 1rem;display:grid;grid-auto-flow:column;grid-auto-columns:7rem}.ysink_stain_tabbar .ysink_stain_button *{cursor:pointer}.ysink_stain_tabbar>*{margin-right:1rem;padding:.2rem;border-radius:.3rem;min-width:5rem;text-align:center;background:none}.theme-dark .ysink_stain_tabbar>*.ysink_stain_selected{background:#fff4}.theme-light .ysink_stain_tabbar>*.ysink_stain_selected{background:#0003}.ysink_stain_tabbar>*:last-child{margin-right:0}.ysink_stain_cardcontainer{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.ysink_stain_card{padding:1rem;border:1px solid var(--background-modifier-accent);border-radius:.5rem;display:flex;flex-direction:column;z-index:1;background-color:var(--deprecated-card-bg)}.ysink_stain_card .ysink_stain_title{font-size:1rem;padding-top:.2rem;display:inline;flex:1;margin:0}.ysink_stain_card .ysink_stain_button{display:inline;padding:0}.ysink_stain_card .ysink_stain_button>div{padding:2px 16px}.ysink_stain_card .ysink_stain_row{display:flex;margin-bottom:.5rem}.ysink_stain_card .ysink_stain_author_licence{font-style:italic}.ysink_stain_card .ysink_stain_desc{flex:1}.ysink_stain_card .ysink_stain_carousel{margin-bottom:1rem}.ysink_stain_card .ysink_stain_carousel>div:not(.ysink_stain_noimg)>:last-child,.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg>div>:last-child{height:2.25rem}.ysink_stain_card .ysink_stain_carousel>div{border-radius:.5rem}.theme-dark .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:#0005}.theme-light .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:#000d}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg{display:grid}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div{grid-area:1/1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div:not(.ysink_stain_noimgtxt){visibility:hidden;z-index:-1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div.ysink_stain_noimgtxt{grid-area:1/1;font-size:1.5rem;text-align:center;padding-top:35%;text-transform:uppercase;opacity:.8}.ysink_stain_divide{margin:0 0 1rem}.ysink_stain_modal .ysink_stain_divide{margin:.5rem 0}.ysink_stain_card .ysink_stain_divide{margin:.2rem 0}.ysink_stain_delete{margin-right:.5rem;fill:var(--interactive-normal)}.ysink_stain_installbar{display:flex}.ysink_stain_installbar>*{flex:1}.ysink_stain_installbar>:last-child{flex:unset;margin-left:1rem}.ysink_stain_searchbar{margin:.75rem 0}.ysink_stain_search_row{display:flex;gap:.75rem;margin:.75rem 0}.ysink_stain_search_row .ysink_stain_dropdown{height:2.25rem;flex-basis:10rem;padding-top:.3rem}.ysink_stain_search_row .ysink_stain_searchbar{margin:unset;flex:1}.ysink_stain_editorroot{background:tranparent;color:#c5c8c6;font-family:var(--font-code);font-size:.9rem;line-height:1.1rem}.ysink_stain_badge{width:1.5rem;height:1.5rem;margin-right:.5rem;border-radius:50%}.ysink_stain_badge.ysink_stain_bd{padding:.25rem;background:#040405}.ysink_stain_badge.ysink_stain_cc{padding:.1rem;background:#f8f8f8;background:#7289DA}.ysink_stain_nosplash{display:flex;flex-direction:column;align-items:center;margin-top:15rem;gap:.5rem}.ysink_stain_nosplash h2{margin-bottom:0}.ysink_stain_nosplash>*{flex:0}.ysink_stain_nosplash .ysink_stain_button{margin-top:2rem}.ysink_stain_modal .ysink_stain_row{display:flex}.ysink_stain_modal .ysink_stain_row>*{flex:1}.ysink_stain_modal .ysink_stain_row>:last-child{flex:unset;margin-left:1rem}"),Zs=()=>{const e=ue.injectCSS(M.default.persist.ghost.quickCSS);return M.default.reloadCSS=()=>e(M.default.persist.ghost.quickCSS),()=>{e(),M.default.reloadCSS=void 0,delete M.default.reloadCSS}};const bt=async()=>{se.log("|| CUMSTAIN || Started periodic theme update check");const t=(await Promise.all(x.persist.ghost.repos.map(fe))).flatMap(s=>s.themes);for(let s=0;s<x.persist.ghost.themes.length;s++){const r=x.persist.ghost.themes[s],n=t.find(o=>o.id===r.id);if(n)x.persist.ghost.themes[s]=n;else{const o=await de(r.url).catch(()=>{});o&&(x.persist.ghost.themes[s]=o)}x.persist.store.themes[s].enabled=r.enabled,r.enabled&&x.state.ghost.unpatchCache.get(r.id)?.(x.persist.ghost.themes[s].CSS),se.log(`|| CUMSTAIN || Updated theme ${x.persist.ghost.themes[s].name}`)}se.log("|| CUMSTAIN || Completed periodic theme update check")};var er=()=>{setTimeout(bt,10);const e=setInterval(bt,6e5);return()=>clearInterval(e)};const Ke=w.findByDisplayName("Text");var tr=()=>ue.after("default",w.findByDisplayName("ClientDebugInfo",!1),(e,t)=>(t.props.children.push(u.React.createElement(Ke,{color:Ke.Colors.MUTED,tag:"span",size:Ke.Sizes.SIZE_12},["cumstain"," ","pre0.2"," "])),t));const le=e=>x.persist.ghost.themes.find(t=>t.id===e),Ct=e=>!!le(e)?.enabled,Mt=e=>Ct(e.id)?Ft(e):he(e),nr=async e=>Mt(await de(e)),sr=e=>He(le(e)),rr=e=>{if(!le(e))throw new Error(`Theme with ID ${e} was not installed`);Ct(e)?Re(le(e)):Mt(le(e))},J=()=>{for(const e in window.cumstain.installed.ghost)window.cumstain.installed.store[e]=void 0,delete window.cumstain.installed.store[e];for(const e of x.persist.ghost.themes)window.cumstain.installed.store[e.id]={enabled:e.enabled,css:e.CSS,manifest:e};for(const[e,t]of Object.entries(window.cumstain.installed.ghost))t.enabled?window.cumstain.enabled.store[e]=t:(window.cumstain.enabled.store[e]=void 0,delete window.cumstain.enabled.store[e])};var ir=()=>(window.cumstain={installed:j.nests.make({}),enabled:j.nests.make({}),importTheme:nr,removeTheme:sr,toggleTheme:rr},J(),x.persist.on(j.nests.Events.UPDATE,J),x.persist.on(j.nests.Events.SET,J),x.persist.on(j.nests.Events.DELETE,J),se.log("|| CUMSTAIN || Initialised window.cumstain API"),()=>{x.persist.off(j.nests.Events.UPDATE,J),x.persist.off(j.nests.Events.SET,J),x.persist.off(j.nests.Events.DELETE,J),window.cumstain=void 0,delete window.cumstain,se.log("|| CUMSTAIN || Disposed window.cumstain API")}),ar=({persist:e})=>{let t=[];return Array.isArray(e.ghost.repos)||(e.store.repos=[]),{onLoad:async()=>{t.push(tr(),Xs(),Bt(),Ot(),Zs(),Js(),er(),ir())},onUnload:()=>t.reduceRight((s,r)=>r?.(),null)}};return ar})(cumcord.pluginData,cumcord.patcher,cumcord.modules.internal.nests,cumcord.modules.webpack,cumcord.ui.components,cumcord.utils,cumcord.ui.toasts,cumcord.modules.common,cumcord.modules.common.React,cumcord.utils.logger,cumcord.modules.internal);
