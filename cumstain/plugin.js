(function(N,ce,At,x,ee,ne,ke,u,It,j,He){"use strict";function xe(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var M=xe(N),Tt=xe(At),Dt=xe(It);const Lt=/[^\S\r\n]*?\r?\n[^\S\r\n]*?\*[^\S\r\n]?/,Ft=/^\\@/;function Ot(e){try{return JSON.parse(e)}catch{}}function Bt(e){const t=e.split(`
`)[0];if(t.includes("//META"))return $t(e);if(t.includes("/**"))return Pt(e);throw new Error("META was not found.")}function $t(e){const t=e.split(`
`)[0],n=t.substring(t.lastIndexOf("//META")+6,t.lastIndexOf("*//")),r=Ot(n);if(!r)throw new Error("META could not be parsed.");if(!r.name)throw new Error("META missing name data.");return r}function Pt(e){const t=e.split("/**",2)[1].split("*/",1)[0],n={};let r="",s="";for(const l of t.split(Lt))if(l.length!==0)if(l.charAt(0)==="@"&&l.charAt(1)!==" "){n[r]=s;const h=l.indexOf(" ");r=l.substr(1,h-1),s=l.substr(h+1)}else s+=" "+l.replace("\\n",`
`).replace(Ft,"@");return n[r]=s.trim(),delete n[""],n}const se={};async function zt(e,t){const n=new URL(e,t).href,r=se[n]??await(await fetch(n)).text();return se[n]=r,{url:n,CSS:()=>Promise.resolve(r),compat:!0,repoUrl:t,...Bt(r)}}async function Kt(e,t){const n=new URL(e,t).href;let r=new URL(e,t).pathname.split("/");r.splice(r.length-1,1,"cumcord_theme.json");const s=new URL(r.join("/"),new URL(e,t).origin),l=await(await fetch(s.href)).json();return{url:n,compat:!1,...l,repoUrl:t,CSS:async()=>{if(se[n])return se[n];const h=await(await fetch(n)).text();return se[n]=h,h}}}var ue=async(e,t)=>{try{return await Kt(e,t)}catch(n){try{return await zt(e,t)}catch(r){let s=new Error("Failed to fetch theme - both CC and BD either failed to fetch or failed to parse");throw s.e1=n,s.e2=r,s}}};async function he(e){if(!e?.url||!await e.CSS())throw new Error("theme was missing either id or css.");const t=ce.injectCSS(await e.CSS());M.default.state.ghost.unpatchCache.set(e.url,t);const n=M.default.persist.ghost.themes.findIndex(s=>s.url===e.url);let r={...e};delete r.CSS,r.enabled=!0,n===-1?M.default.persist.ghost.themes.push(r):M.default.persist.ghost.themes[n]=r,M.default.persist.store.themes=M.default.persist.ghost.themes}function we(e){if(!e?.url)throw new Error("theme was missing id.");M.default.state.ghost.unpatchCache.get(e.url)?.(),M.default.state.ghost.unpatchCache.delete(e.url);const n=M.default.persist.ghost.themes.findIndex(s=>s.url===e.url);let r={...e};r.enabled=!1,n===-1?M.default.persist.ghost.themes.push(r):M.default.persist.ghost.themes[n]=r,M.default.persist.store.themes=M.default.persist.ghost.themes}function Ye(e){try{we(e)}catch(t){if(t.message!=="theme was not loaded.")throw t}M.default.persist.store.themes=M.default.persist.ghost.themes.filter(t=>t.url!==e.url)}async function Ut(e){M.default.state.ghost.unpatchCache.get(e.url)?.(await e.CSS());let n={...e};n.enabled=!0;const r=M.default.persist.ghost.themes.findIndex(s=>s.url===e.url);r!==-1&&(M.default.persist.ghost.themes[r]=n,M.default.persist.store.themes=M.default.persist.ghost.themes)}function Wt(){M.default.state.ghost.unpatchCache.forEach(e=>e?.()),M.default.state.ghost.unpatchCache.clear()}var jt=()=>(N.persist.ghost.themes&&N.persist.ghost.themes.filter(e=>e.enabled).forEach(async e=>he(await ue(e.url,e.repoUrl))),Wt),Ht=()=>(M.default.persist.ghost.repos||(M.default.persist.store.repos=[]),M.default.persist.ghost.themes||(M.default.persist.store.themes=[]),M.default.state=Tt.default.make({unpatchCache:new Map}),()=>{M.default.state=void 0,delete M.default.state});async function Yt(e){const t=new URL("repo.json",e).href,n=await(await fetch(t)).json();if(!n.themes||n.themes?.length===0)throw new Error("No themes found in repo");if(!n.meta)throw new Error("No repo metadata");if(!n?.meta.name)throw new Error("Repo did not have a name");return n}var Re=async e=>{const t=await Yt(e),n=await Promise.all(t.themes.map(r=>ue(r,e)));return{manifest:t,themes:n}};const{useEffect:Gt}=u.React,Vt=x.findByDisplayName("FormTitle"),qt=x.findByDisplayName("FormText");x.findByDisplayName("FormDivider");const Ge=x.findByProps("Sizes","Colors","Looks","DropdownSizes");var Qt=({repo:e})=>{const[t,n]=u.React.useState(void 0);return Gt(async()=>{t||n(await Re(e))}),u.React.createElement("div",{className:"ysink_stain_card ysink_stain_repocard"},u.React.createElement("div",{className:"ysink_stain_row"},u.React.createElement("div",null,u.React.createElement(Vt,{tag:"p",className:"ysink_stain_title"},t?.manifest.meta.name),u.React.createElement(qt,null,e)),u.React.createElement(Ge,{color:Ge.Colors.RED,className:"ysink_stain_button",onClick:()=>N.persist.store.repos=N.persist.ghost.repos.filter(r=>r!=e)},"Remove Repo")))};const{useState:Jt}=u.React,de=x.findByProps("ModalCloseButton"),Ve=x.findByProps("Sizes","Tags"),be=x.findByDisplayName("Flex"),{openModal:Xt}=x.findByProps("openModalLazy"),Zt=x.findByDisplayName("FormSection"),en=x.findByDisplayName("FormDivider"),tn=x.findByDisplayName("TextInput"),nn=x.findByProps("Sizes","Colors","Looks","DropdownSizes");async function sn(e){try{return await Re(e),!0}catch{return!1}}const Ce=e=>ke.showToast({title:e,duration:5e3});async function rn(e){if(e.endsWith("/")||(e+="/"),N.persist.ghost.repos.find(t=>t.url==e)!==void 0)return Ce("You already have this repo!"),!1;if(await sn(e)){let t=N.persist.ghost.repos;return e.split("/"),t.push(e),N.persist.store.repos=t,Ce("Added repo"),!0}else return Ce("Repo was invalid"),!1}const an=({e})=>{const[t,n]=Jt("");return ne.useNest(N.persist),u.React.createElement(ee.ErrorBoundary,null,u.React.createElement(de.ModalRoot,{transitionState:e.transitionState,size:"large",className:"ysink_stain_modal"},u.React.createElement(de.ModalHeader,{separator:!1},u.React.createElement(be.Child,{basis:"auto",grow:1,shrink:1,wrap:!1},u.React.createElement(Ve,{tag:"h2",size:Ve.Sizes.SIZE_20},"Repo Manager")),u.React.createElement(be.Child,{basis:"auto",grow:0,shrink:1,wrap:!1},u.React.createElement(de.ModalCloseButton,{onClick:e.onClose}))),u.React.createElement(de.ModalContent,null,u.React.createElement(Zt,null,u.React.createElement(be,{basis:"auto",grow:1,shrink:1,className:"ysink_stain_row"},u.React.createElement(tn,{className:"ysink_stain_input",placeholder:"https://example.com/repo",type:"text",value:t,onChange:r=>n(r)}),u.React.createElement(nn,{className:"ysink_stain_button",onClick:async()=>{await rn(t)&&n("")}},"Add")),u.React.createElement(en,{className:"ysink_stain_divide"}),N.persist.ghost.repos.map(r=>u.React.createElement(Qt,{repo:r}))))))};var qe=()=>Xt(e=>u.React.createElement(an,{e}));const on=u.React.useState,ln=u.React.createElement,cn=x.findByDisplayName("FormText"),un=x.findByDisplayName("FormDivider");var hn=({items:e})=>{let[t,n]=on(0);return u.React.createElement("div",{className:"ysink_stain_tabbar_root"},u.React.createElement("div",{className:"ysink_stain_tabbar"},e.map((r,s)=>u.React.createElement("button",{className:"ysink_stain_button"+(s===t?" ysink_stain_selected":""),onClick:()=>n(s)},u.React.createElement(cn,null,r.text)))),u.React.createElement(un,{className:"ysink_stain_divide"}),u.React.createElement("div",{className:"ysink_stain_tabbar_content"},ln(e[t].component,{goTo:n})))},dn=()=>u.React.createElement("img",{src:"https://betterdiscord.app/resources/branding/logo_small.svg",className:"ysink_stain_badge ysink_stain_bd"}),fn=()=>u.React.createElement("img",{src:"https://avatars.githubusercontent.com/u/81397549",className:"ysink_stain_badge ysink_stain_cc"}),gn=({theme:e,onClick:t})=>u.React.createElement("svg",{onClick:t,className:"ysink_stain_delete",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px"},u.React.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),u.React.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),u.React.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}));const pn=x.findByDisplayName("FormText"),Qe=x.findByDisplayName("SmallMediaCarousel");var yn=({media:e})=>u.React.createElement("div",{class:"ysink_stain_carousel"},e?u.React.createElement(Qe,{items:(typeof e=="string"?[e]:e).map(t=>({type:1,src:t})),autoplayInterval:5e3}):u.React.createElement("div",{className:"ysink_stain_noimg"},u.React.createElement(pn,{className:"ysink_stain_noimgtxt"},"No Image"),u.React.createElement(Qe,{items:[{type:1,src:""}]})));const mn=x.findByDisplayName("FormTitle"),Je=x.findByDisplayName("FormText"),_n=x.findByDisplayName("FormSection"),vn=x.findByDisplayName("FormDivider"),En=x.findByDisplayName("Switch"),Xe=e=>{for(const t of N.persist.ghost.themes)if(t.url===e&&t.enabled)return!0;return!1},Sn=e=>N.persist.ghost.themes.some(t=>t.url===e);var Ze=({theme:e,deleteHook:t})=>(ne.useNest(N.persist),u.React.createElement("div",{className:"ysink_stain_card"},u.React.createElement(_n,null,u.React.createElement(yn,{media:e.media}),u.React.createElement("div",{className:"ysink_stain_row"},e.compat?u.React.createElement(dn,null):u.React.createElement(fn,null),u.React.createElement(mn,{tag:"p",className:"ysink_stain_title"},e.name),Sn(e.url)?u.React.createElement(gn,{theme:e,onClick:()=>{Ye(e),t?.()}}):[],u.React.createElement(En,{checked:Xe(e.url),onChange:()=>Xe(e.url)?we(e):he(e)})),u.React.createElement(Je,{className:"ysink_stain_desc"},e.description),u.React.createElement(vn,{className:"ysink_stain_divide"}),u.React.createElement(Je,{className:"ysink_stain_author_licence"},e.author?`by ${e.author} `:"",e.license?`under ${e.license}`:""))));const{useState:kn}=u.React,xn=x.findByProps("Sizes","Colors","Looks","DropdownSizes"),wn=x.findByDisplayName("TextInput");var Rn=()=>{ne.useNest(N.persist);let[e,t]=kn("");return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement("div",{className:"ysink_stain_installbar"},u.React.createElement(wn,{className:"ysink_stain_input",placeholder:"Theme import URL",type:"text",value:e,onChange:n=>t(n)}),u.React.createElement(xn,{className:"ysink_stain_button",onClick:()=>{ue(e).then(async n=>{await he(n),ke.showToast({title:`Loaded theme ${n.name}`,duration:5e3})},()=>ke.showToast({title:"Failed to fetch theme - check URL",duration:5e3})),t("")}},"Install")))};function K(e){return Array.isArray?Array.isArray(e):nt(e)==="[object Array]"}const bn=1/0;function Cn(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-bn?"-0":t}function Mn(e){return e==null?"":Cn(e)}function U(e){return typeof e=="string"}function et(e){return typeof e=="number"}function Nn(e){return e===!0||e===!1||An(e)&&nt(e)=="[object Boolean]"}function tt(e){return typeof e=="object"}function An(e){return tt(e)&&e!==null}function P(e){return e!=null}function Me(e){return!e.trim().length}function nt(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const lr="Extended search is not available",In="Incorrect 'index' type",Tn=e=>`Invalid value for key ${e}`,Dn=e=>`Pattern length exceeds max of ${e}.`,Ln=e=>`Missing ${e} property in key`,Fn=e=>`Property 'weight' in key '${e}' must be a positive integer`,st=Object.prototype.hasOwnProperty;class On{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(r=>{let s=rt(r);n+=s.weight,this._keys.push(s),this._keyMap[s.id]=s,n+=s.weight}),this._keys.forEach(r=>{r.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function rt(e){let t=null,n=null,r=null,s=1;if(U(e)||K(e))r=e,t=at(e),n=Ne(e);else{if(!st.call(e,"name"))throw new Error(Ln("name"));const l=e.name;if(r=l,st.call(e,"weight")&&(s=e.weight,s<=0))throw new Error(Fn(l));t=at(l),n=Ne(l)}return{path:t,id:n,weight:s,src:r}}function at(e){return K(e)?e:e.split(".")}function Ne(e){return K(e)?e.join("."):e}function Bn(e,t){let n=[],r=!1;const s=(l,h,i)=>{if(!!P(l))if(!h[i])n.push(l);else{let g=h[i];const a=l[g];if(!P(a))return;if(i===h.length-1&&(U(a)||et(a)||Nn(a)))n.push(Mn(a));else if(K(a)){r=!0;for(let d=0,m=a.length;d<m;d+=1)s(a[d],h,i+1)}else h.length&&s(a,h,i+1)}};return s(e,U(t)?t.split("."):t,0),r?n:n[0]}var k={...{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:Bn,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const $n=/[^ ]+/g;function Pn(e=1,t=3){const n=new Map,r=Math.pow(10,t);return{get(s){const l=s.match($n).length;if(n.has(l))return n.get(l);const h=1/Math.pow(l,.5*e),i=parseFloat(Math.round(h*r)/r);return n.set(l,i),i},clear(){n.clear()}}}class Ae{constructor({getFn:t=k.getFn,fieldNormWeight:n=k.fieldNormWeight}={}){this.norm=Pn(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,U(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){const n=this.size();U(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!P(t)||Me(t))return;let r={v:t,i:n,n:this.norm.get(t)};this.records.push(r)}_addObject(t,n){let r={i:n,$:{}};this.keys.forEach((s,l)=>{let h=this.getFn(t,s.path);if(!!P(h)){if(K(h)){let i=[];const g=[{nestedArrIndex:-1,value:h}];for(;g.length;){const{nestedArrIndex:a,value:d}=g.pop();if(!!P(d))if(U(d)&&!Me(d)){let m={v:d,i:a,n:this.norm.get(d)};i.push(m)}else K(d)&&d.forEach((m,S)=>{g.push({nestedArrIndex:S,value:m})})}r.$[l]=i}else if(!Me(h)){let i={v:h,n:this.norm.get(h)};r.$[l]=i}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function it(e,t,{getFn:n=k.getFn,fieldNormWeight:r=k.fieldNormWeight}={}){const s=new Ae({getFn:n,fieldNormWeight:r});return s.setKeys(e.map(rt)),s.setSources(t),s.create(),s}function zn(e,{getFn:t=k.getFn,fieldNormWeight:n=k.fieldNormWeight}={}){const{keys:r,records:s}=e,l=new Ae({getFn:t,fieldNormWeight:n});return l.setKeys(r),l.setIndexRecords(s),l}function fe(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:s=k.distance,ignoreLocation:l=k.ignoreLocation}={}){const h=t/e.length;if(l)return h;const i=Math.abs(r-n);return s?h+i/s:i?1:h}function Kn(e=[],t=k.minMatchCharLength){let n=[],r=-1,s=-1,l=0;for(let h=e.length;l<h;l+=1){let i=e[l];i&&r===-1?r=l:!i&&r!==-1&&(s=l-1,s-r+1>=t&&n.push([r,s]),r=-1)}return e[l-1]&&l-r>=t&&n.push([r,l-1]),n}const Q=32;function Un(e,t,n,{location:r=k.location,distance:s=k.distance,threshold:l=k.threshold,findAllMatches:h=k.findAllMatches,minMatchCharLength:i=k.minMatchCharLength,includeMatches:g=k.includeMatches,ignoreLocation:a=k.ignoreLocation}={}){if(t.length>Q)throw new Error(Dn(Q));const d=t.length,m=e.length,S=Math.max(0,Math.min(r,m));let C=l,A=S;const I=i>1||g,b=I?Array(m):[];let w;for(;(w=e.indexOf(t,A))>-1;){let v=fe(t,{currentLocation:w,expectedLocation:S,distance:s,ignoreLocation:a});if(C=Math.min(v,C),A=w+d,I){let R=0;for(;R<d;)b[w+R]=1,R+=1}}A=-1;let c=[],o=1,f=d+m;const p=1<<d-1;for(let v=0;v<d;v+=1){let R=0,E=f;for(;R<E;)fe(t,{errors:v,currentLocation:S+E,expectedLocation:S,distance:s,ignoreLocation:a})<=C?R=E:f=E,E=Math.floor((f-R)/2+R);f=E;let D=Math.max(1,S-E+1),T=h?m:Math.min(S+E,m)+d,O=Array(T+2);O[T+1]=(1<<v)-1;for(let B=T;B>=D;B-=1){let V=B-1,X=n[e.charAt(V)];if(I&&(b[V]=+!!X),O[B]=(O[B+1]<<1|1)&X,v&&(O[B]|=(c[B+1]|c[B])<<1|1|c[B+1]),O[B]&p&&(o=fe(t,{errors:v,currentLocation:V,expectedLocation:S,distance:s,ignoreLocation:a}),o<=C)){if(C=o,A=V,A<=S)break;D=Math.max(1,2*S-A)}}if(fe(t,{errors:v+1,currentLocation:S,expectedLocation:S,distance:s,ignoreLocation:a})>C)break;c=O}const y={isMatch:A>=0,score:Math.max(.001,o)};if(I){const v=Kn(b,i);v.length?g&&(y.indices=v):y.isMatch=!1}return y}function Wn(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const s=e.charAt(n);t[s]=(t[s]||0)|1<<r-n-1}return t}class ot{constructor(t,{location:n=k.location,threshold:r=k.threshold,distance:s=k.distance,includeMatches:l=k.includeMatches,findAllMatches:h=k.findAllMatches,minMatchCharLength:i=k.minMatchCharLength,isCaseSensitive:g=k.isCaseSensitive,ignoreLocation:a=k.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:s,includeMatches:l,findAllMatches:h,minMatchCharLength:i,isCaseSensitive:g,ignoreLocation:a},this.pattern=g?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const d=(S,C)=>{this.chunks.push({pattern:S,alphabet:Wn(S),startIndex:C})},m=this.pattern.length;if(m>Q){let S=0;const C=m%Q,A=m-C;for(;S<A;)d(this.pattern.substr(S,Q),S),S+=Q;if(C){const I=m-Q;d(this.pattern.substr(I),I)}}else d(this.pattern,0)}searchIn(t){const{isCaseSensitive:n,includeMatches:r}=this.options;if(n||(t=t.toLowerCase()),this.pattern===t){let A={isMatch:!0,score:0};return r&&(A.indices=[[0,t.length-1]]),A}const{location:s,distance:l,threshold:h,findAllMatches:i,minMatchCharLength:g,ignoreLocation:a}=this.options;let d=[],m=0,S=!1;this.chunks.forEach(({pattern:A,alphabet:I,startIndex:b})=>{const{isMatch:w,score:c,indices:o}=Un(t,A,I,{location:s+b,distance:l,threshold:h,findAllMatches:i,minMatchCharLength:g,includeMatches:r,ignoreLocation:a});w&&(S=!0),m+=c,w&&o&&(d=[...d,...o])});let C={isMatch:S,score:S?m/this.chunks.length:1};return S&&r&&(C.indices=d),C}}class H{constructor(t){this.pattern=t}static isMultiMatch(t){return lt(t,this.multiRegex)}static isSingleMatch(t){return lt(t,this.singleRegex)}search(){}}function lt(e,t){const n=e.match(t);return n?n[1]:null}class jn extends H{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class Hn extends H{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const r=t.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class Yn extends H{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class Gn extends H{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class Vn extends H{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class qn extends H{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class ct extends H{constructor(t,{location:n=k.location,threshold:r=k.threshold,distance:s=k.distance,includeMatches:l=k.includeMatches,findAllMatches:h=k.findAllMatches,minMatchCharLength:i=k.minMatchCharLength,isCaseSensitive:g=k.isCaseSensitive,ignoreLocation:a=k.ignoreLocation}={}){super(t);this._bitapSearch=new ot(t,{location:n,threshold:r,distance:s,includeMatches:l,findAllMatches:h,minMatchCharLength:i,isCaseSensitive:g,ignoreLocation:a})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class ut extends H{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n=0,r;const s=[],l=this.pattern.length;for(;(r=t.indexOf(this.pattern,n))>-1;)n=r+l,s.push([r,n-1]);const h=!!s.length;return{isMatch:h,score:h?0:1,indices:s}}}const Ie=[jn,ut,Yn,Gn,qn,Vn,Hn,ct],ht=Ie.length,Qn=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,Jn="|";function Xn(e,t={}){return e.split(Jn).map(n=>{let r=n.trim().split(Qn).filter(l=>l&&!!l.trim()),s=[];for(let l=0,h=r.length;l<h;l+=1){const i=r[l];let g=!1,a=-1;for(;!g&&++a<ht;){const d=Ie[a];let m=d.isMultiMatch(i);m&&(s.push(new d(m,t)),g=!0)}if(!g)for(a=-1;++a<ht;){const d=Ie[a];let m=d.isSingleMatch(i);if(m){s.push(new d(m,t));break}}}return s})}const Zn=new Set([ct.type,ut.type]);class es{constructor(t,{isCaseSensitive:n=k.isCaseSensitive,includeMatches:r=k.includeMatches,minMatchCharLength:s=k.minMatchCharLength,ignoreLocation:l=k.ignoreLocation,findAllMatches:h=k.findAllMatches,location:i=k.location,threshold:g=k.threshold,distance:a=k.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:s,findAllMatches:h,ignoreLocation:l,location:i,threshold:g,distance:a},this.pattern=n?t:t.toLowerCase(),this.query=Xn(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:s}=this.options;t=s?t:t.toLowerCase();let l=0,h=[],i=0;for(let g=0,a=n.length;g<a;g+=1){const d=n[g];h.length=0,l=0;for(let m=0,S=d.length;m<S;m+=1){const C=d[m],{isMatch:A,indices:I,score:b}=C.search(t);if(A){if(l+=1,i+=b,r){const w=C.constructor.type;Zn.has(w)?h=[...h,...I]:h.push(I)}}else{i=0,l=0,h.length=0;break}}if(l){let m={isMatch:!0,score:i/l};return r&&(m.indices=h),m}}return{isMatch:!1,score:1}}}const Te=[];function ts(...e){Te.push(...e)}function De(e,t){for(let n=0,r=Te.length;n<r;n+=1){let s=Te[n];if(s.condition(e,t))return new s(e,t)}return new ot(e,t)}const ge={AND:"$and",OR:"$or"},Le={PATH:"$path",PATTERN:"$val"},Fe=e=>!!(e[ge.AND]||e[ge.OR]),ns=e=>!!e[Le.PATH],ss=e=>!K(e)&&tt(e)&&!Fe(e),dt=e=>({[ge.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function ft(e,t,{auto:n=!0}={}){const r=s=>{let l=Object.keys(s);const h=ns(s);if(!h&&l.length>1&&!Fe(s))return r(dt(s));if(ss(s)){const g=h?s[Le.PATH]:l[0],a=h?s[Le.PATTERN]:s[g];if(!U(a))throw new Error(Tn(g));const d={keyId:Ne(g),pattern:a};return n&&(d.searcher=De(a,t)),d}let i={children:[],operator:l[0]};return l.forEach(g=>{const a=s[g];K(a)&&a.forEach(d=>{i.children.push(r(d))})}),i};return Fe(e)||(e=dt(e)),r(e)}function rs(e,{ignoreFieldNorm:t=k.ignoreFieldNorm}){e.forEach(n=>{let r=1;n.matches.forEach(({key:s,norm:l,score:h})=>{const i=s?s.weight:null;r*=Math.pow(h===0&&i?Number.EPSILON:h,(i||1)*(t?1:l))}),n.score=r})}function as(e,t){const n=e.matches;t.matches=[],!!P(n)&&n.forEach(r=>{if(!P(r.indices)||!r.indices.length)return;const{indices:s,value:l}=r;let h={indices:s,value:l};r.key&&(h.key=r.key.src),r.idx>-1&&(h.refIndex=r.idx),t.matches.push(h)})}function is(e,t){t.score=e.score}function os(e,t,{includeMatches:n=k.includeMatches,includeScore:r=k.includeScore}={}){const s=[];return n&&s.push(as),r&&s.push(is),e.map(l=>{const{idx:h}=l,i={item:t[h],refIndex:h};return s.length&&s.forEach(g=>{g(l,i)}),i})}class te{constructor(t,n={},r){this.options={...k,...n},this.options.useExtendedSearch,this._keyStore=new On(this.options.keys),this.setCollection(t,r)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof Ae))throw new Error(In);this._myIndex=n||it(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){!P(t)||(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const n=[];for(let r=0,s=this._docs.length;r<s;r+=1){const l=this._docs[r];t(l,r)&&(this.removeAt(r),r-=1,s-=1,n.push(l))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){const{includeMatches:r,includeScore:s,shouldSort:l,sortFn:h,ignoreFieldNorm:i}=this.options;let g=U(t)?U(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return rs(g,{ignoreFieldNorm:i}),l&&g.sort(h),et(n)&&n>-1&&(g=g.slice(0,n)),os(g,this._docs,{includeMatches:r,includeScore:s})}_searchStringList(t){const n=De(t,this.options),{records:r}=this._myIndex,s=[];return r.forEach(({v:l,i:h,n:i})=>{if(!P(l))return;const{isMatch:g,score:a,indices:d}=n.searchIn(l);g&&s.push({item:l,idx:h,matches:[{score:a,value:l,norm:i,indices:d}]})}),s}_searchLogical(t){const n=ft(t,this.options),r=(i,g,a)=>{if(!i.children){const{keyId:m,searcher:S}=i,C=this._findMatches({key:this._keyStore.get(m),value:this._myIndex.getValueForItemAtKeyId(g,m),searcher:S});return C&&C.length?[{idx:a,item:g,matches:C}]:[]}const d=[];for(let m=0,S=i.children.length;m<S;m+=1){const C=i.children[m],A=r(C,g,a);if(A.length)d.push(...A);else if(i.operator===ge.AND)return[]}return d},s=this._myIndex.records,l={},h=[];return s.forEach(({$:i,i:g})=>{if(P(i)){let a=r(n,i,g);a.length&&(l[g]||(l[g]={idx:g,item:i,matches:[]},h.push(l[g])),a.forEach(({matches:d})=>{l[g].matches.push(...d)}))}}),h}_searchObjectList(t){const n=De(t,this.options),{keys:r,records:s}=this._myIndex,l=[];return s.forEach(({$:h,i})=>{if(!P(h))return;let g=[];r.forEach((a,d)=>{g.push(...this._findMatches({key:a,value:h[d],searcher:n}))}),g.length&&l.push({idx:i,item:h,matches:g})}),l}_findMatches({key:t,value:n,searcher:r}){if(!P(n))return[];let s=[];if(K(n))n.forEach(({v:l,i:h,n:i})=>{if(!P(l))return;const{isMatch:g,score:a,indices:d}=r.searchIn(l);g&&s.push({score:a,key:t,value:l,idx:h,norm:i,indices:d})});else{const{v:l,n:h}=n,{isMatch:i,score:g,indices:a}=r.searchIn(l);i&&s.push({score:g,key:t,value:l,norm:h,indices:a})}return s}}te.version="6.5.3",te.createIndex=it,te.parseIndex=zn,te.config=k,te.parseQuery=ft,ts(es);const ls={threshold:.5,useExtendedSearch:!0,keys:["name","author","description"]};var gt=(e,t)=>!t||t==""?e:new te(e,ls).search(t).map(n=>n.item);const pt=x.findByDisplayName("SearchBar");var yt=({query:e,onChange:t})=>u.React.createElement(pt,{className:"ysink_stain_searchbar",query:e,onQueryChange:t,placeholder:"Search themes...",size:pt.Sizes.MEDIUM});const{SingleSelect:cs}=x.findByDisplayName("Select",!1);var mt=({filterMode:e,setFilterMode:t})=>u.React.createElement(cs,{options:[{value:0,label:"Show All"},{value:1,label:"CC Only"},{value:2,label:"BD Only"}],value:e,onChange:t,isDisabled:!1,className:"ysink_stain_dropdown"});const us=x.findByDisplayName("FormTitle"),hs=x.findByDisplayName("FormText"),ds=x.findByDisplayName("FormSection"),Oe=x.findByProps("Sizes","Colors","Looks","DropdownSizes");var fs=({goToStore:e})=>u.React.createElement(ds,{className:"ysink_stain_nosplash"},u.React.createElement(us,{tag:"h2"},"No Themes"),u.React.createElement(hs,null,"Paste a link in above, or head over to the store"),u.React.createElement(Oe,{className:"ysink_stain_button",color:Oe.Colors.GREEN,sizes:Oe.Sizes.LARGE,onClick:e},"Get some themes"));const{useState:_t,useReducer:gs}=u.React;var ps=({goTo:e})=>{ne.useNest(N.persist);const[t,n]=_t("");let[r,s]=_t(0);const[,l]=gs(h=>~h,0);return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement(Rn,null),u.React.createElement("div",{className:"ysink_stain_search_row"},u.React.createElement(yt,{query:t,onChange:n}),u.React.createElement(mt,{filterMode:r,setFilterMode:s})),N.persist.ghost.themes.length===0?u.React.createElement(fs,{goToStore:()=>e(1)}):u.React.createElement("div",{className:"ysink_stain_cardcontainer"},gt(N.persist.ghost.themes,t).filter(h=>r===0||r===1&&!h.compat||r===2&&h.compat).map(h=>u.React.createElement(Ze,{theme:h,deleteHook:l}))))},pe=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},vt={};Object.defineProperty(vt,"__esModule",{value:!0});var Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ys=function(){function e(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ms=Dt.default,re=_s(ms);function _s(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function vs(e,t){var n={};for(var r in e)t.indexOf(r)>=0||!Object.prototype.hasOwnProperty.call(e,r)||(n[r]=e[r]);return n}function Es(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function Ss(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ks=13,xs=9,ws=8,Rs=89,ye=90,bs=77,St=57,kt=219,xt=222,wt=192,Cs=27,Rt=100,Ms=3e3,Ns="navigator"in pe&&/Win/i.test(navigator.platform),Be="navigator"in pe&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),me="npm__react-simple-code-editor__textarea",As=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`+me+`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`+me+` {
    color: transparent !important;
  }

  .`+me+`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`,bt=function(e){Ss(t,e);function t(){var n,r,s,l;Es(this,t);for(var h=arguments.length,i=Array(h),g=0;g<h;g++)i[g]=arguments[g];return l=(r=(s=Et(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(i))),s),s.state={capture:!0},s._recordCurrentState=function(){var a=s._input;if(!!a){var d=a.value,m=a.selectionStart,S=a.selectionEnd;s._recordChange({value:d,selectionStart:m,selectionEnd:S})}},s._getLines=function(a,d){return a.substring(0,d).split(`
`)},s._recordChange=function(a){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=s._history,S=m.stack,C=m.offset;if(S.length&&C>-1){s._history.stack=S.slice(0,C+1);var A=s._history.stack.length;if(A>Rt){var I=A-Rt;s._history.stack=S.slice(I,A),s._history.offset=Math.max(s._history.offset-I,0)}}var b=Date.now();if(d){var w=s._history.stack[s._history.offset];if(w&&b-w.timestamp<Ms){var c=/[^a-z0-9]([a-z0-9]+)$/i,o=s._getLines(w.value,w.selectionStart).pop().match(c),f=s._getLines(a.value,a.selectionStart).pop().match(c);if(o&&f&&f[1].startsWith(o[1])){s._history.stack[s._history.offset]=Y({},a,{timestamp:b});return}}}s._history.stack.push(Y({},a,{timestamp:b})),s._history.offset++},s._updateInput=function(a){var d=s._input;!d||(d.value=a.value,d.selectionStart=a.selectionStart,d.selectionEnd=a.selectionEnd,s.props.onValueChange(a.value))},s._applyEdits=function(a){var d=s._input,m=s._history.stack[s._history.offset];m&&d&&(s._history.stack[s._history.offset]=Y({},m,{selectionStart:d.selectionStart,selectionEnd:d.selectionEnd})),s._recordChange(a),s._updateInput(a)},s._undoEdit=function(){var a=s._history,d=a.stack,m=a.offset,S=d[m-1];S&&(s._updateInput(S),s._history.offset=Math.max(m-1,0))},s._redoEdit=function(){var a=s._history,d=a.stack,m=a.offset,S=d[m+1];S&&(s._updateInput(S),s._history.offset=Math.min(m+1,d.length-1))},s._handleKeyDown=function(a){var d=s.props,m=d.tabSize,S=d.insertSpaces,C=d.ignoreTabKey,A=d.onKeyDown;if(!(A&&(A(a),a.defaultPrevented))){a.keyCode===Cs&&a.target.blur();var I=a.target,b=I.value,w=I.selectionStart,c=I.selectionEnd,o=(S?" ":"	").repeat(m);if(a.keyCode===xs&&!C&&s.state.capture)if(a.preventDefault(),a.shiftKey){var f=s._getLines(b,w),p=f.length-1,y=s._getLines(b,c).length-1,v=b.split(`
`).map(function(F,Z){return Z>=p&&Z<=y&&F.startsWith(o)?F.substring(o.length):F}).join(`
`);if(b!==v){var R=f[p];s._applyEdits({value:v,selectionStart:R.startsWith(o)?w-o.length:w,selectionEnd:c-(b.length-v.length)})}}else if(w!==c){var E=s._getLines(b,w),D=E.length-1,T=s._getLines(b,c).length-1,O=E[D];s._applyEdits({value:b.split(`
`).map(function(F,Z){return Z>=D&&Z<=T?o+F:F}).join(`
`),selectionStart:/\S/.test(O)?w+o.length:w,selectionEnd:c+o.length*(T-D+1)})}else{var G=w+o.length;s._applyEdits({value:b.substring(0,w)+o+b.substring(c),selectionStart:G,selectionEnd:G})}else if(a.keyCode===ws){var B=w!==c,V=b.substring(0,w);if(V.endsWith(o)&&!B){a.preventDefault();var X=w-o.length;s._applyEdits({value:b.substring(0,w-o.length)+b.substring(c),selectionStart:X,selectionEnd:X})}}else if(a.keyCode===ks){if(w===c){var _e=s._getLines(b,w).pop(),L=_e.match(/^\s+/);if(L&&L[0]){a.preventDefault();var z=`
`+L[0],W=w+z.length;s._applyEdits({value:b.substring(0,w)+z+b.substring(c),selectionStart:W,selectionEnd:W})}}}else if(a.keyCode===St||a.keyCode===kt||a.keyCode===xt||a.keyCode===wt){var $=void 0;a.keyCode===St&&a.shiftKey?$=["(",")"]:a.keyCode===kt?a.shiftKey?$=["{","}"]:$=["[","]"]:a.keyCode===xt?a.shiftKey?$=['"','"']:$=["'","'"]:a.keyCode===wt&&!a.shiftKey&&($=["`","`"]),w!==c&&$&&(a.preventDefault(),s._applyEdits({value:b.substring(0,w)+$[0]+b.substring(w,c)+$[1]+b.substring(c),selectionStart:w,selectionEnd:c+2}))}else(Be?a.metaKey&&a.keyCode===ye:a.ctrlKey&&a.keyCode===ye)&&!a.shiftKey&&!a.altKey?(a.preventDefault(),s._undoEdit()):(Be?a.metaKey&&a.keyCode===ye&&a.shiftKey:Ns?a.ctrlKey&&a.keyCode===Rs:a.ctrlKey&&a.keyCode===ye&&a.shiftKey)&&!a.altKey?(a.preventDefault(),s._redoEdit()):a.keyCode===bs&&a.ctrlKey&&(Be?a.shiftKey:!0)&&(a.preventDefault(),s.setState(function(F){return{capture:!F.capture}}))}},s._handleChange=function(a){var d=a.target,m=d.value,S=d.selectionStart,C=d.selectionEnd;s._recordChange({value:m,selectionStart:S,selectionEnd:C},!0),s.props.onValueChange(m)},s._history={stack:[],offset:-1},r),Et(s,l)}return ys(t,[{key:"componentDidMount",value:function(){this._recordCurrentState()}},{key:"render",value:function(){var r=this,s=this.props,l=s.value,h=s.style,i=s.padding,g=s.highlight,a=s.textareaId,d=s.textareaClassName,m=s.autoFocus,S=s.disabled,C=s.form,A=s.maxLength,I=s.minLength,b=s.name,w=s.placeholder,c=s.readOnly,o=s.required,f=s.onClick,p=s.onFocus,y=s.onBlur,v=s.onKeyUp;s.onKeyDown,s.onValueChange,s.tabSize,s.insertSpaces,s.ignoreTabKey;var R=s.preClassName,E=vs(s,["value","style","padding","highlight","textareaId","textareaClassName","autoFocus","disabled","form","maxLength","minLength","name","placeholder","readOnly","required","onClick","onFocus","onBlur","onKeyUp","onKeyDown","onValueChange","tabSize","insertSpaces","ignoreTabKey","preClassName"]),D={paddingTop:i,paddingRight:i,paddingBottom:i,paddingLeft:i},T=g(l);return re.createElement("div",Y({},E,{style:Y({},ae.container,h)}),re.createElement("textarea",{ref:function(G){return r._input=G},style:Y({},ae.editor,ae.textarea,D),className:me+(d?" "+d:""),id:a,value:l,onChange:this._handleChange,onKeyDown:this._handleKeyDown,onClick:f,onKeyUp:v,onFocus:p,onBlur:y,disabled:S,form:C,maxLength:A,minLength:I,name:b,placeholder:w,readOnly:c,required:o,autoFocus:m,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),re.createElement("pre",Y({className:R,"aria-hidden":"true",style:Y({},ae.editor,ae.highlight,D)},typeof T=="string"?{dangerouslySetInnerHTML:{__html:T+"<br />"}}:{children:T})),re.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:As}}))}},{key:"session",get:function(){return{history:this._history}},set:function(r){this._history=r.history}}]),t}(re.Component);bt.defaultProps={tabSize:2,insertSpaces:!0,ignoreTabKey:!1,padding:0};var Is=vt.default=bt,ae={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}},$e={exports:{}};(function(e){var t=typeof window!="undefined"?window:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,l=0,h={},i={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function c(o){return o instanceof g?new g(o.type,c(o.content),o.alias):Array.isArray(o)?o.map(c):o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(c){return Object.prototype.toString.call(c).slice(8,-1)},objId:function(c){return c.__id||Object.defineProperty(c,"__id",{value:++l}),c.__id},clone:function c(o,f){f=f||{};var p,y;switch(i.util.type(o)){case"Object":if(y=i.util.objId(o),f[y])return f[y];p={},f[y]=p;for(var v in o)o.hasOwnProperty(v)&&(p[v]=c(o[v],f));return p;case"Array":return y=i.util.objId(o),f[y]?f[y]:(p=[],f[y]=p,o.forEach(function(R,E){p[E]=c(R,f)}),p);default:return o}},getLanguage:function(c){for(;c;){var o=s.exec(c.className);if(o)return o[1].toLowerCase();c=c.parentElement}return"none"},setLanguage:function(c,o){c.className=c.className.replace(RegExp(s,"gi"),""),c.classList.add("language-"+o)},currentScript:function(){if(typeof document=="undefined")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(p){var c=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(p.stack)||[])[1];if(c){var o=document.getElementsByTagName("script");for(var f in o)if(o[f].src==c)return o[f]}return null}},isActive:function(c,o,f){for(var p="no-"+o;c;){var y=c.classList;if(y.contains(o))return!0;if(y.contains(p))return!1;c=c.parentElement}return!!f}},languages:{plain:h,plaintext:h,text:h,txt:h,extend:function(c,o){var f=i.util.clone(i.languages[c]);for(var p in o)f[p]=o[p];return f},insertBefore:function(c,o,f,p){p=p||i.languages;var y=p[c],v={};for(var R in y)if(y.hasOwnProperty(R)){if(R==o)for(var E in f)f.hasOwnProperty(E)&&(v[E]=f[E]);f.hasOwnProperty(R)||(v[R]=y[R])}var D=p[c];return p[c]=v,i.languages.DFS(i.languages,function(T,O){O===D&&T!=c&&(this[T]=v)}),v},DFS:function c(o,f,p,y){y=y||{};var v=i.util.objId;for(var R in o)if(o.hasOwnProperty(R)){f.call(o,R,o[R],p||R);var E=o[R],D=i.util.type(E);D==="Object"&&!y[v(E)]?(y[v(E)]=!0,c(E,f,null,y)):D==="Array"&&!y[v(E)]&&(y[v(E)]=!0,c(E,f,R,y))}}},plugins:{},highlightAll:function(c,o){i.highlightAllUnder(document,c,o)},highlightAllUnder:function(c,o,f){var p={callback:f,container:c,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",p),p.elements=Array.prototype.slice.apply(p.container.querySelectorAll(p.selector)),i.hooks.run("before-all-elements-highlight",p);for(var y=0,v;v=p.elements[y++];)i.highlightElement(v,o===!0,p.callback)},highlightElement:function(c,o,f){var p=i.util.getLanguage(c),y=i.languages[p];i.util.setLanguage(c,p);var v=c.parentElement;v&&v.nodeName.toLowerCase()==="pre"&&i.util.setLanguage(v,p);var R=c.textContent,E={element:c,language:p,grammar:y,code:R};function D(O){E.highlightedCode=O,i.hooks.run("before-insert",E),E.element.innerHTML=E.highlightedCode,i.hooks.run("after-highlight",E),i.hooks.run("complete",E),f&&f.call(E.element)}if(i.hooks.run("before-sanity-check",E),v=E.element.parentElement,v&&v.nodeName.toLowerCase()==="pre"&&!v.hasAttribute("tabindex")&&v.setAttribute("tabindex","0"),!E.code){i.hooks.run("complete",E),f&&f.call(E.element);return}if(i.hooks.run("before-highlight",E),!E.grammar){D(i.util.encode(E.code));return}if(o&&r.Worker){var T=new Worker(i.filename);T.onmessage=function(O){D(O.data)},T.postMessage(JSON.stringify({language:E.language,code:E.code,immediateClose:!0}))}else D(i.highlight(E.code,E.grammar,E.language))},highlight:function(c,o,f){var p={code:c,grammar:o,language:f};return i.hooks.run("before-tokenize",p),p.tokens=i.tokenize(p.code,p.grammar),i.hooks.run("after-tokenize",p),g.stringify(i.util.encode(p.tokens),p.language)},tokenize:function(c,o){var f=o.rest;if(f){for(var p in f)o[p]=f[p];delete o.rest}var y=new m;return S(y,y.head,c),d(c,y,o,y.head,0),A(y)},hooks:{all:{},add:function(c,o){var f=i.hooks.all;f[c]=f[c]||[],f[c].push(o)},run:function(c,o){var f=i.hooks.all[c];if(!(!f||!f.length))for(var p=0,y;y=f[p++];)y(o)}},Token:g};r.Prism=i;function g(c,o,f,p){this.type=c,this.content=o,this.alias=f,this.length=(p||"").length|0}g.stringify=function c(o,f){if(typeof o=="string")return o;if(Array.isArray(o)){var p="";return o.forEach(function(D){p+=c(D,f)}),p}var y={type:o.type,content:c(o.content,f),tag:"span",classes:["token",o.type],attributes:{},language:f},v=o.alias;v&&(Array.isArray(v)?Array.prototype.push.apply(y.classes,v):y.classes.push(v)),i.hooks.run("wrap",y);var R="";for(var E in y.attributes)R+=" "+E+'="'+(y.attributes[E]||"").replace(/"/g,"&quot;")+'"';return"<"+y.tag+' class="'+y.classes.join(" ")+'"'+R+">"+y.content+"</"+y.tag+">"};function a(c,o,f,p){c.lastIndex=o;var y=c.exec(f);if(y&&p&&y[1]){var v=y[1].length;y.index+=v,y[0]=y[0].slice(v)}return y}function d(c,o,f,p,y,v){for(var R in f)if(!(!f.hasOwnProperty(R)||!f[R])){var E=f[R];E=Array.isArray(E)?E:[E];for(var D=0;D<E.length;++D){if(v&&v.cause==R+","+D)return;var T=E[D],O=T.inside,G=!!T.lookbehind,B=!!T.greedy,V=T.alias;if(B&&!T.pattern.global){var X=T.pattern.toString().match(/[imsuy]*$/)[0];T.pattern=RegExp(T.pattern.source,X+"g")}for(var _e=T.pattern||T,L=p.next,z=y;L!==o.tail&&!(v&&z>=v.reach);z+=L.value.length,L=L.next){var W=L.value;if(o.length>c.length)return;if(!(W instanceof g)){var $=1,F;if(B){if(F=a(_e,z,c,G),!F||F.index>=c.length)break;var ve=F.index,Z=F.index+F[0].length,q=z;for(q+=L.value.length;ve>=q;)L=L.next,q+=L.value.length;if(q-=L.value.length,z=q,L.value instanceof g)continue;for(var le=L;le!==o.tail&&(q<Z||typeof le.value=="string");le=le.next)$++,q+=le.value.length;$--,W=c.slice(z,q),F.index-=z}else if(F=a(_e,0,W,G),!F)continue;var ve=F.index,Ee=F[0],Ue=W.slice(0,ve),Nt=W.slice(ve+Ee.length),We=z+W.length;v&&We>v.reach&&(v.reach=We);var Se=L.prev;Ue&&(Se=S(o,Se,Ue),z+=Ue.length),C(o,Se,$);var or=new g(R,O?i.tokenize(Ee,O):Ee,V,Ee);if(L=S(o,Se,or),Nt&&S(o,L,Nt),$>1){var je={cause:R+","+D,reach:We};d(c,o,f,L.prev,z,je),v&&je.reach>v.reach&&(v.reach=je.reach)}}}}}}function m(){var c={value:null,prev:null,next:null},o={value:null,prev:c,next:null};c.next=o,this.head=c,this.tail=o,this.length=0}function S(c,o,f){var p=o.next,y={value:f,prev:o,next:p};return o.next=y,p.prev=y,c.length++,y}function C(c,o,f){for(var p=o.next,y=0;y<f&&p!==c.tail;y++)p=p.next;o.next=p,p.prev=o,c.length-=y}function A(c){for(var o=[],f=c.head.next;f!==c.tail;)o.push(f.value),f=f.next;return o}if(!r.document)return r.addEventListener&&(i.disableWorkerMessageHandler||r.addEventListener("message",function(c){var o=JSON.parse(c.data),f=o.language,p=o.code,y=o.immediateClose;r.postMessage(i.highlight(p,i.languages[f],f)),y&&r.close()},!1)),i;var I=i.util.currentScript();I&&(i.filename=I.src,I.hasAttribute("data-manual")&&(i.manual=!0));function b(){i.manual||i.highlightAll()}if(!i.manual){var w=document.readyState;w==="loading"||w==="interactive"&&I&&I.defer?document.addEventListener("DOMContentLoaded",b):window.requestAnimationFrame?window.requestAnimationFrame(b):window.setTimeout(b,16)}return i}(t);e.exports&&(e.exports=n),typeof pe!="undefined"&&(pe.Prism=n)})($e),function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(Prism);const Ts=x.findByProps("contentColumn").contentColumn,{useState:Ds,useCallback:fr}=u.React,Ls=e=>N.reloadCSS(N.persist.store.quickCSS=e),Fs=_.debounce(Ls,250);var Os=()=>{const[e,t]=Ds(N.persist.ghost.quickCSS);return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement("div",{class:"ysink_stain_quickcss"},u.React.createElement(Is,{className:"ysink_stain_editorroot",value:e??"",onValueChange:n=>{t(n),Fs(n)},highlight:n=>$e.exports.highlight(n,$e.exports.languages.css),padding:10}),u.React.createElement("link",{href:"https://cdn.jsdelivr.net/gh/PrismJS/prism-themes@master/themes/prism-atom-dark.css",rel:"stylesheet"}),u.React.createElement("style",null,`:root { --background-primary: #1d1f21; } .theme-light .${Ts} { --text-normal: white; }`)))};const Bs=x.findByDisplayName("FormTitle"),$s=x.findByDisplayName("FormText"),Ps=x.findByDisplayName("FormSection"),Pe=x.findByProps("Sizes","Colors","Looks","DropdownSizes");var zs=({})=>u.React.createElement(Ps,{className:"ysink_stain_nosplash"},u.React.createElement(Bs,{tag:"h2"},"No Repos"),u.React.createElement($s,null,"Add one in the repo manager!"),u.React.createElement(Pe,{className:"ysink_stain_button",color:Pe.Colors.GREEN,sizes:Pe.Sizes.LARGE,onClick:qe},"Open repo manager"));const{useState:ie,useEffect:Ks,useReducer:Us}=u.React,Ws=()=>Promise.all(N.persist.ghost.repos.map(Re)),js=e=>e.flatMap(t=>t.themes);async function Hs(){let e=await Ws();return{repos:e,themes:js(e)}}const Ys=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((n,r)=>n===t[r]);var Gs=()=>{ne.useNest(N.persist);const[e,t]=ie(""),[n,r]=ie([]),[s,l]=ie(void 0),[h,i]=ie(void 0),[g,a]=ie(0);Ks(()=>{let m=()=>Hs().then(({repos:S,themes:C})=>{l(S),i(C)});Ys(n,N.persist.ghost.repos)||(r(N.persist.ghost.repos),m()),(!s||!h)&&m()});const[,d]=Us(m=>~m,0);return u.React.createElement(ee.ErrorBoundary,null,u.React.createElement("div",{className:"ysink_stain_search_row"},u.React.createElement(yt,{query:e,onChange:t}),u.React.createElement(mt,{filterMode:g,setFilterMode:a})),N.persist.ghost.repos.length===0?u.React.createElement(zs,null):u.React.createElement("div",{className:"ysink_stain_cardcontainer"},gt(h??[],e).filter(m=>g===0||g===1&&!m.compat||g===2&&m.compat).map(m=>u.React.createElement(Ze,{theme:m,deleteHook:d}))))};const Vs=x.findByDisplayName("FormTitle"),qs=x.findByDisplayName("FormSection"),Qs=x.findByDisplayName("Flex"),ze=x.findByProps("Sizes","Colors","Looks","DropdownSizes");var Js=()=>u.React.createElement(ee.ErrorBoundary,null,u.React.createElement(qs,null,u.React.createElement(Qs,{basis:"auto",grow:1,shrink:1,className:"ysink_stain_row"},u.React.createElement(Vs,{tag:"h1"},"Cumstain Settings"),u.React.createElement(ze,{className:"ysink_stain_button",color:ze.Colors.GREEN,sizes:ze.Sizes.LARGE,onClick:qe},"Repo Manager")),u.React.createElement(hn,{items:[{text:"Installed",component:ps},{text:"Store",component:Gs},{text:"Quick CSS",component:Os}]}))),Xs=()=>ce.after("getPredicateSections",x.findByDisplayName("SettingsView").prototype,(e,t)=>{if(t[1]?.section!="My Account")return;let n=t.findIndex(r=>r.section=="CUMCORD_PLUGINS")+1;return t.splice(n,0,{section:"ysink_stain_CUMSTAIN",label:"Themes",element:Js}),t}),Zs=()=>cumcord.patcher.injectCSS(".ysink_stain_tabbar{padding:.5rem 1rem;display:grid;grid-auto-flow:column;grid-auto-columns:7rem}.ysink_stain_tabbar .ysink_stain_button *{cursor:pointer}.ysink_stain_tabbar>*{margin-right:1rem;padding:.2rem;border-radius:.3rem;min-width:5rem;text-align:center;background:none}.theme-dark .ysink_stain_tabbar>*.ysink_stain_selected{background:#fff4}.theme-light .ysink_stain_tabbar>*.ysink_stain_selected{background:#0003}.ysink_stain_tabbar>*:last-child{margin-right:0}.ysink_stain_cardcontainer{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}.ysink_stain_card{padding:1rem;border:1px solid var(--background-modifier-accent);border-radius:.5rem;display:flex;flex-direction:column;z-index:1;background-color:var(--deprecated-card-bg)}.ysink_stain_card .ysink_stain_title{font-size:1rem;padding-top:.2rem;display:inline;flex:1;margin:0}.ysink_stain_card .ysink_stain_button{display:inline;padding:0}.ysink_stain_card .ysink_stain_button>div{padding:2px 16px}.ysink_stain_card .ysink_stain_row{display:flex;margin-bottom:.5rem}.ysink_stain_card .ysink_stain_author_licence{font-style:italic}.ysink_stain_card .ysink_stain_desc{flex:1}.ysink_stain_card .ysink_stain_carousel{margin-bottom:1rem}.ysink_stain_card .ysink_stain_carousel>div:not(.ysink_stain_noimg)>:last-child,.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg>div>:last-child{height:2.25rem}.ysink_stain_card .ysink_stain_carousel>div{border-radius:.5rem}.theme-dark .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:#0005}.theme-light .ysink_stain_card .ysink_stain_carousel>:not(.ysink_stain_noimg){background:#000d}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg{display:grid}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div{grid-area:1/1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div:not(.ysink_stain_noimgtxt){visibility:hidden;z-index:-1}.ysink_stain_card .ysink_stain_carousel .ysink_stain_noimg div.ysink_stain_noimgtxt{grid-area:1/1;font-size:1.5rem;text-align:center;padding-top:35%;text-transform:uppercase;opacity:.8}.ysink_stain_divide{margin:0 0 1rem}.ysink_stain_modal .ysink_stain_divide{margin:.5rem 0}.ysink_stain_card .ysink_stain_divide{margin:.2rem 0}.ysink_stain_delete{margin-right:.5rem;fill:var(--interactive-normal)}.ysink_stain_installbar{display:flex}.ysink_stain_installbar>*{flex:1}.ysink_stain_installbar>:last-child{flex:unset;margin-left:1rem}.ysink_stain_searchbar{margin:.75rem 0}.ysink_stain_search_row{display:flex;gap:.75rem;margin:.75rem 0}.ysink_stain_search_row .ysink_stain_dropdown{height:2.25rem;flex-basis:10rem;padding-top:.3rem}.ysink_stain_search_row .ysink_stain_searchbar{margin:unset;flex:1}.ysink_stain_editorroot{background:tranparent;color:#c5c8c6;font-family:var(--font-code);font-size:.9rem;line-height:1.1rem}.ysink_stain_badge{width:1.5rem;height:1.5rem;margin-right:.5rem;border-radius:50%}.ysink_stain_badge.ysink_stain_bd{padding:.25rem;background:#040405}.ysink_stain_badge.ysink_stain_cc{padding:.1rem;background:#f8f8f8;background:#7289DA}.ysink_stain_nosplash{display:flex;flex-direction:column;align-items:center;margin-top:15rem;gap:.5rem}.ysink_stain_nosplash h2{margin-bottom:0}.ysink_stain_nosplash>*{flex:0}.ysink_stain_nosplash .ysink_stain_button{margin-top:2rem}.ysink_stain_modal .ysink_stain_row{display:flex}.ysink_stain_modal .ysink_stain_row>*{flex:1}.ysink_stain_modal .ysink_stain_row>:last-child{flex:unset;margin-left:1rem}"),er=()=>{const e=ce.injectCSS(M.default.persist.ghost.quickCSS);return M.default.reloadCSS=t=>e(t??M.default.persist.ghost.quickCSS),()=>{e(),M.default.reloadCSS=void 0,delete M.default.reloadCSS}};const Ke=x.findByDisplayName("Text");var tr=()=>ce.after("default",x.findByDisplayName("ClientDebugInfo",!1),(e,t)=>(t.props.children.push(u.React.createElement(Ke,{color:Ke.Colors.MUTED,tag:"span",size:Ke.Sizes.SIZE_12},["cumstain"," ","pre0.3"," "])),t));const oe=e=>N.persist.ghost.themes.find(t=>t.url===e),Ct=e=>!!oe(e)?.enabled,Mt=e=>Ct(e.url)?Ut(e):he(e),nr=async e=>await Mt(await ue(e)),sr=e=>Ye(oe(e)),rr=async e=>{if(!oe(e))throw new Error(`Theme with ID ${e} was not installed`);Ct(e)?we(oe(e)):await Mt(oe(e))},J=async()=>{for(const e in window.cumstain.installed.ghost)delete window.cumstain.installed.ghost[e];for(const e of N.persist.ghost.themes)window.cumstain.installed.store[e.url]={enabled:e.enabled,manifest:e};for(const[e,t]of Object.entries(window.cumstain.installed.ghost))t.enabled?window.cumstain.enabled.store[e]=t:delete window.cumstain.enabled.ghost[e]};var ar=()=>(window.cumstain={installed:j.nests.make({}),enabled:j.nests.make({}),importTheme:nr,removeTheme:sr,toggleTheme:rr},J(),N.persist.on(j.nests.Events.UPDATE,J),N.persist.on(j.nests.Events.SET,J),N.persist.on(j.nests.Events.DELETE,J),He.log("|| CUMSTAIN || Initialised window.cumstain API"),()=>{N.persist.off(j.nests.Events.UPDATE,J),N.persist.off(j.nests.Events.SET,J),N.persist.off(j.nests.Events.DELETE,J),window.cumstain=void 0,delete window.cumstain,He.log("|| CUMSTAIN || Disposed window.cumstain API")}),ir=({persist:e})=>{let t=[tr(),Zs(),Ht(),jt(),er(),Xs(),ar()];return Array.isArray(e.ghost.repos)||(e.store.repos=[]),{onUnload:()=>_.forEachRight(t,n=>n())}};return ir})(cumcord.pluginData,cumcord.patcher,cumcord.modules.internal.nests,cumcord.modules.webpack,cumcord.ui.components,cumcord.utils,cumcord.ui.toasts,cumcord.modules.common,cumcord.modules.common.React,cumcord.modules.internal,cumcord.utils.logger);
