(function(o,i,c,s,S,d,N,P,B,I){"use strict";function C(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function L(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var u=L(N),a=C(I);const w=c.findByDisplayName("FormText"),F=c.findByDisplayName("Switch");c.findByDisplayName("TextInput"),c.findByDisplayName("Select",!1).SingleSelect;const T=e=>({display:"flex",alignItems:"center",gap:".5rem",marginBottom:"1rem",marginLeft:e!==void 0?"1rem":0}),y=({k:e,depends:t,children:n})=>a.default.createElement("div",{style:T(t)},a.default.createElement(F,{checked:i.persist.ghost[e],disabled:t!==void 0&&!i.persist.ghost[t],onChange:r=>i.persist.store[e]=r}),a.default.createElement(w,{children:n})),v=e=>t=>(P.useNest(i.persist),e(t));((e,t=i.persist)=>{for(const n in e)t.ghost[n]===void 0&&(t.store[n]=e[n])})({scroll:!0,scrollSmooth:!0});var x=v(()=>u.createElement(u.Fragment,null,u.createElement(y,{k:"scroll"},"Scroll to keep the replying-to message on-screen"),u.createElement(y,{k:"scrollSmooth",depends:"scroll"},"Scroll smoothly")));const[{getChannel:A},{getMessages:M},k]=c.batchFind(({findByProps:e})=>{e("getDMUserIds"),e("getRawMessages"),e("setPendingReplyShouldMention")}),j=()=>A(d.getChannelId()),f=new Set;let l=-1,g=d.getChannelId(),m,h=Symbol("quickreply_deletePendingReply_int");function O(){if(!i.persist.ghost.scroll)return;const e=document.querySelector('[data-list-id="chat-messages"]');Array.from(e.children).find(n=>n.firstChild?.className?.includes("replying-"))?.scrollIntoView({behavior:i.persist.ghost.scrollSmooth?"smooth":void 0,block:"center"})}function G(e,t,n,r){typeof r>"u"&&(r=e.guild_id!==null),s.FluxDispatcher.dispatch({type:"CREATE_PENDING_REPLY",channel:e,message:t,shouldMention:n,showMentionToggle:r}),setTimeout(O,100)}function p(e){s.FluxDispatcher.dispatch({type:"DELETE_PENDING_REPLY",channelId:d.getChannelId(),...e})}function E(e){g!==e.channelId&&(g=e.channelId,l=-1)}function _(e){m=e.message.id}function D(e){m=void 0,e[h]||(l=-1)}async function R(e){if(!e.ctrlKey&&!e.metaKey||e.key!=="ArrowUp"&&e.key!=="ArrowDown")return;const t=(await M(d.getChannelId())).toArray().reverse(),n=t.findIndex(r=>r.id===m)||0;if(e.key==="ArrowUp"?l=n+1:e.key==="ArrowDown"&&(l=n-1),l>t.length&&(l=t.length),l<0)return p();p({[h]:!0}),G(j(),t[l],!f.has(d.getChannelId()))}let b;function Y(){s.FluxDispatcher.subscribe("CHANNEL_SELECT",E),s.FluxDispatcher.subscribe("CREATE_PENDING_REPLY",_),s.FluxDispatcher.subscribe("DELETE_PENDING_REPLY",D),window.addEventListener("keydown",R),b=S.before("setPendingReplyShouldMention",k,e=>{e[1]?f.delete(e[0]):f.add(e[0])})}function U(){s.FluxDispatcher.unsubscribe("CHANNEL_SELECT",E),s.FluxDispatcher.unsubscribe("CREATE_PENDING_REPLY",_),s.FluxDispatcher.unsubscribe("DELETE_PENDING_REPLY",D),window.removeEventListener("keydown",R),b?.()}return o.onLoad=Y,o.onUnload=U,o.settings=x,Object.defineProperty(o,"__esModule",{value:!0}),o})({},cumcord.pluginData,cumcord.modules.webpack,cumcord.modules.common,cumcord.patcher,cumcord.modules.common.channels,cumcord.modules.common.React,cumcord.utils,cumcord.plugins,cumcord.modules.common.React);
