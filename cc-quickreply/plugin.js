(function(l,c,o,d,i,S,u,T,w,q,L){"use strict";function A(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function I(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var a=I(T),f=A(L);const R=d.findByDisplayName("FormText"),C=d.findByDisplayName("Switch");d.findByDisplayName("TextInput"),d.findByDisplayName("Select",!1).SingleSelect;const v=e=>({display:"flex",alignItems:"center",gap:".5rem",marginBottom:"1rem",marginLeft:e!==void 0?"1rem":0}),h=({k:e,depends:t,children:n})=>f.default.createElement("div",{style:v(t)},f.default.createElement(C,{checked:c.persist.ghost[e],disabled:t!==void 0&&!c.persist.ghost[t],onChange:r=>c.persist.store[e]=r}),f.default.createElement(R,{children:n})),F=e=>t=>(w.useNest(c.persist),e(t));((e,t=c.persist)=>{for(const n in e)t.ghost[n]===void 0&&(t.store[n]=e[n])})({scroll:!0,scrollSmooth:!0});var x=F(()=>a.createElement(a.Fragment,null,a.createElement(h,{k:"scroll"},"Scroll to keep the replying-to message on-screen"),a.createElement(h,{k:"scrollSmooth",depends:"scroll"},"Scroll smoothly")));const[{getChannel:M},{getMessages:j},k]=d.batchFind(({findByProps:e})=>{e("getDMUserIds"),e("getRawMessages"),e("setPendingReplyShouldMention")}),O=()=>M(u.getChannelId()),m=new Set;let s=-1,p=u.getChannelId(),y,E=Symbol("quickreply_deletePendingReply_int");function B(){if(!c.persist.ghost.scroll)return;const e=document.querySelector('[data-list-id="chat-messages"]');Array.from(e.children).find(t=>t.firstChild?.className?.includes("replying-"))?.scrollIntoView({behavior:c.persist.ghost.scrollSmooth?"smooth":void 0,block:"center"})}function G(e,t,n,r){typeof r=="undefined"&&(r=e.guild_id!==null),i.FluxDispatcher.dirtyDispatch({type:o.ActionTypes.CREATE_PENDING_REPLY,channel:e,message:t,shouldMention:n,showMentionToggle:r}),setTimeout(B,100)}function g(e){i.FluxDispatcher.dirtyDispatch({type:o.ActionTypes.DELETE_PENDING_REPLY,channelId:u.getChannelId(),...e})}function _(e){p!==e.channelId&&(p=e.channelId,s=-1)}function D(e){y=e.message.id}function N(e){y=void 0,e[E]||(s=-1)}async function b(e){if(!e.ctrlKey&&!e.metaKey||e.key!=="ArrowUp"&&e.key!=="ArrowDown")return;const t=(await j(u.getChannelId())).toArray().reverse(),n=t.findIndex(r=>r.id===y)||0;if(e.key==="ArrowUp"?s=n+1:e.key==="ArrowDown"&&(s=n-1),s>t.length&&(s=t.length),s<0)return g();g({[E]:!0}),G(O(),t[s],!m.has(u.getChannelId()))}let P;function Y(){i.FluxDispatcher.subscribe(o.ActionTypes.CHANNEL_SELECT,_),i.FluxDispatcher.subscribe(o.ActionTypes.CREATE_PENDING_REPLY,D),i.FluxDispatcher.subscribe(o.ActionTypes.DELETE_PENDING_REPLY,N),window.addEventListener("keydown",b),P=S.before("setPendingReplyShouldMention",k,e=>{e[1]?m.delete(e[0]):m.add(e[0])})}function U(){i.FluxDispatcher.unsubscribe(o.ActionTypes.CHANNEL_SELECT,_),i.FluxDispatcher.unsubscribe(o.ActionTypes.CREATE_PENDING_REPLY,D),i.FluxDispatcher.unsubscribe(o.ActionTypes.DELETE_PENDING_REPLY,N),window.removeEventListener("keydown",b),P?.()}return l.onLoad=Y,l.onUnload=U,l.settings=x,Object.defineProperty(l,"__esModule",{value:!0}),l})({},cumcord.pluginData,cumcord.modules.common.constants,cumcord.modules.webpack,cumcord.modules.common,cumcord.patcher,cumcord.modules.common.channels,cumcord.modules.common.React,cumcord.utils,cumcord.plugins,cumcord.modules.common.React);
