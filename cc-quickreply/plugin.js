(function(n,d,i){"use strict";const{getChannelId:l}=d.findByProps("getChannelId","getLastSelectedChannelId","getVoiceChannelId"),{getChannel:h}=d.findByProps("getChannel","getDMUserIds"),{getMessages:D}=d.findByProps("getRawMessages");let s=-1,o=l(),c,a=Symbol("quickreply_deletePendingReply_int");function A(){const e=document.querySelector('[data-list-id="chat-messages"]');Array.from(e.children).find(t=>t.firstChild?.className?.includes("replying-"))?.scrollIntoView({behavior:"smooth",block:"center"})}function P(){return h(l())}async function C(e,u,t,r){typeof r=="undefined"&&(r=e.guild_id!==null),i.FluxDispatcher.dirtyDispatch({type:n.ActionTypes.CREATE_PENDING_REPLY,channel:e,message:u,shouldMention:t,showMentionToggle:r}),setTimeout(()=>{A()},100)}async function y(e){i.FluxDispatcher.dirtyDispatch({type:n.ActionTypes.DELETE_PENDING_REPLY,channelId:l(),...e})}function p(e){o!==e.channelId&&(o=e.channelId,s=-1)}function g(e){c!==e.message.id&&(c=e.message.id)}function E(e){c=void 0,e[a]||(s=-1)}async function f(e){if(!e.ctrlKey||e.key!=="ArrowUp"&&e.key!=="ArrowDown")return;let t=(await D(l())).toArray().reverse(),r=t.findIndex(N=>N.id===c)||0;if(e.key==="ArrowUp"?s=r+1:e.key==="ArrowDown"&&(s=r-1),s>t.length&&(s=t.length),s<0)return y();let L=t[s];y({[a]:!0}),C(P(),L,!0)}var I={onLoad(){i.FluxDispatcher.subscribe(n.ActionTypes.CHANNEL_SELECT,p),i.FluxDispatcher.subscribe(n.ActionTypes.CREATE_PENDING_REPLY,g),i.FluxDispatcher.subscribe(n.ActionTypes.DELETE_PENDING_REPLY,E),window.addEventListener("keydown",f)},onUnload(){i.FluxDispatcher.unsubscribe(n.ActionTypes.CHANNEL_SELECT,p),i.FluxDispatcher.unsubscribe(n.ActionTypes.CREATE_PENDING_REPLY,g),i.FluxDispatcher.unsubscribe(n.ActionTypes.DELETE_PENDING_REPLY,E),window.removeEventListener("keydown",f)}};return I})(cumcord.modules.common.constants,cumcord.modules.webpackModules,cumcord.modules.common);
