(function(u,f,p,l,K,y,d,x){"use strict";function b(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var w=b(u),g=b(x);const v=window._,N=(e,t)=>{t.store[e]=t.ghost[e]},P=e=>{const t=parseFloat(e.slice(0,-1));switch(v.last(e)){case"s":return t*1e3;case"m":return t*1e3*60;case"h":return t*1e3*60*60;case"d":return t*1e3*60*60*24;case"w":return t*1e3*60*60*24*7;case"y":return t*1e3*60*60*24*365;default:throw new Error(`time unit ${v.last(e)} is not recognised`)}},T=(e,t)=>(r,n,s,o=Date.now())=>{t.ghost[e].set(r,[n,o+P(s)]),N(e,t)};function h(e,t){const r=Date.now(),n=t.ghost[e];for(const[s,o]of n.entries()){if(!Array.isArray(o)||o.length!==2||typeof o[1]!="number")throw new Error("cacheName does not point to a cumcache store");o[1]>=r&&n.delete(s)}N(e,t)}const j=(e,t)=>new Proxy(t.ghost[e],{get:(r,n)=>t.ghost[e].get(n)?.[0],set:(r,n,s)=>{throw Error("Setting to the cumcache store is not allowed.")},deleteProperty:(r,n)=>t.ghost[e].delete(n)});function k(e="cumcache",t=u.persist){t.ghost[e]||(t.store[e]=new Map);const r=setInterval(()=>h(e,t),5e3);return h(e,t),[()=>clearInterval(r),T(e,t),j(e,t),()=>h(e,t)]}function B(e,t,r=u.persist){const[n,s,o,a]=k(e,r),i=new Proxy(o,{get:(m,c)=>o[c],deleteProperty:(m,c)=>delete o[c],set:(m,c,H)=>(s(c,H,t),!0)});return[n,i,a]}var A=(e,t=!1,r=!1)=>{const n=o=>typeof o?.type=="string"||r&&!o?.type?.displayName?n(o.return):o?.type,s=n(f.getReactInstance(e));return t?p.find(o=>o?.default===s):s},C=(e,t)=>{let r=e.some(o=>l.loaded.ghost.hasOwnProperty(o))?t():null;const n=(o,{path:a})=>{e.includes(a[0])&&(r?.(),r=t())},s=(o,{path:a})=>{e.includes(a[0])&&(r?.(),r=null)};return l.loaded.on("SET",n),l.loaded.on("DELETE",s),()=>{r?.(),l.loaded.off("SET",n),l.loaded.off("DELETE",s)}},I=Object.freeze({__proto__:null,cumcache:k,boundCumcache:B,findByDomNode:A,depend:C});const E=e=>{let t=Object.keys(e);return e.__proto__&&t.push(...E(e.__proto__)),t},M=e=>{if(f.logger.warn("!! THIS FUNCTION CAN BE VERY SLOW AND RAM INTENSIVE, FOR DEV ONLY !!"),!e)return{method:"unfindable"};if(e.displayName||e.default?.displayName){const r=e.displayName??e.default.displayName,n=p.findAll(s=>(e.displayName?s?.displayName:s?.default?.displayName)===r);return n[0]===e?["displayName",!!e.displayName,r]:["displayNameAll",!!e.displayName,r,n.findIndex(s=>s===e)]}return((r,n)=>{const s=E(r);for(const a of s)if(findByProps(a)===r)return["props",[a],n];let o=[];for(const a of s){const i=p.findByPropsAll(a).findIndex(m=>m===r);i!==-1&&o.push([a,i])}return o.sort((a,i)=>a[1]-i[1]),["propsAll",[o[0][0]],o[0][1],n]})(e,!1)};var D=e=>{const t=a=>a.map(JSON.stringify).join(", "),r=a=>a?".default":"",n=a=>a?"":", false",s=a=>(f.logger.log("Copied module find code to clipboard."),f.copyText(a),a),o=M(e);switch(o[0]){case"unfindable":return!1;case"props":return s(`findByProps(${t(o[1])})${r(o[2])}`);case"propsAll":return s(`findByPropsAll(${t(o[1])})[${o[2]}]${r(o[3])}`);case"displayName":return s(`findByDisplayName(${JSON.stringify(o[2])}${n(o[1])})`);case"displayNameAll":return o[1]?s(`findByDisplayNameAll(${JSON.stringify(o[2])})[${o[3]}]`):s(`(() => {
    const mod = findByDisplayNameAll(${JSON.stringify(o[2])})[${o[3]}];
    return find(m => m?.default === mod);
})()`)}return o};const S=e=>(e.startsWith(".")&&(e=e.substring(1)),p.findAll(t=>typeof t=="object"&&Object.values(t).some(r=>typeof r=="string"&&r.includes(e)))),$=e=>(typeof e=="string"&&(e=document.querySelector(e)),D(A(e,!1,!0)));var L=()=>(window.dk={cctools:I,bestFindMethod:D,autoModuleFind:$,findClassNameModuleAll:S,findClassNameModule:e=>S(e)[0]},()=>delete window.dk),R=()=>{window.DiscordNative&&DiscordNative.window.setDevtoolsCallbacks(()=>{},()=>{})},V=()=>(Object.assign(window,y.common),()=>{for(const e in y.common)delete window[e]}),J=()=>(u.persist.ghost.otp?Object.assign(window,{injectCSS:d.patcher.injectCSS,after:(e,t,r,n=!0)=>d.patcher.after(e,t,r,n),before:(e,t,r,n=!0)=>d.patcher.before(e,t,r,n),instead:(e,t,r,n=!0)=>d.patcher.instead(e,t,r,n)}):Object.assign(window,d.patcher),()=>{for(const e in d.patcher)delete window[e]}),U=()=>(Object.assign(window,y.webpack),()=>{for(const e in y.webpack)delete window[e]});const W=L();Array.isArray(w.default.persist.ghost.enabledModules)||(w.default.persist.store.enabledModules=["webpack","common","patcher","callbacks"]);const Y={webpack:[U,"Exposes webpack modules to window"],common:[V,"Exposes common modules (react etc) to window"],patcher:[J,"Exposes patcher to window"],callbacks:[R,"Disables spam logs on devtools open"]};let O=[];const q=w.default.persist.ghost.enabledModules;for(const e of q)O.push(Y[e]?.[0]());g.default&&!g.default.isEnabled&&g.default.toggleDevMode();var z={onUnload(){_.forEachRight(O,e=>e?.()),W()}};return z})(cumcord.pluginData,cumcord.utils,cumcord.modules.webpack,cumcord.plugins,cumcord.patcher,cumcord.modules,cumcord,cumcord.dev);
