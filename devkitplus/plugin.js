(function(p,u,f,l,H,y,d,$){"use strict";function b(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var w=b(p),g=b($);const v=window._,N=(e,t)=>{t.store[e]=t.ghost[e]},j=e=>{const t=parseFloat(e.slice(0,-1));switch(v.last(e)){case"s":return t*1e3;case"m":return t*1e3*60;case"h":return t*1e3*60*60;case"d":return t*1e3*60*60*24;case"w":return t*1e3*60*60*24*7;case"y":return t*1e3*60*60*24*365;default:throw new Error(`time unit ${v.last(e)} is not recognised`)}},k=(e,t)=>(r,n,s,o=Date.now())=>{t.ghost[e].set(r,[n,o+j(s)]),N(e,t)};function h(e,t){const r=Date.now(),n=t.ghost[e];for(const[s,o]of n.entries()){if(!Array.isArray(o)||o.length!==2||typeof o[1]!="number")throw new Error("cacheName does not point to a cumcache store");o[1]>=r&&n.delete(s)}N(e,t)}const x=(e,t)=>new Proxy(t.ghost[e],{get:(r,n)=>t.ghost[e].get(n)?.[0],set:(r,n,s)=>{throw Error("Setting to the cumcache store is not allowed.")},deleteProperty:(r,n)=>t.ghost[e].delete(n)});function E(e="cumcache",t=p.persist){t.ghost[e]||(t.store[e]=new Map);const r=setInterval(()=>h(e,t),5e3);return h(e,t),[()=>clearInterval(r),k(e,t),x(e,t),()=>h(e,t)]}function C(e,t,r=p.persist){const[n,s,o,a]=E(e,r),i=new Proxy(o,{get:(m,c)=>o[c],deleteProperty:(m,c)=>delete o[c],set:(m,c,z)=>(s(c,z,t),!0)});return[n,i,a]}var A=(e,t=!1,r=!1)=>{const n=o=>typeof o?.type=="string"||r&&!o?.type?.displayName?n(o.return):o?.type,s=n(u.getReactInstance(e));return t?f.find(o=>o?.default===s):s},B=(e,t)=>{let r=e.some(o=>l.loaded.ghost.hasOwnProperty(o))?t():null;const n=(o,{path:a})=>{e.includes(a[0])&&(r?.(),r=t())},s=(o,{path:a})=>{e.includes(a[0])&&(r?.(),r=null)};return l.loaded.on("SET",n),l.loaded.on("DELETE",s),()=>{r?.(),l.loaded.off("SET",n),l.loaded.off("DELETE",s)}},M=Object.freeze({__proto__:null,cumcache:E,boundCumcache:C,findByDomNode:A,depend:B});const D=e=>{let t=Object.keys(e);return e.__proto__&&t.push(...D(e.__proto__)),t},P=e=>{if(u.logger.warn("!! THIS FUNCTION CAN BE VERY SLOW AND RAM INTENSIVE, FOR DEV ONLY !!"),!e)return{method:"unfindable"};if(e.displayName||e.default?.displayName){const r=e.displayName??e.default.displayName,n=f.findAll(s=>(e.displayName?s?.displayName:s?.default?.displayName)===r);return n[0]===e?["displayName",!!e.displayName,r]:["displayNameAll",!!e.displayName,r,n.findIndex(s=>s===e)]}return((r,n)=>{const s=D(r);for(const a of s)if(findByProps(a)===r)return["props",[a],n];let o=[];for(const a of s){const i=f.findByPropsAll(a).findIndex(m=>m===r);i!==-1&&o.push([a,i])}return o.sort((a,i)=>a[1]-i[1]),["propsAll",[o[0][0]],o[0][1],n]})(e,!1)};var O=e=>{const t=a=>a.map(JSON.stringify).join(", "),r=a=>a?".default":"",n=a=>a?"":", false",s=a=>(u.logger.log("Copied module find code to clipboard."),u.copyText(a),a),o=P(e);switch(o[0]){case"unfindable":return!1;case"props":return s(`findByProps(${t(o[1])})${r(o[2])}`);case"propsAll":return s(`findByPropsAll(${t(o[1])})[${o[2]}]${r(o[3])}`);case"displayName":return s(`findByDisplayName(${JSON.stringify(o[2])}${n(o[1])})`);case"displayNameAll":return o[1]?s(`findByDisplayNameAll(${JSON.stringify(o[2])})[${o[3]}]`):s(`(() => {
    const mod = findByDisplayNameAll(${JSON.stringify(o[2])})[${o[3]}];
    return find(m => m?.default === mod);
})()`)}return o};const S=e=>(e.startsWith(".")&&(e=e.substring(1)),f.findAll(t=>typeof t=="object"&&Object.values(t).some(r=>typeof r=="string"&&r.includes(e)))),I=e=>(typeof e=="string"&&(e=document.querySelector(e)),O(A(e,!1,!0)));var L=()=>(window.dk={cctools:M,bestFindMethod:O,autoModuleFind:I,findClassNameModuleAll:S,findClassNameModule:e=>S(e)[0]},()=>delete window.dk),F=()=>{window.DiscordNative&&DiscordNative.window.setDevtoolsCallbacks(()=>{},()=>{})},R=()=>(Object.assign(window,y.common),()=>{for(const e in y.common)delete window[e]}),J=()=>(p.persist.ghost.otp?Object.assign(window,{injectCSS:d.patcher.injectCSS,after:(e,t,r,n=!0)=>d.patcher.after(e,t,r,n),before:(e,t,r,n=!0)=>d.patcher.before(e,t,r,n),instead:(e,t,r,n=!0)=>d.patcher.instead(e,t,r,n)}):Object.assign(window,d.patcher),()=>{for(const e in d.patcher)delete window[e]}),V=()=>(Object.assign(window,y.webpack),()=>{for(const e in y.webpack)delete window[e]});const U=L();Array.isArray(w.default.persist.ghost.enabledModules)||(w.default.persist.store.enabledModules=["webpack","common","patcher","callbacks"]);const W={webpack:[V,"Exposes webpack modules to window"],common:[R,"Exposes common modules (react etc) to window"],patcher:[J,"Exposes patcher to window"],callbacks:[F,"Disables spam logs on devtools open"]};let T=[];const Y=w.default.persist.ghost.enabledModules;for(const e of Y)T.push(W[e]?.[0]());g.default&&!g.default.isEnabled&&g.default.toggleDevMode();var q={onUnload(){_.forEachRight(T,e=>e?.()),U()}};return q})(cumcord.pluginData,cumcord.utils,cumcord.modules.webpack,cumcord.plugins,cumcord.patcher,cumcord.modules,cumcord,cumcord.dev);
