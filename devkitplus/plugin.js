(function(p,T,u,f,G,y,c){"use strict";function x(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var w=x(p);const g=window._,b=(e,t)=>{t.store[e]=t.ghost[e]},D=e=>{const t=parseFloat(e.slice(0,-1));switch(g.last(e)){case"s":return t*1e3;case"m":return t*1e3*60;case"h":return t*1e3*60*60;case"d":return t*1e3*60*60*24;case"w":return t*1e3*60*60*24*7;case"y":return t*1e3*60*60*24*365;default:throw new Error(`time unit ${g.last(e)} is not recognised`)}},I=(e,t)=>(o,r,s,n=Date.now())=>{t.ghost[e].set(o,[r,n+D(s)]),b(e,t)};function h(e,t){const o=Date.now(),r=t.ghost[e];for(const[s,n]of r.entries()){if(!Array.isArray(n)||n.length!==2||typeof n[1]!="number")throw new Error("cacheName does not point to a cumcache store");n[1]>=o&&r.delete(s)}b(e,t)}const N=(e,t)=>new Proxy(t.ghost[e],{get:(o,r)=>t.ghost[e].get(r)?.[0],set:(o,r,s)=>{throw Error("Setting to the cumcache store is not allowed.")},deleteProperty:(o,r)=>t.ghost[e].delete(r)});function v(e="cumcache",t=p.persist){t.ghost[e]||(t.store[e]=new Map);const o=setInterval(()=>h(e,t),5e3);return h(e,t),[()=>clearInterval(o),I(e,t),N(e,t),()=>h(e,t)]}function P(e,t,o=p.persist){const[r,s,n,l]=v(e,o),m=new Proxy(n,{get:(a,i)=>n[i],deleteProperty:(a,i)=>delete n[i],set:(a,i,d)=>(s(i,d,t),!0)});return[r,m,l]}var O=(e,t=!1,o=!1)=>{const r=n=>typeof n?.type=="string"||o&&!n?.type?.displayName?r(n.return):n?.type,s=r(T.getReactInstance(e));return t?u.find(n=>n?.default===s):s},S=(e,t)=>{let o=e.some(n=>f.loaded.ghost.hasOwnProperty(n))?t():null;const r=(n,{path:l})=>{e.includes(l[0])&&(o?.(),o=t())},s=(n,{path:l})=>{e.includes(l[0])&&(o?.(),o=null)};return f.loaded.on("SET",r),f.loaded.on("DELETE",s),()=>{o?.(),f.loaded.off("SET",r),f.loaded.off("DELETE",s)}},C=Object.freeze({__proto__:null,cumcache:v,boundCumcache:P,findByDomNode:O,depend:S});const M=1<<23,j=e=>{let t=0;for(let s=0;s<e.length;s++)t+=1<<s;t=Math.min(t,M);let o=[];for(let s=0;s<=t;s++)o.push(s);let r=[];for(const s of o){let n=[];for(let l=0;l<e.length;l++)s&1<<l&&n.push(e[l]);n.length>0&&r.push(n)}return r.sort((s,n)=>s.length-n.length)},E=e=>{let t=Object.keys(e);return e.__proto__&&t.push(...E(e.__proto__)),t};var L=e=>{console.warn("!! THIS FUNCTION CAN BE VERY SLOW AND RAM INTENSIVE !!");let t=(o,r)=>{if(!o)return{method:"unfindable"};if(o.displayName||o.default?.displayName){const a=o.displayName??o.default.displayName,i=u.findAll(d=>(o.displayName?d?.displayName:d?.default?.displayName)===a);return i[0]===o?["displayName",!!o.displayName,a]:["displayNameAll",!!o.displayName,a,i.findIndex(d=>d===o)]}const s=E(o),n=j(s);let l=[];for(let a=0;a<n.length;a++)if(findByProps(...n[a])===o){l=n[a];break}if(l.length!==0)return["props",l];let m=0;for(let a=0;a<n.length;a++){const d=u.findByPropsAll(...n[a]).findIndex(q=>q===o);if(d!==-1){l=n[a],m=d;break}}return l.length!==0?["propsAll",l,m]:r?["unfindable"]:t(u.findAll(a=>a?.default===o)[0],!0)};return t(e)};const k=e=>(e.startsWith(".")&&(e=e.substring(1)),u.findAll(t=>typeof t=="object"&&Object.values(t).some(o=>typeof o=="string"&&o.includes(e))));var B=()=>(window.dk={cctools:C,bestFindMethod:L,findClassNameModuleAll:k,findClassNameModule:e=>k(e)[0]},()=>delete window.dk),R=()=>{window.DiscordNative&&DiscordNative.window.setDevtoolsCallbacks(()=>{},()=>{})},U=()=>(Object.assign(window,y.common),()=>{for(const e in y.common)delete window[e]}),V=()=>(p.persist.ghost.otp?Object.assign(window,{injectCSS:c.patcher.injectCSS,after:(e,t,o,r=!0)=>c.patcher.after(e,t,o,r),before:(e,t,o,r=!0)=>c.patcher.before(e,t,o,r),instead:(e,t,o,r=!0)=>c.patcher.instead(e,t,o,r)}):Object.assign(window,c.patcher),()=>{for(const e in c.patcher)delete window[e]}),W=()=>(Object.assign(window,y.webpack),()=>{for(const e in y.webpack)delete window[e]});const z=B();Array.isArray(w.default.persist.ghost.enabledModules)||(w.default.persist.store.enabledModules=["webpack","common","patcher","callbacks"]);const H={webpack:[W,"Exposes webpack modules to window"],common:[U,"Exposes common modules (react etc) to window"],patcher:[V,"Exposes patcher to window"],callbacks:[R,"Disables spam logs on devtools open"]};let A=[];const K=w.default.persist.ghost.enabledModules;for(const e of K)A.push(H[e]?.[0]());var Y={onUnload(){_.forEachRight(A,e=>e?.()),z()}};return Y})(cumcord.pluginData,cumcord.utils,cumcord.modules.webpack,cumcord.plugins,cumcord.patcher,cumcord.modules,cumcord);
