(function(u,A,d,K,p,a){"use strict";function x(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var w=x(u);const y=window._,h=(e,t)=>{t.store[e]=t.ghost[e]},E=e=>{const t=parseFloat(e.slice(0,-1));switch(y.last(e)){case"s":return t*1e3;case"m":return t*1e3*60;case"h":return t*1e3*60*60;case"d":return t*1e3*60*60*24;case"w":return t*1e3*60*60*24*7;case"y":return t*1e3*60*60*24*365;default:throw new Error(`time unit ${y.last(e)} is not recognised`)}},I=(e,t)=>(o,r,s,n=Date.now())=>{t.ghost[e].set(o,[r,n+E(s)]),h(e,t)};function m(e,t){const o=Date.now(),r=t.ghost[e];for(const[s,n]of r.entries()){if(!Array.isArray(n)||n.length!==2||typeof n[1]!="number")throw new Error("cacheName does not point to a cumcache store");n[1]>=o&&r.delete(s)}h(e,t)}const N=(e,t)=>new Proxy(t.ghost[e],{get:(o,r)=>t.ghost[e].get(r)?.[0],set:(o,r,s)=>{throw Error("Setting to the cumcache store is not allowed.")},deleteProperty:(o,r)=>t.ghost[e].delete(r)});function g(e="cumcache",t=u.persist){t.ghost[e]||(t.store[e]=new Map);const o=setInterval(()=>m(e,t),5e3);return m(e,t),[()=>clearInterval(o),I(e,t),N(e,t),()=>m(e,t)]}function P(e,t,o=u.persist){const[r,s,n,l]=g(e,o),i=new Proxy(n,{get:(f,c)=>n[c],deleteProperty:(f,c)=>delete n[c],set:(f,c,H)=>(s(c,H,t),!0)});return[r,i,l]}var C=(e,t=!1)=>{const o=s=>typeof s?.type=="string"?o(s.return):s?.type,r=o(A.getReactInstance(e));return t?d.find(s=>s?.default===r):r},D=Object.freeze({__proto__:null,cumcache:g,boundCumcache:P,findByDomNode:C});const M=1<<23,O=e=>{let t=0;for(let s=0;s<e.length;s++)t+=1<<s;t=Math.min(t,M);let o=[];for(let s=0;s<=t;s++)o.push(s);let r=[];for(const s of o){let n=[];for(let l=0;l<e.length;l++)s&1<<l&&n.push(e[l]);n.length>0&&r.push(n)}return r.sort((s,n)=>s.length-n.length)},b=e=>{let t=Object.keys(e);return e.__proto__&&t.push(...b(e.__proto__)),t};var S=e=>{if(console.warn("!! THIS FUNCTION CAN BE VERY SLOW AND RAM INTENSIVE !!"),!e)return{method:"unfindable"};if(e.displayName||e.default?.displayName){const n=e.displayName??e.default.displayName,l=d.findAll(i=>(e.displayName?i?.displayName:i?.default?.displayName)===n);return l[0]===e?["displayName",!!e.displayName,n]:["displayNameAll",!!e.displayName,n,l.findIndex(i=>i===e)]}const t=b(e),o=O(t);let r=[];for(let n=0;n<o.length;n++)if(findByProps(...o[n])===e){r=o[n];break}if(r.length!==0)return["props",r];let s=0;for(let n=0;n<o.length;n++){const i=d.findByPropsAll(...o[n]).findIndex(f=>f===e);if(i!==-1){r=o[n],s=i;break}}return r.length!==0?["propsAll",r,s]:["unfindable"]};const k=e=>(e.startsWith(".")&&(e=e.substring(1)),d.findAll(t=>typeof t=="object"&&Object.values(t).some(o=>typeof o=="string"&&o.includes(e))));var j=()=>(window.dk={cctools:D,bestFindMethod:S,findClassNameModuleAll:k,findClassNameModule:e=>k(e)[0]},()=>delete window.dk),T=()=>{window.DiscordNative&&DiscordNative.window.setDevtoolsCallbacks(()=>{},()=>{})},B=()=>(Object.assign(window,p.common),()=>{for(const e in p.common)delete window[e]}),R=()=>(u.persist.ghost.otp?Object.assign(window,{injectCSS:a.patcher.injectCSS,after:(e,t,o,r=!0)=>a.patcher.after(e,t,o,r),before:(e,t,o,r=!0)=>a.patcher.before(e,t,o,r),instead:(e,t,o,r=!0)=>a.patcher.instead(e,t,o,r)}):Object.assign(window,a.patcher),()=>{for(const e in a.patcher)delete window[e]}),L=()=>(Object.assign(window,p.webpack),()=>{for(const e in p.webpack)delete window[e]});const U=j();Array.isArray(w.default.persist.ghost.enabledModules)||(w.default.persist.store.enabledModules=["webpack","common","patcher","callbacks"]);const V={webpack:[L,"Exposes webpack modules to window"],common:[B,"Exposes common modules (react etc) to window"],patcher:[R,"Exposes patcher to window"],callbacks:[T,"Disables spam logs on devtools open"]};let v=[];const W=w.default.persist.ghost.enabledModules;for(const e of W)v.push(V[e]?.[0]());var z={onUnload(){_.forEachRight(v,e=>e?.()),U()}};return z})(cumcord.pluginData,cumcord.utils,cumcord.modules.webpack,cumcord.patcher,cumcord.modules,cumcord);
