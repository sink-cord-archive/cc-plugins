(function(m,l,B,f,u,p,w,d,M){"use strict";function D(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function I(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(o){if(o!=="default"){var s=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,s.get?s:{enumerable:!0,get:function(){return e[o]}})}}),t.default=e,Object.freeze(t)}var $=D(B),a=I(M);l.persist.ghost.startupDev&&$.default?.isEnabled===!1&&$.default.toggleDevMode();const S=window._,T=(e,t)=>{t.set({path:[e],value:t.ghost[e]})},F=e=>{const t=parseFloat(e.slice(0,-1));switch(S.last(e)){case"s":return t*1e3;case"m":return t*1e3*60;case"h":return t*1e3*60*60;case"d":return t*1e3*60*60*24;case"w":return t*1e3*60*60*24*7;case"y":return t*1e3*60*60*24*365;default:throw new Error(`time unit ${S.last(e)} is not recognised`)}},L=(e,t)=>(o,s,n,r=Date.now())=>{t.ghost[e].set(o,[s,r+F(n)]),T(e,t)};function E(e,t){const o=Date.now(),s=t.ghost[e];for(const[n,r]of s.entries()){if(!Array.isArray(r)||r.length!==2||typeof r[1]!="number")throw new Error("cacheName does not point to a cumcache store");r[1]>=o&&s.delete(n)}T(e,t)}const x=(e,t)=>new Proxy(t.ghost[e],{get:(o,s)=>t.ghost[e].get(s)?.[0],set:()=>{throw Error("Setting to the cumcache store is not allowed.")},deleteProperty:(o,s)=>t.ghost[e].delete(s)});function A(e="cumcache",t=l.persist){t.ghost[e]||(t.store[e]=new Map);const o=setInterval(()=>E(e,t),5e3);return E(e,t),[()=>clearInterval(o),L(e,t),x(e,t),()=>E(e,t)]}function R(e,t,o=l.persist){const[s,n,r,i]=A(e,o),c=new Proxy(r,{get:(v,y)=>r[y],deleteProperty:(v,y)=>delete r[y],set:(v,y,ee)=>(n(y,ee,t),!0)});return[s,c,i]}var j=(e,t=!1,o=!1)=>{const s=r=>typeof r?.type=="string"||o&&!r?.type?.displayName?s(r.return):r?.type,n=s(f.getReactInstance(e));return t?u.find(r=>r?.default===n):n},J=(e,t)=>{let o=e.some(r=>p.loaded.ghost.hasOwnProperty(r))?t():null;const s=(r,{path:i})=>{e.includes(i[0])&&(o?.(),o=t())},n=(r,{path:i})=>{e.includes(i[0])&&(o?.(),o=null)};return p.loaded.on("SET",s),p.loaded.on("DELETE",n),()=>{o?.(),p.loaded.off("SET",s),p.loaded.off("DELETE",n)}},U=Object.freeze({__proto__:null,cumcache:A,boundCumcache:R,findByDomNode:j,depend:J});const C=e=>{let t=Object.keys(e);return e.__proto__&&t.push(...C(e.__proto__)),t},V=e=>{if(f.logger.warn("!! THIS FUNCTION CAN BE VERY SLOW AND RAM INTENSIVE, FOR DEV ONLY !!"),!e)return{method:"unfindable"};if(e.displayName||e.default?.displayName){const o=e.displayName??e.default.displayName,s=u.findAll(n=>(e.displayName?n?.displayName:n?.default?.displayName)===o);return s[0]===e?["displayName",!!e.displayName,o]:["displayNameAll",!!e.displayName,o,s.findIndex(n=>n===e)]}return((o,s)=>{const n=C(o);for(const i of n)if(findByProps(i)===o)return["props",[i],s];let r=[];for(const i of n){const c=u.findByPropsAll(i).findIndex(v=>v===o);c!==-1&&r.push([i,c])}return r.sort((i,c)=>i[1]-c[1]),["propsAll",[r[0][0]],r[0][1],s]})(e,!1)};var k=e=>{const t=i=>i.map(JSON.stringify).join(", "),o=i=>i?".default":"",s=i=>i?"":", false",n=i=>(f.logger.log("Copied module find code to clipboard."),f.copyText(i),i),r=V(e);switch(r[0]){case"unfindable":return!1;case"props":return n(`findByProps(${t(r[1])})${o(r[2])}`);case"propsAll":return n(`findByPropsAll(${t(r[1])})[${r[2]}]${o(r[3])}`);case"displayName":return n(`findByDisplayName(${JSON.stringify(r[2])}${s(r[1])})`);case"displayNameAll":return r[1]?n(`findByDisplayNameAll(${JSON.stringify(r[2])})[${r[3]}]`):n(`getModule(findByDisplayNameAll(${JSON.stringify(r[2])})[${r[3]}])`)}return r};const P=e=>(e.startsWith(".")&&(e=e.slice(1)),u.findAll(t=>typeof t=="object"&&Object.values(t).some(o=>typeof o=="string"&&o.includes(e)))),z=e=>k(j(typeof e=="string"?document.querySelector(e):e,!1,!0));window.dk={cctools:U,bestFindMethod:k,autoModuleFind:z,findClassNameModuleAll:P,findClassNameModule:e=>P(e)[0]};var W=()=>delete window.dk;const b=()=>{l.persist.ghost.disableCallbacks&&DiscordNative.window.setDevtoolsCallbacks(()=>{},()=>{})};window.DiscordNative&&(l.persist.on("SET",b),b());var Y=window.DiscordNative?()=>l.persist.off("SET",b):void 0;const q=()=>{const e=l.persist.ghost.otp?{...d.patcher,after:(o,s,n,r=!0)=>d.patcher.after(o,s,n,r),before:(o,s,n,r=!0)=>d.patcher.before(o,s,n,r),instead:(o,s,n,r=!0)=>d.patcher.instead(o,s,n,r)}:d.patcher,t={...w.webpack,...w.common,...w.internal,...d.utils,...e};return Object.assign(window,t),()=>Object.keys(t).forEach(o=>delete window[o])};let N;const O=()=>{N?.(),l.persist.ghost.assign&&(N=q())};l.persist.on("SET",O),O();var H=()=>{l.persist.off("SET",O),N?.()};const[G,K]=u.batchFind(({findByDisplayName:e})=>{e("FormText"),e("Switch")}),g=({k:e,depends:t,children:o})=>a.createElement("div",{style:{display:"flex",alignItems:"center",gap:".5rem",marginBottom:"1rem",marginLeft:t?"1rem":0}},a.createElement(K,{checked:l.persist.ghost[e],disabled:t&&!l.persist.ghost[t],onChange:s=>l.persist.store[e]=s}),a.createElement(G,null,o));var Q=()=>(f.useNest(l.persist),a.createElement(a.Fragment,null,a.createElement(g,{k:"assign"},"Assign modules, utils, patcher to window"),a.createElement(g,{k:"otp",depends:"apply"},"Make exported patcher functions one time by default"),a.createElement(g,{k:"startupDev"},"Enable Cumcord dev mode on plugin load"),a.createElement(g,{k:"disableCallbacks"},"Disable DevTools warning logs")));const h=(e,t)=>{l.persist.ghost[e]===void 0&&(l.persist.store[e]=t)};h("assign",!0),h("otp",!1),h("startupDev",!0),h("disableCallbacks",!0);const X=[W,Y,H],Z=()=>_.forEachRight(X,e=>e?.());return m.onUnload=Z,m.settings=Q,Object.defineProperty(m,"__esModule",{value:!0}),m})({},cumcord.pluginData,cumcord.dev,cumcord.utils,cumcord.modules.webpack,cumcord.plugins,cumcord.modules,cumcord,cumcord.modules.common.React);
