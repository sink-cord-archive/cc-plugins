(function(m,l,P,f,u,p,v,d,B){"use strict";function M(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function I(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(o){if(o!=="default"){var s=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,s.get?s:{enumerable:!0,get:function(){return e[o]}})}}),t.default=e,Object.freeze(t)}var O=M(P),a=I(B);l.persist.ghost.startupDev&&O.default?.isEnabled===!1&&O.default.toggleDevMode();const $=window._,S=(e,t)=>{t.set({path:[e],value:t.ghost[e]})},D=e=>{const t=parseFloat(e.slice(0,-1));switch($.last(e)){case"s":return t*1e3;case"m":return t*1e3*60;case"h":return t*1e3*60*60;case"d":return t*1e3*60*60*24;case"w":return t*1e3*60*60*24*7;case"y":return t*1e3*60*60*24*365;default:throw new Error(`time unit ${$.last(e)} is not recognised`)}},F=(e,t)=>(o,s,n,r=Date.now())=>{t.ghost[e].set(o,[s,r+D(n)]),S(e,t)};function w(e,t){const o=Date.now(),s=t.ghost[e];for(const[n,r]of s.entries()){if(!Array.isArray(r)||r.length!==2||typeof r[1]!="number")throw new Error("cacheName does not point to a cumcache store");r[1]>=o&&s.delete(n)}S(e,t)}const L=(e,t)=>new Proxy(t.ghost[e],{get:(o,s)=>t.ghost[e].get(s)?.[0],set:()=>{throw Error("Setting to the cumcache store is not allowed.")},deleteProperty:(o,s)=>t.ghost[e].delete(s)});function T(e="cumcache",t=l.persist){t.ghost[e]||(t.store[e]=new Map);const o=setInterval(()=>w(e,t),5e3);return w(e,t),[()=>clearInterval(o),F(e,t),L(e,t),()=>w(e,t)]}function x(e,t,o=l.persist){const[s,n,r,i]=T(e,o),c=new Proxy(r,{get:(g,y)=>r[y],deleteProperty:(g,y)=>delete r[y],set:(g,y,Z)=>(n(y,Z,t),!0)});return[s,c,i]}var A=(e,t=!1,o=!1)=>{const s=r=>typeof r?.type=="string"||o&&!r?.type?.displayName?s(r.return):r?.type,n=s(f.getReactInstance(e));return t?u.find(r=>r?.default===n):n},R=(e,t)=>{let o=e.some(r=>p.loaded.ghost.hasOwnProperty(r))?t():null;const s=(r,{path:i})=>{e.includes(i[0])&&(o?.(),o=t())},n=(r,{path:i})=>{e.includes(i[0])&&(o?.(),o=null)};return p.loaded.on("SET",s),p.loaded.on("DELETE",n),()=>{o?.(),p.loaded.off("SET",s),p.loaded.off("DELETE",n)}},J=Object.freeze({__proto__:null,cumcache:T,boundCumcache:x,findByDomNode:A,depend:R});const j=e=>{let t=Object.keys(e);return e.__proto__&&t.push(...j(e.__proto__)),t},U=e=>{if(f.logger.warn("!! THIS FUNCTION CAN BE VERY SLOW AND RAM INTENSIVE, FOR DEV ONLY !!"),!e)return{method:"unfindable"};if(e.displayName||e.default?.displayName){const o=e.displayName??e.default.displayName,s=u.findAll(n=>(e.displayName?n?.displayName:n?.default?.displayName)===o);return s[0]===e?["displayName",!!e.displayName,o]:["displayNameAll",!!e.displayName,o,s.findIndex(n=>n===e)]}return((o,s)=>{const n=j(o);for(const i of n)if(findByProps(i)===o)return["props",[i],s];let r=[];for(const i of n){const c=u.findByPropsAll(i).findIndex(g=>g===o);c!==-1&&r.push([i,c])}return r.sort((i,c)=>i[1]-c[1]),["propsAll",[r[0][0]],r[0][1],s]})(e,!1)};var C=e=>{const t=i=>i.map(JSON.stringify).join(", "),o=i=>i?".default":"",s=i=>i?"":", false",n=i=>(f.logger.log("Copied module find code to clipboard."),f.copyText(i),i),r=U(e);switch(r[0]){case"unfindable":return!1;case"props":return n(`findByProps(${t(r[1])})${o(r[2])}`);case"propsAll":return n(`findByPropsAll(${t(r[1])})[${r[2]}]${o(r[3])}`);case"displayName":return n(`findByDisplayName(${JSON.stringify(r[2])}${s(r[1])})`);case"displayNameAll":return r[1]?n(`findByDisplayNameAll(${JSON.stringify(r[2])})[${r[3]}]`):n(`getModule(findByDisplayNameAll(${JSON.stringify(r[2])})[${r[3]}])`)}return r};const k=e=>(e.startsWith(".")&&(e=e.slice(1)),u.findAll(t=>typeof t=="object"&&Object.values(t).some(o=>typeof o=="string"&&o.includes(e)))),V=e=>C(A(typeof e=="string"?document.querySelector(e):e,!1,!0));window.dk={cctools:J,bestFindMethod:C,autoModuleFind:V,findClassNameModuleAll:k,findClassNameModule:e=>k(e)[0]};var z=()=>delete window.dk;const E=()=>{l.persist.ghost.disableCallbacks&&DiscordNative.window.setDevtoolsCallbacks(()=>{},()=>{})};window.DiscordNative&&(l.persist.on("SET",E),E());var W=window.DiscordNative?()=>l.persist.off("SET",E):void 0;const Y=()=>{const e=l.persist.ghost.otp?{...d.patcher,after:(o,s,n,r=!0)=>d.patcher.after(o,s,n,r),before:(o,s,n,r=!0)=>d.patcher.before(o,s,n,r),instead:(o,s,n,r=!0)=>d.patcher.instead(o,s,n,r)}:d.patcher,t={...v.webpack,...v.common,...v.internal,...d.utils,...e};return Object.assign(window,t),()=>Object.keys(t).forEach(o=>delete window[o])};let b;const N=()=>{b?.(),l.persist.ghost.assign&&(b=Y())};l.persist.on("SET",N),N();var q=()=>{l.persist.off("SET",N),b?.()};const[H,G]=u.batchFind(({findByDisplayName:e})=>{e("FormText"),e("Switch")}),h=({k:e,depends:t,children:o})=>a.createElement("div",{style:{display:"flex",alignItems:"center",gap:".5rem",marginBottom:"1rem",marginLeft:t?"1rem":0}},a.createElement(G,{checked:l.persist.ghost[e],disabled:t&&!l.persist.ghost[t],onChange:s=>l.persist.store[e]=s}),a.createElement(H,null,o));var K=()=>(f.useNest(l.persist),a.createElement(a.Fragment,null,a.createElement(h,{k:"assign"},"Assign modules, utils, patcher to window"),a.createElement(h,{k:"otp",depends:"apply"},"Make exported patcher functions one time by default"),a.createElement(h,{k:"startupDev"},"Enable Cumcord dev mode on plugin load"),a.createElement(h,{k:"disableCallbacks"},"Disable DevTools warning logs")));l.persist.ghost.assign??=!0,l.persist.ghost.otp??=!1,l.persist.ghost.startupDev??=!0,l.persist.ghost.disableCallbacks??=!0;const Q=[z,W,q],X=()=>_.forEachRight(Q,e=>e?.());return m.onUnload=X,m.settings=K,Object.defineProperty(m,"__esModule",{value:!0}),m})({},cumcord.pluginData,cumcord.dev,cumcord.utils,cumcord.modules.webpack,cumcord.plugins,cumcord.modules,cumcord,cumcord.modules.common.React);
