(function(u,E,f,d,z,p,i){"use strict";function A(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var m=A(u);const h=window._,g=(e,t)=>{t.store[e]=t.ghost[e]},O=e=>{const t=parseFloat(e.slice(0,-1));switch(h.last(e)){case"s":return t*1e3;case"m":return t*1e3*60;case"h":return t*1e3*60*60;case"d":return t*1e3*60*60*24;case"w":return t*1e3*60*60*24*7;case"y":return t*1e3*60*60*24*365;default:throw new Error(`time unit ${h.last(e)} is not recognised`)}},S=(e,t)=>(o,n,r,s=Date.now())=>{t.ghost[e].set(o,[n,s+O(r)]),g(e,t)};function w(e,t){const o=Date.now(),n=t.ghost[e];for(const[r,s]of n.entries()){if(!Array.isArray(s)||s.length!==2||typeof s[1]!="number")throw new Error("cacheName does not point to a cumcache store");s[1]>=o&&n.delete(r)}g(e,t)}const D=(e,t)=>new Proxy(t.ghost[e],{get:(o,n)=>t.ghost[e].get(n)?.[0],set:(o,n,r)=>{throw Error("Setting to the cumcache store is not allowed.")},deleteProperty:(o,n)=>t.ghost[e].delete(n)});function b(e="cumcache",t=u.persist){t.ghost[e]||(t.store[e]=new Map);const o=setInterval(()=>w(e,t),5e3);return w(e,t),[()=>clearInterval(o),S(e,t),D(e,t),()=>w(e,t)]}function T(e,t,o=u.persist){const[n,r,s,a]=b(e,o),l=new Proxy(s,{get:(y,c)=>s[c],deleteProperty:(y,c)=>delete s[c],set:(y,c,Y)=>(r(c,Y,t),!0)});return[n,l,a]}var P=(e,t=!1,o=!1)=>{const n=s=>typeof s?.type=="string"||o&&!s?.type?.displayName?n(s.return):s?.type,r=n(E.getReactInstance(e));return t?f.find(s=>s?.default===r):r},x=(e,t)=>{let o=e.some(s=>d.loaded.ghost.hasOwnProperty(s))?t():null;const n=(s,{path:a})=>{e.includes(a[0])&&(o?.(),o=t())},r=(s,{path:a})=>{e.includes(a[0])&&(o?.(),o=null)};return d.loaded.on("SET",n),d.loaded.on("DELETE",r),()=>{o?.(),d.loaded.off("SET",n),d.loaded.off("DELETE",r)}},j=Object.freeze({__proto__:null,cumcache:b,boundCumcache:T,findByDomNode:P,depend:x});const N=e=>{let t=Object.keys(e);return e.__proto__&&t.push(...N(e.__proto__)),t},B=e=>{if(console.warn("!! THIS FUNCTION CAN BE VERY SLOW AND RAM INTENSIVE, FOR TESTING ONLY !!"),!e)return{method:"unfindable"};if(e.displayName||e.default?.displayName){const o=e.displayName??e.default.displayName,n=f.findAll(r=>(e.displayName?r?.displayName:r?.default?.displayName)===o);return n[0]===e?["displayName",!!e.displayName,o]:["displayNameAll",!!e.displayName,o,n.findIndex(r=>r===e)]}return((o,n)=>{const r=N(o);for(const a of r)if(findByProps(a)===o)return["props",[a],n];let s=[];for(const a of r){const l=f.findByPropsAll(a).findIndex(y=>y===o);l!==-1&&s.push([a,l])}return s.sort((a,l)=>a[1]-l[1]),["propsAll",[s[0][0]],s[0][1],n]})(e,!1)};var I=e=>{const t=s=>s.map(JSON.stringify).join(", "),o=s=>s?".default":"",n=s=>s?"":", false",r=B(e);switch(r[0]){case"unfindable":return!1;case"props":return`findByProps(${t(r[1])})${o(r[2])}`;case"propsAll":return`findByPropsAll(${t(r[1])})[${r[2]}]${o(r[3])}`;case"displayName":return`findByDisplayName(${JSON.stringify(r[2])}${n(r[1])})`;case"displayNameAll":return r[1]?`findByDisplayNameAll(${JSON.stringify(r[2])})[${r[3]}]`:`(() => {
    const mod = findByDisplayNameAll(${JSON.stringify(r[2])})[${r[3]}];
    return find(m => m?.default === mod);
})()`}return r};const v=e=>(e.startsWith(".")&&(e=e.substring(1)),f.findAll(t=>typeof t=="object"&&Object.values(t).some(o=>typeof o=="string"&&o.includes(e))));var C=()=>(window.dk={cctools:j,bestFindMethod:I,findClassNameModuleAll:v,findClassNameModule:e=>v(e)[0]},()=>delete window.dk),$=()=>{window.DiscordNative&&DiscordNative.window.setDevtoolsCallbacks(()=>{},()=>{})},L=()=>(Object.assign(window,p.common),()=>{for(const e in p.common)delete window[e]}),M=()=>(u.persist.ghost.otp?Object.assign(window,{injectCSS:i.patcher.injectCSS,after:(e,t,o,n=!0)=>i.patcher.after(e,t,o,n),before:(e,t,o,n=!0)=>i.patcher.before(e,t,o,n),instead:(e,t,o,n=!0)=>i.patcher.instead(e,t,o,n)}):Object.assign(window,i.patcher),()=>{for(const e in i.patcher)delete window[e]}),R=()=>(Object.assign(window,p.webpack),()=>{for(const e in p.webpack)delete window[e]});const J=C();Array.isArray(m.default.persist.ghost.enabledModules)||(m.default.persist.store.enabledModules=["webpack","common","patcher","callbacks"]);const V={webpack:[R,"Exposes webpack modules to window"],common:[L,"Exposes common modules (react etc) to window"],patcher:[M,"Exposes patcher to window"],callbacks:[$,"Disables spam logs on devtools open"]};let k=[];const U=m.default.persist.ghost.enabledModules;for(const e of U)k.push(V[e]?.[0]());var W={onUnload(){_.forEachRight(k,e=>e?.()),J()}};return W})(cumcord.pluginData,cumcord.utils,cumcord.modules.webpack,cumcord.plugins,cumcord.patcher,cumcord.modules,cumcord);
